import{g as o,S as A,T as ne,Q as ae,t as ue,_ as oe}from"./index.15381f0b.js";/* empty css               *//* empty css              *//* empty css              *//* empty css               *//* empty css               *//* empty css               */import{d as re,j as b,c as ie,o as le,C as _,D as E,aI as u,aH as n,u as j,E as c,aM as p,aE as S,aK as ce,aJ as de,aN as m,F as q,aF as pe,aX as z,bx as me,aY as fe,bT as _e,bU as ve,c4 as ge,ba as he,bO as be,aW as ye,b$ as Ce,c0 as Ee,bP as Ae,bt as De,bl as Se,bS as $e,bQ as ke,bR as Fe,bY as Be,bv as xe,bs as Re}from"./arco.2804d378.js";import{f as we}from"./vue.bbad6851.js";import{e as Ve}from"./distributed.0f0884be.js";import{x as Me}from"./monitor.07efdc4f.js";import{s as Te,w as Ie}from"./service-monitor.22721c84.js";import{j as Ke}from"./config.8a26327d.js";import"./chart.100020e2.js";function Le(){return o.get("/api/cache/status")}function Ne(){return o.get("/api/cache/cluster/info")}function Oe(t="*",a=0){return o.get(`/api/cache/keys?${A.stringify({pattern:t,db:a})}`)}function Pe(t,a=0){return o.get(`/api/cache/key/${t}?${A.stringify({db:a})}`)}function Ue(t,a,i={},l=0){return o.put(`/api/cache/key/${t}?${A.stringify({db:l})}`,{value:a,...i})}function je(t,a=0){return o.delete(`/api/cache/key/${t}?${A.stringify({db:a})}`)}function qe(t,a,i=0){return o.post("/api/cache/command",{command:t,args:a,db:i})}function ze(){return o.post("/api/cache/flushall")}function He(t=0){return o.post(`/api/cache/flushdb?${A.stringify({db:t})}`)}function Qe(t){return o.post(`/api/cache/select/${t}`)}function Ye(t){return o.post("/api/cache/server/start",{config:t})}function Ge(){return o.post("/api/cache/server/stop")}function Je(){return o.post("/api/cache/server/restart")}const We=Object.freeze(Object.defineProperty({__proto__:null,getCacheStatus:Le,getCacheClusterInfo:Ne,getCacheKeys:Oe,getCacheKey:Pe,setCacheKey:Ue,deleteCacheKey:je,executeCommand:qe,flushAllDatabases:ze,flushDatabase:He,selectDatabase:Qe,startCacheServer:Ye,stopCacheServer:Ge,restartCacheServer:Je},Symbol.toStringTag,{value:"Module"}));function Xe(){return o.get("/api/etcd/status")}function Ze(t){return o.post("/api/etcd/server/start",{config:t})}function et(){return o.post("/api/etcd/server/stop")}function tt(t){return o.post("/api/etcd/server/restart",t?{config:t}:{})}function st(){return o.get("/api/etcd/members")}function nt(t,a){return o.post("/api/etcd/members",{name:t,peer_urls:a})}function at(t,a){return o.put(`/api/etcd/members/${t}`,{peer_urls:a})}function ut(t){return o.delete(`/api/etcd/members/${t}`)}function ot(t){return o.get(`/api/etcd/kv/${encodeURIComponent(t)}`)}function rt(t){return o.get("/api/etcd/kv",{params:{prefix:t}})}function it(t,a,i,l){return o.put(`/api/etcd/kv/${encodeURIComponent(t)}${i||l?"?":""}${i?`lease=${i}`:""}${i&&l?"&":""}${l?"prev_kv=true":""}`,{value:a})}function lt(t,a=!1){return o.delete(`/api/etcd/kv/${encodeURIComponent(t)}${a?"?prefix=true":""}`)}function ct(t){return o.post("/api/etcd/leases",{ttl:t})}function dt(t){return o.put(`/api/etcd/leases/${t}/keepalive`)}function pt(t){return o.delete(`/api/etcd/leases/${t}`)}function mt(){return o.put("/api/etcd/auth/enable")}function ft(){return o.put("/api/etcd/auth/disable")}function _t(){return o.get("/api/etcd/leases")}const vt=Object.freeze(Object.defineProperty({__proto__:null,queryEtcdStatus:Xe,startEtcdServer:Ze,stopEtcdServer:et,restartEtcdServer:tt,queryEtcdMembers:st,addEtcdMember:nt,updateEtcdMember:at,deleteEtcdMember:ut,getEtcdKeyValue:ot,getEtcdPrefixKeyValue:rt,putEtcdKeyValue:it,deleteEtcdKeyValue:lt,createEtcdLease:ct,renewEtcdLease:dt,revokeEtcdLease:pt,enableEtcdAuth:mt,disableEtcdAuth:ft,getAllEtcdLeases:_t},Symbol.toStringTag,{value:"Module"})),h="/api/monitoring",gt=(t="-1h",a,i,l)=>{const d={start:t};return a&&(d.end=a),i&&(d.source=i),l&&(d.endpoint=l),o.get(`${h}/api-metrics/response-time`,{params:d})},ht=(t="-1h",a,i,l)=>{const d={start:t};return a&&(d.end=a),i&&(d.source=i),l&&(d.endpoint=l),o.get(`${h}/api-metrics/error-rate`,{params:d})},bt=(t="-1h",a,i,l)=>{const d={start:t};return a&&(d.end=a),i&&(d.source=i),l&&(d.endpoint=l),o.get(`${h}/api-metrics/qps`,{params:d})},yt=(t="-1h",a,i)=>{const l={start:t};return a&&(l.end=a),i&&(l.source=i),o.get(`${h}/api-metrics/distribution`,{params:l})},Ct=(t="-1h",a,i,l)=>{const d={start:t};return a&&(d.end=a),i&&(d.source=i),l&&(d.endpoint=l),o.get(`${h}/api-metrics/summary`,{params:d})},Et=()=>o.get(`${h}/api-metrics/sources`),At=t=>o.get(`${h}/api-metrics/endpoints`,{params:{source:t}}),Dt=Object.freeze(Object.defineProperty({__proto__:null,getApiResponseTime:gt,getApiErrorRate:ht,getApiRequestCount:bt,getApiDistribution:yt,getApiMetricsSummary:Ct,getApiSources:Et,getApiEndpoints:At},Symbol.toStringTag,{value:"Module"}));g(Ve);g(Me);const St=g(Te);g(We);g(vt);g(Ke);g(ne);g(Dt);function g(t){const a={};for(const i in t){const l=t[i];typeof l=="function"?a[i]=Ie(l):a[i]=l}return a}const $t={class:"container"},kt={class:"tab-content"},Ft={key:0,class:"loading-container"},Bt={class:"app-card-title"},xt={class:"app-name"},Rt={class:"app-card-content"},wt={class:"app-card-info"},Vt={class:"info-item"},Mt={class:"value"},Tt={class:"info-item"},It={class:"value"},Kt={class:"info-item"},Lt={class:"value"},Nt={key:0,class:"app-card-metrics"},Ot={class:"metric-item"},Pt={class:"metric-value"},Ut={class:"metric-item"},jt={class:"metric-value"},qt={class:"metric-item"},zt={class:"metric-item"},Ht={class:"metric-value"},Qt={key:1,class:"app-card-no-metrics"},Yt=["onClick"],Gt={name:"ServiceMonitor"},Jt=re({...Gt,setup(t){const a=we(),i=b(!1),l=b([]),d=b(""),$=b("card"),k=b(!1),F=b("1h"),B=ie(()=>{let r=[...l.value];if(d.value){const e=d.value.toLowerCase();r=r.filter(v=>v.name.toLowerCase().includes(e))}return k.value&&(r=r.filter(e=>e.instances.filter(y=>y.healthStatus==="healthy").length>0)),r}),x=async()=>{i.value=!0;try{l.value=await St.getAllAppServices(F.value),z.success("\u6570\u636E\u5DF2\u5237\u65B0")}catch(r){console.error("\u5237\u65B0\u5E94\u7528\u670D\u52A1\u5217\u8868\u5931\u8D25:",r),z.error("\u83B7\u53D6\u670D\u52A1\u5217\u8868\u5931\u8D25")}finally{i.value=!1}},T=r=>{if(!r.instances||r.instances.length===0)return"\u65E0\u8282\u70B9";const e=r.instances.filter(v=>v.healthStatus==="healthy").length;return e===r.instances.length?"\u5065\u5EB7":e>0?`\u90E8\u5206\u5065\u5EB7 (${e}/${r.instances.length})`:"\u4E0D\u5065\u5EB7"},I=r=>{if(!r.instances||r.instances.length===0)return"gray";const e=r.instances.filter(v=>v.healthStatus==="healthy").length;return e===r.instances.length?"green":e>0?"orange":"red"},H=()=>{},D=(r,e=0)=>r==null?"-":r.toLocaleString("zh-CN",{maximumFractionDigits:e}),K=r=>r==null?"-":r<1?"< 1ms":r<1e3?`${r.toFixed(0)}ms`:`${(r/1e3).toFixed(2)}s`,L=r=>r==null?"-":`${(r*100).toFixed(2)}%`,R=r=>{a.push({name:"ServiceDetail",params:{serviceName:r}})},Q=r=>{a.push("/distributed/serviceDiscovery")};return le(()=>{x()}),(r,e)=>{const v=me,y=fe,C=_e,Y=ve,G=ge,w=he,V=be,J=ye,N=Ce,W=Ee,O=Ae,X=De,P=Se,U=$e,f=ke,Z=Fe,ee=Be,te=xe,se=Re;return _(),E("div",$t,[u(U,{class:"feature-card",title:"\u670D\u52A1\u76D1\u63A7"},{extra:n(()=>[u(v,{content:"\u76D1\u63A7\u4E0E\u670D\u52A1\u53D1\u73B0\u96C6\u6210"},{default:n(()=>[u(j(ae))]),_:1})]),default:n(()=>[u(se,{"default-active-key":"app-list"},{default:n(()=>[u(te,{key:"app-list",title:"\u5E94\u7528\u5217\u8868"},{default:n(()=>[c("div",kt,[u(O,{style:{"margin-bottom":"16px"}},{default:n(()=>[u(V,{span:12},{default:n(()=>[u(w,null,{default:n(()=>[u(y,{type:"primary",onClick:x},{icon:n(()=>[u(j(ue))]),default:n(()=>[e[4]||(e[4]=p(" \u5237\u65B0 "))]),_:1}),u(Y,{modelValue:F.value,"onUpdate:modelValue":e[0]||(e[0]=s=>F.value=s),placeholder:"\u65F6\u95F4\u8303\u56F4",style:{width:"120px"},onChange:x},{default:n(()=>[u(C,{value:"1h"},{default:n(()=>e[5]||(e[5]=[p("\u6700\u8FD11\u5C0F\u65F6")])),_:1}),u(C,{value:"6h"},{default:n(()=>e[6]||(e[6]=[p("\u6700\u8FD16\u5C0F\u65F6")])),_:1}),u(C,{value:"12h"},{default:n(()=>e[7]||(e[7]=[p("\u6700\u8FD112\u5C0F\u65F6")])),_:1}),u(C,{value:"24h"},{default:n(()=>e[8]||(e[8]=[p("\u6700\u8FD11\u5929")])),_:1}),u(C,{value:"7d"},{default:n(()=>e[9]||(e[9]=[p("\u6700\u8FD17\u5929")])),_:1})]),_:1},8,["modelValue"]),u(G,{modelValue:d.value,"onUpdate:modelValue":e[1]||(e[1]=s=>d.value=s),placeholder:"\u641C\u7D22\u670D\u52A1\u540D\u79F0",style:{width:"200px"},onSearch:H},null,8,["modelValue"])]),_:1})]),_:1}),u(V,{span:12,class:"text-right"},{default:n(()=>[u(w,null,{default:n(()=>[u(J,{modelValue:k.value,"onUpdate:modelValue":e[2]||(e[2]=s=>k.value=s)},{checked:n(()=>e[10]||(e[10]=[p("\u53EA\u663E\u793A\u5065\u5EB7\u670D\u52A1")])),unchecked:n(()=>e[11]||(e[11]=[p("\u663E\u793A\u6240\u6709\u670D\u52A1")])),_:1},8,["modelValue"]),u(W,{modelValue:$.value,"onUpdate:modelValue":e[3]||(e[3]=s=>$.value=s),type:"button"},{default:n(()=>[u(N,{value:"card"},{default:n(()=>e[12]||(e[12]=[p("\u5361\u7247\u89C6\u56FE")])),_:1}),u(N,{value:"table"},{default:n(()=>e[13]||(e[13]=[p("\u8868\u683C\u89C6\u56FE")])),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),i.value?(_(),E("div",Ft,[u(X,{tip:"\u52A0\u8F7D\u4E2D..."})])):$.value==="card"?(_(),S(O,{key:1,gutter:[16,16]},{default:n(()=>[(_(!0),E(ce,null,de(B.value,s=>(_(),S(V,{key:s.name,span:8,xs:24,sm:12,md:8,lg:6},{default:n(()=>[u(U,{class:"app-card",hoverable:"",onClick:M=>R(s.name)},{title:n(()=>[c("div",Bt,[c("span",xt,m(s.name),1),u(P,{color:I(s)},{default:n(()=>[p(m(T(s)),1)]),_:2},1032,["color"])])]),default:n(()=>[c("div",Rt,[c("div",wt,[c("div",Vt,[e[14]||(e[14]=c("span",{class:"label"},"\u8282\u70B9\u6570:",-1)),c("span",Mt,m(s.instances.length),1)]),c("div",Tt,[e[15]||(e[15]=c("span",{class:"label"},"\u63A5\u53E3\u6570:",-1)),c("span",It,m(s.endpoints.length),1)]),c("div",Kt,[e[16]||(e[16]=c("span",{class:"label"},"\u7248\u672C:",-1)),c("span",Lt,m(s.version||"\u672A\u77E5"),1)])]),s.metrics?(_(),E("div",Nt,[c("div",Ot,[e[17]||(e[17]=c("span",{class:"metric-label"},"\u603B\u8C03\u7528:",-1)),c("span",Pt,m(D(s.metrics.totalCalls)),1)]),c("div",Ut,[e[18]||(e[18]=c("span",{class:"metric-label"},"\u5E73\u5747\u54CD\u5E94:",-1)),c("span",jt,m(K(s.metrics.avgResponseTime)),1)]),c("div",qt,[e[19]||(e[19]=c("span",{class:"metric-label"},"\u9519\u8BEF\u7387:",-1)),c("span",{class:q(["metric-value",{"error-rate-high":s.metrics.errorRate>.1}])},m(L(s.metrics.errorRate)),3)]),c("div",zt,[e[20]||(e[20]=c("span",{class:"metric-label"},"QPS:",-1)),c("span",Ht,m(D(s.metrics.qps,2))+"/\u79D2",1)])])):(_(),E("div",Qt," \u6682\u65E0\u76D1\u63A7\u6570\u636E "))])]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})):(_(),S(Z,{key:2,loading:i.value,data:B.value,pagination:!1,bordered:!1},{columns:n(()=>[u(f,{title:"\u670D\u52A1\u540D\u79F0","data-index":"name"},{cell:n(({record:s})=>[c("a",{onClick:M=>R(s.name)},m(s.name),9,Yt)]),_:1}),u(f,{title:"\u5065\u5EB7\u72B6\u6001"},{cell:n(({record:s})=>[u(P,{color:I(s)},{default:n(()=>[p(m(T(s)),1)]),_:2},1032,["color"])]),_:1}),u(f,{title:"\u8282\u70B9\u6570"},{cell:n(({record:s})=>[p(m(s.instances.length),1)]),_:1}),u(f,{title:"\u63A5\u53E3\u6570"},{cell:n(({record:s})=>[p(m(s.endpoints.length),1)]),_:1}),u(f,{title:"\u603B\u8C03\u7528\u6B21\u6570"},{cell:n(({record:s})=>[p(m(s.metrics?D(s.metrics.totalCalls):"-"),1)]),_:1}),u(f,{title:"\u5E73\u5747\u54CD\u5E94\u65F6\u95F4"},{cell:n(({record:s})=>[p(m(s.metrics?K(s.metrics.avgResponseTime):"-"),1)]),_:1}),u(f,{title:"\u9519\u8BEF\u7387"},{cell:n(({record:s})=>[c("span",{class:q({"error-rate-high":s.metrics&&s.metrics.errorRate>.1})},m(s.metrics?L(s.metrics.errorRate):"-"),3)]),_:1}),u(f,{title:"QPS"},{cell:n(({record:s})=>[p(m(s.metrics?D(s.metrics.qps,2)+"/\u79D2":"-"),1)]),_:1}),u(f,{title:"\u64CD\u4F5C",width:150},{cell:n(({record:s})=>[u(w,null,{default:n(()=>[u(y,{type:"text",size:"small",onClick:M=>R(s.name)},{default:n(()=>e[21]||(e[21]=[p(" \u8BE6\u60C5 ")])),_:2},1032,["onClick"]),u(y,{type:"text",size:"small",onClick:M=>Q(s.name)},{default:n(()=>e[22]||(e[22]=[p(" \u670D\u52A1\u8282\u70B9 ")])),_:2},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["loading","data"])),B.value.length===0&&!i.value?(_(),S(ee,{key:3,description:"\u672A\u627E\u5230\u670D\u52A1"})):pe("",!0)])]),_:1})]),_:1})]),_:1})])}}});const ds=oe(Jt,[["__scopeId","data-v-d9b5bc9b"]]);export{ds as default};
