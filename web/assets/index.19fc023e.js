import{B as se,t as pe,_ as ce}from"./index.a81c3a0f.js";/* empty css                *//* empty css              *//* empty css              *//* empty css              *//* empty css               *//* empty css                *//* empty css               *//* empty css               *//* empty css               */import{d as _e,j as C,r as k,o as me,C as c,D as m,aI as l,aH as r,aM as n,aN as s,u as Ee,E as fe,aK as A,aE as P,aJ as R,aF as L,aX as _,b2 as $,aT as De,a6 as Ae,aY as Ce,ba as ve,bO as Se,bP as ye,bQ as Te,bR as be,bS as Ie,b7 as Ve,bc as Oe,bT as Ne,bU as ge,bX as Ke,aZ as Pe,af as Fe,bZ as Be,bb as Ye,bV as Ue,bl as ke,bW as Re}from"./arco.2804d378.js";import{u as Le}from"./loading.4e91d3ac.js";import{a as $e,e as we,f as Ge,h as We}from"./cert.13906509.js";import"./chart.9f128c58.js";import"./vue.bbad6851.js";const Me={class:"container"},qe={class:"form-tip-text"},He=_e({__name:"index",setup(je){const{loading:w,setLoading:F}=Le(!0),B=C([]),N=k({...{current:1,pageSize:10,total:0}}),G=C(),t=k({name:"",providerType:"",credentials:{}}),v=C(""),S=C(!1),I=C(!1),E=C(null);async function V(){F(!0);try{const{data:a}=await $e();a&&(B.value=a.map(e=>({...e,providerType:e.providerType||"unknown"})),N.total=a.length)}catch{_.error({content:"\u83B7\u53D6DNS\u63D0\u4F9B\u5546\u5217\u8868\u5931\u8D25",duration:5e3})}finally{F(!1)}}async function W(){}me(()=>{V(),W()});const M=a=>{N.current=a},q=()=>{t.name="",t.providerType="",t.credentials={},v.value="",S.value=!0},H=a=>{switch(t.credentials={},a){case"aliyun":t.credentials.ALICLOUD_ACCESS_KEY="",t.credentials.ALICLOUD_SECRET_KEY="";break;case"cloudflare":t.credentials.CF_API_TOKEN="";break;case"dnspod":t.credentials.TENCENTCLOUD_SECRET_ID="",t.credentials.TENCENTCLOUD_SECRET_KEY="";break;case"godaddy":t.credentials.GODADDY_API_KEY="",t.credentials.GODADDY_API_SECRET="";break;case"route53":t.credentials.AWS_ACCESS_KEY_ID="",t.credentials.AWS_SECRET_ACCESS_KEY="",t.credentials.AWS_REGION="us-east-1";break;case"digitalocean":t.credentials.DO_AUTH_TOKEN="";break;case"namesilo":t.credentials.NAMESILO_API_KEY="";break}},j=()=>{const a=v.value.trim();if(!a){_.warning("\u51ED\u8BC1\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A");return}if(t.credentials[a]!==void 0){_.warning("\u51ED\u8BC1\u540D\u79F0\u5DF2\u5B58\u5728");return}t.credentials[a]="",v.value=""},z=a=>{const e=Object.fromEntries(Object.entries(t.credentials).filter(([p])=>p!==a));t.credentials=e},Z=async()=>{const{name:a,providerType:e,credentials:p}=t;if(!a)return _.error("\u8BF7\u586B\u5199\u63D0\u4F9B\u5546\u540D\u79F0"),!1;if(!e)return _.error("\u8BF7\u9009\u62E9\u63D0\u4F9B\u5546\u7C7B\u578B"),!1;if(Object.keys(p).length===0)return _.error("\u8BF7\u81F3\u5C11\u6DFB\u52A0\u4E00\u4E2A\u51ED\u8BC1"),!1;for(const[f,g]of Object.entries(p))if(!g)return _.error(`\u51ED\u8BC1 ${f} \u4E0D\u80FD\u4E3A\u7A7A`),!1;try{await we(a,e,p),_.success("\u6DFB\u52A0DNS\u63D0\u4F9B\u5546\u6210\u529F"),S.value=!1,V()}catch{return _.error("\u6DFB\u52A0DNS\u63D0\u4F9B\u5546\u5931\u8D25"),!1}},X=async a=>{try{const{data:e}=await Ge(a.name);if(e){const p=e;E.value={...p,providerType:p.providerType||p.credentials&&p.credentials._PROVIDER_TYPE||a.providerType||"unknown"},I.value=!0}}catch{_.error({content:"\u83B7\u53D6DNS\u63D0\u4F9B\u5546\u8BE6\u60C5\u5931\u8D25",duration:5e3})}},J=a=>{$.warning({title:"\u786E\u8BA4\u5220\u9664",content:`\u786E\u5B9A\u8981\u5220\u9664DNS\u63D0\u4F9B\u5546 ${a.name} \u5417\uFF1F`,onOk:async()=>{try{await We(a.name),V()}catch{_.error("\u5220\u9664\u5931\u8D25")}}})},O=a=>a?De(a).format("YYYY-MM-DD HH:mm:ss"):"-",Q=a=>a?a.length<=4?"****":a.substring(0,2)+"****"+a.substring(a.length-2):"",Y=a=>a?{aliyun:"\u963F\u91CC\u4E91 DNS (AliDNS)",cloudflare:"Cloudflare",dnspod:"\u817E\u8BAF\u4E91 DNS (DNSPod)",godaddy:"GoDaddy",route53:"AWS Route53",digitalocean:"DigitalOcean",namesilo:"Namesilo",custom:"\u81EA\u5B9A\u4E49"}[a]||a:"-";return(a,e)=>{const p=Ae,f=Ce,g=pe,K=ve,x=Se,h=ye,y=Te,ee=be,le=Ie,u=Ve,i=Oe,D=Ne,te=ge,ae=Ke,re=Pe,oe=Fe,ne=Be,de=Ye,U=$,T=Ue,ue=ke,ie=Re;return c(),m("div",Me,[l(se,{items:["menu.operation.cert","menu.operation.cert.providers"]}),l(le,{class:"general-card",title:a.$t("menu.operation.cert.providers")},{default:r(()=>[l(h,{style:{"margin-bottom":"16px"}},{default:r(()=>[l(x,{flex:1},{default:r(()=>[l(K,null,{default:r(()=>[l(f,{type:"primary",onClick:q},{icon:r(()=>[l(p)]),default:r(()=>[n(" "+s(a.$t("cert.providers.add")),1)]),_:1}),l(f,{onClick:V},{icon:r(()=>[l(g)]),default:r(()=>[n(" "+s(a.$t("cert.refresh")),1)]),_:1})]),_:1})]),_:1})]),_:1}),l(ee,{"row-key":"name",loading:Ee(w),pagination:N,data:B.value,bordered:!1,onPageChange:M},{columns:r(()=>[l(y,{title:a.$t("cert.providers.name"),"data-index":"name"},null,8,["title"]),l(y,{title:a.$t("cert.providers.type"),"data-index":"providerType"},{cell:r(({record:o})=>[n(s(Y(o.providerType)),1)]),_:1},8,["title"]),l(y,{title:a.$t("cert.providers.createdAt"),"data-index":"createdAt"},{cell:r(({record:o})=>[n(s(O(o.createdAt)),1)]),_:1},8,["title"]),l(y,{title:a.$t("cert.providers.updatedAt"),"data-index":"updatedAt"},{cell:r(({record:o})=>[n(s(O(o.updatedAt)),1)]),_:1},8,["title"]),l(y,{title:a.$t("cert.operations"),"data-index":"operations",width:180},{cell:r(({record:o})=>[l(K,null,{default:r(()=>[l(f,{type:"text",size:"small",onClick:d=>X(o)},{default:r(()=>[n(s(a.$t("cert.view")),1)]),_:2},1032,["onClick"]),l(f,{type:"text",status:"danger",size:"small",onClick:d=>J(o)},{default:r(()=>[n(s(a.$t("cert.delete")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:1},8,["title"])]),_:1},8,["loading","pagination","data"])]),_:1},8,["title"]),l(U,{visible:S.value,"onUpdate:visible":e[15]||(e[15]=o=>S.value=o),title:a.$t("cert.providers.add"),width:580,onCancel:e[16]||(e[16]=o=>S.value=!1),onBeforeOk:Z},{default:r(()=>[l(de,{ref_key:"formRef",ref:G,model:t,"label-col-props":{span:6},"wrapper-col-props":{span:18}},{default:r(()=>[l(i,{field:"name",label:a.$t("cert.providers.name"),required:""},{default:r(()=>[l(u,{modelValue:t.name,"onUpdate:modelValue":e[0]||(e[0]=o=>t.name=o),placeholder:a.$t("cert.providers.namePlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),fe("div",qe,s(a.$t("cert.providers.nameHelp")),1),l(i,{field:"providerType",label:a.$t("cert.providers.type"),required:""},{default:r(()=>[l(te,{modelValue:t.providerType,"onUpdate:modelValue":e[1]||(e[1]=o=>t.providerType=o),placeholder:a.$t("cert.providers.selectType"),onChange:H},{default:r(()=>[l(D,{value:"aliyun"},{default:r(()=>e[19]||(e[19]=[n("\u963F\u91CC\u4E91 DNS (AliDNS)")])),_:1}),l(D,{value:"cloudflare"},{default:r(()=>e[20]||(e[20]=[n("Cloudflare")])),_:1}),l(D,{value:"dnspod"},{default:r(()=>e[21]||(e[21]=[n("\u817E\u8BAF\u4E91 DNS (DNSPod)")])),_:1}),l(D,{value:"godaddy"},{default:r(()=>e[22]||(e[22]=[n("GoDaddy")])),_:1}),l(D,{value:"route53"},{default:r(()=>e[23]||(e[23]=[n("AWS Route53")])),_:1}),l(D,{value:"digitalocean"},{default:r(()=>e[24]||(e[24]=[n("DigitalOcean")])),_:1}),l(D,{value:"namesilo"},{default:r(()=>e[25]||(e[25]=[n("Namesilo")])),_:1}),l(D,{value:"custom"},{default:r(()=>e[26]||(e[26]=[n("\u81EA\u5B9A\u4E49")])),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),l(ae,null,{default:r(()=>[n(s(a.$t("cert.providers.credentials")),1)]),_:1}),t.providerType==="aliyun"?(c(),m(A,{key:0},[l(i,{field:"ALICLOUD_ACCESS_KEY",label:"Access Key",required:""},{default:r(()=>[l(u,{modelValue:t.credentials.ALICLOUD_ACCESS_KEY,"onUpdate:modelValue":e[2]||(e[2]=o=>t.credentials.ALICLOUD_ACCESS_KEY=o),placeholder:"\u963F\u91CC\u4E91AccessKey"},null,8,["modelValue"])]),_:1}),l(i,{field:"ALICLOUD_SECRET_KEY",label:"Secret Key",required:""},{default:r(()=>[l(u,{modelValue:t.credentials.ALICLOUD_SECRET_KEY,"onUpdate:modelValue":e[3]||(e[3]=o=>t.credentials.ALICLOUD_SECRET_KEY=o),placeholder:"\u963F\u91CC\u4E91SecretKey"},null,8,["modelValue"])]),_:1})],64)):t.providerType==="cloudflare"?(c(),m(A,{key:1},[l(i,{field:"CF_API_TOKEN",label:"API Token (\u63A8\u8350)",required:""},{default:r(()=>[l(u,{modelValue:t.credentials.CF_API_TOKEN,"onUpdate:modelValue":e[4]||(e[4]=o=>t.credentials.CF_API_TOKEN=o),placeholder:"Cloudflare API Token"},null,8,["modelValue"])]),_:1}),l(re,{type:"info"},{message:r(()=>e[27]||(e[27]=[n(" \u5728 Cloudflare \u63A7\u5236\u53F0 Profile > API Tokens \u9875\u9762\u521B\u5EFA API Token\uFF0C\u9700\u8981\u5305\u542B Zone-DNS-Edit \u6743\u9650 ")])),_:1})],64)):t.providerType==="dnspod"?(c(),m(A,{key:2},[l(i,{field:"TENCENTCLOUD_SECRET_ID",label:"SecretId",required:""},{default:r(()=>[l(u,{modelValue:t.credentials.TENCENTCLOUD_SECRET_ID,"onUpdate:modelValue":e[5]||(e[5]=o=>t.credentials.TENCENTCLOUD_SECRET_ID=o),placeholder:"\u817E\u8BAF\u4E91SecretId"},null,8,["modelValue"])]),_:1}),l(i,{field:"TENCENTCLOUD_SECRET_KEY",label:"SecretKey",required:""},{default:r(()=>[l(u,{modelValue:t.credentials.TENCENTCLOUD_SECRET_KEY,"onUpdate:modelValue":e[6]||(e[6]=o=>t.credentials.TENCENTCLOUD_SECRET_KEY=o),placeholder:"\u817E\u8BAF\u4E91SecretKey"},null,8,["modelValue"])]),_:1})],64)):t.providerType==="godaddy"?(c(),m(A,{key:3},[l(i,{field:"GODADDY_API_KEY",label:"API Key",required:""},{default:r(()=>[l(u,{modelValue:t.credentials.GODADDY_API_KEY,"onUpdate:modelValue":e[7]||(e[7]=o=>t.credentials.GODADDY_API_KEY=o),placeholder:"GoDaddy API Key"},null,8,["modelValue"])]),_:1}),l(i,{field:"GODADDY_API_SECRET",label:"API Secret",required:""},{default:r(()=>[l(u,{modelValue:t.credentials.GODADDY_API_SECRET,"onUpdate:modelValue":e[8]||(e[8]=o=>t.credentials.GODADDY_API_SECRET=o),placeholder:"GoDaddy API Secret"},null,8,["modelValue"])]),_:1})],64)):t.providerType==="route53"?(c(),m(A,{key:4},[l(i,{field:"AWS_ACCESS_KEY_ID",label:"Access Key ID",required:""},{default:r(()=>[l(u,{modelValue:t.credentials.AWS_ACCESS_KEY_ID,"onUpdate:modelValue":e[9]||(e[9]=o=>t.credentials.AWS_ACCESS_KEY_ID=o),placeholder:"AWS Access Key ID"},null,8,["modelValue"])]),_:1}),l(i,{field:"AWS_SECRET_ACCESS_KEY",label:"Secret Access Key",required:""},{default:r(()=>[l(u,{modelValue:t.credentials.AWS_SECRET_ACCESS_KEY,"onUpdate:modelValue":e[10]||(e[10]=o=>t.credentials.AWS_SECRET_ACCESS_KEY=o),placeholder:"AWS Secret Access Key"},null,8,["modelValue"])]),_:1}),l(i,{field:"AWS_REGION",label:"Region"},{default:r(()=>[l(u,{modelValue:t.credentials.AWS_REGION,"onUpdate:modelValue":e[11]||(e[11]=o=>t.credentials.AWS_REGION=o),placeholder:"us-east-1"},null,8,["modelValue"])]),_:1})],64)):t.providerType==="digitalocean"?(c(),P(i,{key:5,field:"DO_AUTH_TOKEN",label:"API Token",required:""},{default:r(()=>[l(u,{modelValue:t.credentials.DO_AUTH_TOKEN,"onUpdate:modelValue":e[12]||(e[12]=o=>t.credentials.DO_AUTH_TOKEN=o),placeholder:"DigitalOcean API Token"},null,8,["modelValue"])]),_:1})):t.providerType==="namesilo"?(c(),P(i,{key:6,field:"NAMESILO_API_KEY",label:"API Key",required:""},{default:r(()=>[l(u,{modelValue:t.credentials.NAMESILO_API_KEY,"onUpdate:modelValue":e[13]||(e[13]=o=>t.credentials.NAMESILO_API_KEY=o),placeholder:"Namesilo API Key"},null,8,["modelValue"])]),_:1})):t.providerType==="custom"?(c(),m(A,{key:7},[(c(!0),m(A,null,R(t.credentials,(o,d)=>(c(),P(i,{key:d,field:`credentials.${d}`,label:d},{default:r(()=>[l(ne,null,{default:r(()=>[l(u,{modelValue:t.credentials[d],"onUpdate:modelValue":b=>t.credentials[d]=b,style:{width:"calc(100% - 40px)"}},null,8,["modelValue","onUpdate:modelValue"]),l(f,{status:"danger",onClick:b=>z(d)},{icon:r(()=>[l(oe)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["field","label"]))),128)),l(K,{style:{"margin-bottom":"24px"}},{default:r(()=>[l(u,{modelValue:v.value,"onUpdate:modelValue":e[14]||(e[14]=o=>v.value=o),placeholder:"\u51ED\u8BC1\u540D\u79F0"},null,8,["modelValue"]),l(f,{type:"outline",onClick:j},{icon:r(()=>[l(p)]),default:r(()=>[e[28]||(e[28]=n(" \u6DFB\u52A0\u51ED\u8BC1 "))]),_:1})]),_:1})],64)):L("",!0)]),_:1},8,["model"])]),_:1},8,["visible","title"]),l(U,{visible:I.value,"onUpdate:visible":e[17]||(e[17]=o=>I.value=o),title:a.$t("cert.providers.detail"),footer:!1,width:580,onCancel:e[18]||(e[18]=o=>I.value=!1)},{default:r(()=>{var o;return[l(ie,{title:(o=E.value)==null?void 0:o.name,bordered:""},{default:r(()=>[l(T,{label:a.$t("cert.providers.name"),span:3},{default:r(()=>{var d;return[n(s((d=E.value)==null?void 0:d.name),1)]}),_:1},8,["label"]),l(T,{label:a.$t("cert.providers.type"),span:3},{default:r(()=>{var d;return[n(s(Y((d=E.value)==null?void 0:d.providerType)),1)]}),_:1},8,["label"]),l(T,{label:a.$t("cert.providers.createdAt"),span:3},{default:r(()=>{var d;return[n(s(O((d=E.value)==null?void 0:d.createdAt)),1)]}),_:1},8,["label"]),l(T,{label:a.$t("cert.providers.updatedAt"),span:3},{default:r(()=>{var d;return[n(s(O((d=E.value)==null?void 0:d.updatedAt)),1)]}),_:1},8,["label"]),l(T,{label:a.$t("cert.providers.credentials"),span:3},{default:r(()=>[E.value&&E.value.credentials?(c(!0),m(A,{key:0},R(E.value.credentials,(d,b)=>(c(),m("div",{key:b,style:{"margin-bottom":"8px"}},[l(ue,null,{default:r(()=>[n(s(b),1)]),_:2},1024),n(": "+s(Q(d)),1)]))),128)):L("",!0)]),_:1},8,["label"])]),_:1},8,["title"])]}),_:1},8,["visible","title"])])}}});const il=ce(He,[["__scopeId","data-v-8d26b885"]]);export{il as default};
