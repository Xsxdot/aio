import{Q as fe,t as Fe,_ as De}from"./index.15381f0b.js";/* empty css              *//* empty css               *//* empty css              *//* empty css              *//* empty css                *//* empty css               *//* empty css               *//* empty css               *//* empty css               */import{d as ce,j as F,c as _e,r as Z,C as E,D as J,aI as u,aH as t,u as Ee,E as n,aM as l,aN as v,aE as w,aK as ge,aJ as Ce,aX as p,bx as Ae,aY as Be,a6 as be,c4 as Ve,ba as ye,bO as Se,b$ as xe,c0 as we,bP as ke,bl as Ue,bQ as Oe,bX as Re,bR as Te,cc as Ie,cd as Ne,bA as Je,b7 as $e,bc as Pe,bT as ze,bU as Me,aV as qe,b_ as He,bb as je,b2 as Le,bY as Qe,bS as We}from"./arco.2804d378.js";import{a as Xe,r as Ye,u as Ge,b as Ke,c as Ze}from"./distributed.0f0884be.js";import"./chart.100020e2.js";import"./vue.bbad6851.js";const he={class:"container"},eu={class:"tab-content"},uu={class:"service-header"},tu={class:"service-name"},au={key:0},lu={class:"health-item"},ou={class:"health-item"},su={class:"health-item"},du={class:"health-item"},nu={class:"health-item"},ru={class:"health-item"},iu={class:"health-item"},mu={name:"ServiceDiscovery"},pu=ce({...mu,setup(vu){const b=F(!1),V=F([]),y=F([]),S=F(""),k=F("grouped"),$=F([]),P=_e(()=>{const o={};return y.value.forEach(e=>{o[e.name]||(o[e.name]=[]),o[e.name].push(e)}),o}),U=F(!1),h=F(),s=Z({name:"",address:"",protocol:"http",env:"",weight:100,status:"active",metadata:""}),O=F(!1),ee=F(),d=Z({id:"",address:"",protocol:"http",env:"",weight:100,status:"active",metadata:""}),R=F(!1),D=F(null),C=async()=>{try{b.value=!0;const o=await Xe();if(o&&o.code===2e4){const e=o.data,r=[];Object.values(e).forEach(A=>{r.push(...A)}),V.value=r,$.value=Object.keys(P.value)}else V.value=[];z()}catch(o){p.error("\u52A0\u8F7D\u670D\u52A1\u5217\u8868\u5931\u8D25"),console.error(o)}finally{b.value=!1}},z=()=>{S.value?y.value=V.value.filter(o=>o.name.includes(S.value)):y.value=V.value},ue=()=>{z()},te=()=>{s.name="",s.address="",s.protocol="http",s.env="",s.weight=100,s.status="active",s.metadata="",U.value=!0},ae=async()=>{var o;try{if(!s.name||!s.address)return p.error("\u670D\u52A1\u540D\u79F0\u548C\u5730\u5740\u4E0D\u80FD\u4E3A\u7A7A"),!1;let e={};if(s.metadata)try{e=JSON.parse(s.metadata)}catch{return p.error("\u5143\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E\uFF0C\u8BF7\u63D0\u4F9B\u6709\u6548\u7684JSON"),!1}const r=await Ye(s.name,s.address,s.protocol,s.env||void 0,e,s.weight,s.status);if(r.data&&r.data.code===2e4)p.success("\u6CE8\u518C\u670D\u52A1\u6210\u529F"),C();else return p.error(((o=r.data)==null?void 0:o.msg)||"\u6CE8\u518C\u670D\u52A1\u5931\u8D25"),!1}catch(e){return p.error("\u6CE8\u518C\u670D\u52A1\u5931\u8D25"),console.error(e),!1}},M=o=>{d.id=o.id,d.address=o.address,d.protocol=o.protocol,d.env=o.env,d.weight=o.weight,d.status=o.status,d.metadata=JSON.stringify(o.metadata||{},null,2),O.value=!0},le=async()=>{var o;try{if(!d.address)return p.error("\u670D\u52A1\u5730\u5740\u4E0D\u80FD\u4E3A\u7A7A"),!1;let e={};if(d.metadata)try{e=JSON.parse(d.metadata)}catch{return p.error("\u5143\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E\uFF0C\u8BF7\u63D0\u4F9B\u6709\u6548\u7684JSON"),!1}const r=await Ge(d.id,{address:d.address,protocol:d.protocol,env:d.env||void 0,weight:d.weight,status:d.status,metadata:e});if(r.data&&r.data.code===2e4)p.success("\u66F4\u65B0\u670D\u52A1\u6210\u529F"),C();else return p.error(((o=r.data)==null?void 0:o.msg)||"\u66F4\u65B0\u670D\u52A1\u5931\u8D25"),!1}catch(e){return p.error("\u66F4\u65B0\u670D\u52A1\u5931\u8D25"),console.error(e),!1}},q=async o=>{var e;try{const r=await Ke(o.id);r.data&&r.data.code===2e4?p.success("\u7EED\u7EA6\u670D\u52A1\u6210\u529F"):p.error(((e=r.data)==null?void 0:e.msg)||"\u7EED\u7EA6\u670D\u52A1\u5931\u8D25")}catch(r){p.error("\u7EED\u7EA6\u670D\u52A1\u5931\u8D25"),console.error(r)}},H=async o=>{var e;try{const r=await Ze(o.id);r.data&&r.data.code===2e4?(p.success("\u6CE8\u9500\u670D\u52A1\u6210\u529F"),C()):p.error(((e=r.data)==null?void 0:e.msg)||"\u6CE8\u9500\u670D\u52A1\u5931\u8D25")}catch(r){p.error("\u6CE8\u9500\u670D\u52A1\u5931\u8D25"),console.error(r)}};return C(),(o,e)=>{const r=Ae,A=Fe,c=Be,oe=be,se=Ve,T=ye,j=Se,L=xe,de=we,ne=ke,x=Ue,m=Oe,Q=Re,W=Te,re=Ie,ie=Ne,me=Je,I=$e,f=Pe,i=ze,g=Me,X=qe,Y=He,G=je,N=Le,pe=Qe,ve=We;return E(),J("div",he,[u(ve,{class:"feature-card",title:"\u670D\u52A1\u53D1\u73B0"},{extra:t(()=>[u(r,{content:"\u670D\u52A1\u6CE8\u518C\u4E0E\u53D1\u73B0"},{default:t(()=>[u(Ee(fe))]),_:1})]),default:t(()=>[n("div",eu,[u(ne,{style:{"margin-bottom":"16px"}},{default:t(()=>[u(j,{span:12},{default:t(()=>[u(T,null,{default:t(()=>[u(c,{type:"primary",onClick:C},{icon:t(()=>[u(A)]),default:t(()=>[l(" "+v(o.$t("\u5237\u65B0")),1)]),_:1}),u(c,{onClick:te},{icon:t(()=>[u(oe)]),default:t(()=>[l(" "+v(o.$t("\u6CE8\u518C\u670D\u52A1")),1)]),_:1}),u(se,{modelValue:S.value,"onUpdate:modelValue":e[0]||(e[0]=a=>S.value=a),placeholder:"\u670D\u52A1\u540D\u79F0\u8FC7\u6EE4",style:{width:"200px"},onSearch:ue},null,8,["modelValue"])]),_:1})]),_:1}),u(j,{span:12,class:"text-right"},{default:t(()=>[u(de,{modelValue:k.value,"onUpdate:modelValue":e[1]||(e[1]=a=>k.value=a),type:"button"},{default:t(()=>[u(L,{value:"grouped"},{default:t(()=>e[19]||(e[19]=[l("\u6309\u670D\u52A1\u5206\u7EC4")])),_:1}),u(L,{value:"flat"},{default:t(()=>e[20]||(e[20]=[l("\u5E73\u94FA\u89C6\u56FE")])),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),k.value==="grouped"?(E(),w(ie,{key:0,"default-active-key":$.value},{default:t(()=>[(E(!0),J(ge,null,Ce(P.value,(a,B)=>(E(),w(re,{key:B},{header:t(()=>[n("div",uu,[n("span",tu,v(B),1),u(x,{color:"arcoblue"},{default:t(()=>[l(v(a.length)+" \u4E2A\u8282\u70B9",1)]),_:2},1024)])]),default:t(()=>[u(W,{"row-key":"id",pagination:!1,data:a,bordered:!1,loading:b.value},{columns:t(()=>[u(m,{title:"\u8282\u70B9ID","data-index":"id"}),u(m,{title:"\u5730\u5740","data-index":"address"}),u(m,{title:"\u534F\u8BAE","data-index":"protocol"}),u(m,{title:"\u73AF\u5883","data-index":"env"}),u(m,{title:"\u6743\u91CD","data-index":"weight"}),u(m,{title:"\u72B6\u6001","data-index":"status"},{cell:t(({record:_})=>[u(x,{color:_.status==="active"?"green":"orange"},{default:t(()=>[l(v(_.status),1)]),_:2},1032,["color"])]),_:1}),u(m,{title:"\u5143\u6570\u636E","data-index":"metadata"},{cell:t(({record:_})=>[n("pre",null,v(JSON.stringify(_.metadata,null,2)),1)]),_:1}),u(m,{title:"\u6CE8\u518C\u65F6\u95F4","data-index":"registerTime"}),u(m,{title:"\u64CD\u4F5C",width:240},{cell:t(({record:_})=>[u(T,null,{default:t(()=>[u(c,{type:"text",size:"small",onClick:K=>q(_)},{default:t(()=>e[21]||(e[21]=[l(" \u7EED\u7EA6 ")])),_:2},1032,["onClick"]),u(c,{type:"text",size:"small",onClick:K=>M(_)},{default:t(()=>e[22]||(e[22]=[l(" \u66F4\u65B0\u670D\u52A1 ")])),_:2},1032,["onClick"]),u(Q,{style:{height:"16px"},direction:"vertical"}),u(c,{type:"text",status:"danger",size:"small",onClick:K=>H(_)},{default:t(()=>e[23]||(e[23]=[l(" \u6CE8\u9500\u670D\u52A1 ")])),_:2},1032,["onClick"])]),_:2},1024)]),_:1})]),_:2},1032,["data","loading"])]),_:2},1024))),128))]),_:1},8,["default-active-key"])):(E(),w(W,{key:1,"row-key":"id",loading:b.value,pagination:!1,data:y.value,bordered:!1},{columns:t(()=>[u(m,{title:"\u670D\u52A1\u540D\u79F0","data-index":"name"},{cell:t(({record:a})=>[u(me,{status:"processing",text:a.name},null,8,["text"])]),_:1}),u(m,{title:"\u8282\u70B9ID","data-index":"id"}),u(m,{title:"\u5730\u5740","data-index":"address"}),u(m,{title:"\u534F\u8BAE","data-index":"protocol"}),u(m,{title:"\u73AF\u5883","data-index":"env"}),u(m,{title:"\u6743\u91CD","data-index":"weight"}),u(m,{title:"\u72B6\u6001","data-index":"status"},{cell:t(({record:a})=>[u(x,{color:a.status==="active"?"green":"orange"},{default:t(()=>[l(v(a.status),1)]),_:2},1032,["color"])]),_:1}),u(m,{title:"\u5143\u6570\u636E","data-index":"metadata"},{cell:t(({record:a})=>[n("pre",null,v(JSON.stringify(a.metadata,null,2)),1)]),_:1}),u(m,{title:"\u6CE8\u518C\u65F6\u95F4","data-index":"registerTime"}),u(m,{title:"\u64CD\u4F5C",width:240},{cell:t(({record:a})=>[u(T,null,{default:t(()=>[u(c,{type:"text",size:"small",onClick:B=>q(a)},{default:t(()=>e[24]||(e[24]=[l(" \u7EED\u7EA6 ")])),_:2},1032,["onClick"]),u(c,{type:"text",size:"small",onClick:B=>M(a)},{default:t(()=>e[25]||(e[25]=[l(" \u66F4\u65B0\u670D\u52A1 ")])),_:2},1032,["onClick"]),u(Q,{style:{height:"16px"},direction:"vertical"}),u(c,{type:"text",status:"danger",size:"small",onClick:B=>H(a)},{default:t(()=>e[26]||(e[26]=[l(" \u6CE8\u9500\u670D\u52A1 ")])),_:2},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["loading","data"]))]),u(N,{visible:U.value,"onUpdate:visible":e[9]||(e[9]=a=>U.value=a),title:"\u6CE8\u518C\u670D\u52A1",onBeforeOk:ae},{default:t(()=>[u(G,{ref_key:"registerServiceFormRef",ref:h,model:s},{default:t(()=>[u(f,{field:"name",label:"\u670D\u52A1\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u670D\u52A1\u540D\u79F0"}]},{default:t(()=>[u(I,{modelValue:s.name,"onUpdate:modelValue":e[2]||(e[2]=a=>s.name=a),placeholder:"\u8BF7\u8F93\u5165\u670D\u52A1\u540D\u79F0"},null,8,["modelValue"])]),_:1}),u(f,{field:"address",label:"\u670D\u52A1\u5730\u5740",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u670D\u52A1\u5730\u5740"}]},{default:t(()=>[u(I,{modelValue:s.address,"onUpdate:modelValue":e[3]||(e[3]=a=>s.address=a),placeholder:"\u8BF7\u8F93\u5165\u670D\u52A1\u5730\u5740"},null,8,["modelValue"])]),_:1}),u(f,{field:"protocol",label:"\u534F\u8BAE\u7C7B\u578B",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u534F\u8BAE\u7C7B\u578B"}]},{default:t(()=>[u(g,{modelValue:s.protocol,"onUpdate:modelValue":e[4]||(e[4]=a=>s.protocol=a),placeholder:"\u8BF7\u9009\u62E9\u534F\u8BAE\u7C7B\u578B"},{default:t(()=>[u(i,{value:"http"},{default:t(()=>e[27]||(e[27]=[l("HTTP")])),_:1}),u(i,{value:"grpc"},{default:t(()=>e[28]||(e[28]=[l("gRPC")])),_:1}),u(i,{value:"tcp"},{default:t(()=>e[29]||(e[29]=[l("TCP")])),_:1}),u(i,{value:"websocket"},{default:t(()=>e[30]||(e[30]=[l("WebSocket")])),_:1})]),_:1},8,["modelValue"])]),_:1}),u(f,{field:"env",label:"\u73AF\u5883"},{default:t(()=>[u(g,{modelValue:s.env,"onUpdate:modelValue":e[5]||(e[5]=a=>s.env=a),placeholder:"\u8BF7\u9009\u62E9\u73AF\u5883","allow-clear":""},{default:t(()=>[u(i,{value:"development"},{default:t(()=>e[31]||(e[31]=[l("\u5F00\u53D1\u73AF\u5883")])),_:1}),u(i,{value:"testing"},{default:t(()=>e[32]||(e[32]=[l("\u6D4B\u8BD5\u73AF\u5883")])),_:1}),u(i,{value:"staging"},{default:t(()=>e[33]||(e[33]=[l("\u9884\u53D1\u73AF\u5883")])),_:1}),u(i,{value:"production"},{default:t(()=>e[34]||(e[34]=[l("\u751F\u4EA7\u73AF\u5883")])),_:1})]),_:1},8,["modelValue"])]),_:1}),u(f,{field:"weight",label:"\u6743\u91CD"},{default:t(()=>[u(X,{modelValue:s.weight,"onUpdate:modelValue":e[6]||(e[6]=a=>s.weight=a),placeholder:"\u8BF7\u8F93\u5165\u6743\u91CD",min:1,max:1e3},null,8,["modelValue"])]),_:1}),u(f,{field:"status",label:"\u72B6\u6001"},{default:t(()=>[u(g,{modelValue:s.status,"onUpdate:modelValue":e[7]||(e[7]=a=>s.status=a),placeholder:"\u8BF7\u9009\u62E9\u72B6\u6001"},{default:t(()=>[u(i,{value:"active"},{default:t(()=>e[35]||(e[35]=[l("\u6D3B\u8DC3")])),_:1}),u(i,{value:"inactive"},{default:t(()=>e[36]||(e[36]=[l("\u4E0D\u6D3B\u8DC3")])),_:1}),u(i,{value:"maintenance"},{default:t(()=>e[37]||(e[37]=[l("\u7EF4\u62A4\u4E2D")])),_:1})]),_:1},8,["modelValue"])]),_:1}),u(f,{field:"metadata",label:"\u670D\u52A1\u5143\u6570\u636E"},{default:t(()=>[u(Y,{modelValue:s.metadata,"onUpdate:modelValue":e[8]||(e[8]=a=>s.metadata=a),placeholder:"\u53EF\u9009\uFF0CJSON\u683C\u5F0F",rows:"3"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"]),u(N,{visible:O.value,"onUpdate:visible":e[16]||(e[16]=a=>O.value=a),title:"\u66F4\u65B0\u670D\u52A1",onBeforeOk:le},{default:t(()=>[u(G,{ref_key:"updateServiceFormRef",ref:ee,model:d},{default:t(()=>[u(f,{field:"address",label:"\u670D\u52A1\u5730\u5740",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u670D\u52A1\u5730\u5740"}]},{default:t(()=>[u(I,{modelValue:d.address,"onUpdate:modelValue":e[10]||(e[10]=a=>d.address=a),placeholder:"\u8BF7\u8F93\u5165\u670D\u52A1\u5730\u5740"},null,8,["modelValue"])]),_:1}),u(f,{field:"protocol",label:"\u534F\u8BAE\u7C7B\u578B",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u534F\u8BAE\u7C7B\u578B"}]},{default:t(()=>[u(g,{modelValue:d.protocol,"onUpdate:modelValue":e[11]||(e[11]=a=>d.protocol=a),placeholder:"\u8BF7\u9009\u62E9\u534F\u8BAE\u7C7B\u578B"},{default:t(()=>[u(i,{value:"http"},{default:t(()=>e[38]||(e[38]=[l("HTTP")])),_:1}),u(i,{value:"grpc"},{default:t(()=>e[39]||(e[39]=[l("gRPC")])),_:1}),u(i,{value:"tcp"},{default:t(()=>e[40]||(e[40]=[l("TCP")])),_:1}),u(i,{value:"websocket"},{default:t(()=>e[41]||(e[41]=[l("WebSocket")])),_:1})]),_:1},8,["modelValue"])]),_:1}),u(f,{field:"env",label:"\u73AF\u5883"},{default:t(()=>[u(g,{modelValue:d.env,"onUpdate:modelValue":e[12]||(e[12]=a=>d.env=a),placeholder:"\u8BF7\u9009\u62E9\u73AF\u5883","allow-clear":""},{default:t(()=>[u(i,{value:"development"},{default:t(()=>e[42]||(e[42]=[l("\u5F00\u53D1\u73AF\u5883")])),_:1}),u(i,{value:"testing"},{default:t(()=>e[43]||(e[43]=[l("\u6D4B\u8BD5\u73AF\u5883")])),_:1}),u(i,{value:"staging"},{default:t(()=>e[44]||(e[44]=[l("\u9884\u53D1\u73AF\u5883")])),_:1}),u(i,{value:"production"},{default:t(()=>e[45]||(e[45]=[l("\u751F\u4EA7\u73AF\u5883")])),_:1})]),_:1},8,["modelValue"])]),_:1}),u(f,{field:"weight",label:"\u6743\u91CD"},{default:t(()=>[u(X,{modelValue:d.weight,"onUpdate:modelValue":e[13]||(e[13]=a=>d.weight=a),placeholder:"\u8BF7\u8F93\u5165\u6743\u91CD",min:1,max:1e3},null,8,["modelValue"])]),_:1}),u(f,{field:"status",label:"\u72B6\u6001"},{default:t(()=>[u(g,{modelValue:d.status,"onUpdate:modelValue":e[14]||(e[14]=a=>d.status=a),placeholder:"\u8BF7\u9009\u62E9\u72B6\u6001"},{default:t(()=>[u(i,{value:"active"},{default:t(()=>e[46]||(e[46]=[l("\u6D3B\u8DC3")])),_:1}),u(i,{value:"inactive"},{default:t(()=>e[47]||(e[47]=[l("\u4E0D\u6D3B\u8DC3")])),_:1}),u(i,{value:"maintenance"},{default:t(()=>e[48]||(e[48]=[l("\u7EF4\u62A4\u4E2D")])),_:1})]),_:1},8,["modelValue"])]),_:1}),u(f,{field:"metadata",label:"\u670D\u52A1\u5143\u6570\u636E"},{default:t(()=>[u(Y,{modelValue:d.metadata,"onUpdate:modelValue":e[15]||(e[15]=a=>d.metadata=a),placeholder:"\u53EF\u9009\uFF0CJSON\u683C\u5F0F",rows:"3"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"]),u(N,{visible:R.value,"onUpdate:visible":e[17]||(e[17]=a=>R.value=a),title:"\u670D\u52A1\u5065\u5EB7\u72B6\u6001",footer:!1,onCancel:e[18]||(e[18]=a=>R.value=!1)},{default:t(()=>[D.value?(E(),J("div",au,[n("div",lu,[e[49]||(e[49]=n("span",{class:"label"},"\u670D\u52A1ID:",-1)),n("span",null,v(D.value.service_id),1)]),n("div",ou,[e[50]||(e[50]=n("span",{class:"label"},"\u670D\u52A1\u540D\u79F0:",-1)),n("span",null,v(D.value.service_name),1)]),n("div",su,[e[51]||(e[51]=n("span",{class:"label"},"\u5065\u5EB7\u72B6\u6001:",-1)),u(x,{color:D.value.healthy?"green":"red"},{default:t(()=>[l(v(D.value.healthy?"\u5065\u5EB7":"\u4E0D\u5065\u5EB7"),1)]),_:1},8,["color"])]),n("div",du,[e[52]||(e[52]=n("span",{class:"label"},"\u72B6\u6001:",-1)),n("span",null,v(D.value.status),1)]),n("div",nu,[e[53]||(e[53]=n("span",{class:"label"},"\u8FD0\u884C\u65F6\u95F4:",-1)),n("span",null,v(D.value.uptime),1)]),n("div",ru,[e[54]||(e[54]=n("span",{class:"label"},"\u6CE8\u518C\u65F6\u957F:",-1)),n("span",null,v(D.value.register_duration),1)]),n("div",iu,[e[55]||(e[55]=n("span",{class:"label"},"\u6700\u540E\u68C0\u67E5\u65F6\u95F4:",-1)),n("span",null,v(D.value.last_check),1)])])):(E(),w(pe,{key:1,description:"\u6682\u65E0\u5065\u5EB7\u4FE1\u606F"}))]),_:1},8,["visible"])]),_:1})])}}});const xu=De(pu,[["__scopeId","data-v-53288245"]]);export{xu as default};
