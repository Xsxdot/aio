import{g as we,v as uu,E as dt,o as Jt,_ as Ne,F as Kt,G as Pt,H as Rt,J as zt,t as Tu,K as Lt,y as xt,C as Mt,M as qt}from"./index.a81c3a0f.js";/* empty css               *//* empty css              *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css                *//* empty css              *//* empty css               *//* empty css                *//* empty css                *//* empty css               *//* empty css               */import{d as Te,j as E,w as Ce,c as oe,o as nu,C as n,D as m,E as p,aI as e,aH as u,u as k,aM as i,aN as l,a5 as Ht,ae as Nu,aE as z,ao as Wt,Z as nt,aF as re,bC as Gt,c2 as Zt,G as ct,c3 as Ge,bE as Xt,F as Ue,X as Yt,aX as S,n as Eu,aY as Je,bx as _u,ba as Le,b2 as ze,b1 as vt,K as Qt,I as el,aK as se,a6 as Re,af as Ju,aJ as ye,b7 as Ku,bT as gu,bU as Cu,aV as ft,a0 as ul,b$ as Pu,c0 as Ru,r as eu,bF as tl,ac as st,aZ as zu,bO as Lu,c4 as pt,bP as xu,bX as hu,bY as Du,bQ as Ft,bd as yt,aW as ll,b_ as al,bR as Mu,bc as mt,bb as Et,c5 as _t,b8 as ol,c6 as nl,bl as qu,bt as Hu,bW as gt,bS as Ct,ad as sl,aB as ou,bv as il,bs as rl,c7 as dl,bq as cl,br as vl,c8 as fl,bu as pl}from"./arco.2804d378.js";/* empty css                */import"./chart.9f128c58.js";import"./vue.bbad6851.js";async function ht(){try{const B=await we.get("/api/config/");return console.log("API\u539F\u59CB\u54CD\u5E94:",B),B.data&&typeof B.data.data<"u"&&B.data.error===!1?B.data.data:B.data&&B.data.responseCode===2e4&&B.data.hasData===!0?B.data.data?B.data.data:[]:Array.isArray(B.data)?B.data:(console.error("\u65E0\u6CD5\u8BC6\u522B\u7684\u54CD\u5E94\u683C\u5F0F:",B),[])}catch(B){return console.error("\u83B7\u53D6\u914D\u7F6E\u5217\u8868\u5931\u8D25:",B),[]}}async function Fl(B){try{const d=await we.get(`/api/config/${B}`);if(console.log("\u83B7\u53D6\u914D\u7F6E\u8BE6\u60C5\u539F\u59CB\u54CD\u5E94:",d),d.data&&typeof d.data.data<"u"&&d.data.error===!1)return d.data.data;if(d.data&&d.data.responseCode===2e4&&d.data.hasData===!0){if(d.data.data)return d.data.data}else if(d.data&&typeof d.data=="object"&&d.data.key)return d.data;throw new Error(`\u914D\u7F6E\u9879\u4E0D\u5B58\u5728: ${B}`)}catch(d){throw console.error("\u83B7\u53D6\u914D\u7F6E\u9879\u5931\u8D25:",d),d}}async function it(B){try{const d=await we.post("/api/config/",B);return console.log("\u521B\u5EFA\u914D\u7F6E\u54CD\u5E94:",d),d.data&&d.data.error===!1&&d.data.data||d.data&&d.data.responseCode===2e4&&d.data.data?d.data.data:B}catch(d){throw console.error("\u521B\u5EFA\u914D\u7F6E\u9879\u5931\u8D25:",d),d}}async function Dt(B,d){try{const r=await we.put(`/api/config/${B}`,d);return console.log("\u66F4\u65B0\u914D\u7F6E\u54CD\u5E94:",r),r.data&&r.data.error===!1&&r.data.data?r.data.data:r.data&&r.data.responseCode===2e4?r.data.data?r.data.data:{key:B,...d}:{key:B,...d}}catch(r){throw console.error("\u66F4\u65B0\u914D\u7F6E\u9879\u5931\u8D25:",r),r}}async function yl(B){try{const d=await we.delete(`/api/config/${B}`);console.log("\u5220\u9664\u914D\u7F6E\u54CD\u5E94:",d);return}catch(d){throw console.error("\u5220\u9664\u914D\u7F6E\u9879\u5931\u8D25:",d),d}}async function ml(B,d=10){try{const r=await we.get(`/api/config/${B}/history?limit=${d}`);return console.log("\u83B7\u53D6\u914D\u7F6E\u5386\u53F2\u54CD\u5E94:",r),r.data&&r.data.error===!1&&r.data.data?r.data.data:r.data&&r.data.responseCode===2e4?r.data.data?r.data.data:[]:Array.isArray(r.data)?r.data:[]}catch(r){return console.error("\u83B7\u53D6\u914D\u7F6E\u5386\u53F2\u5931\u8D25:",r),[]}}async function El(B){try{const d=await we.get(`/api/config/${B}/environments`);if(console.log("\u83B7\u53D6\u73AF\u5883\u914D\u7F6E\u539F\u59CB\u54CD\u5E94:",d),d.data&&typeof d.data.data<"u"&&d.data.error===!1)return d.data.data;if(d.data&&d.data.responseCode===2e4&&d.data.hasData===!0){if(d.data.data)return d.data.data}else if(d.data&&typeof d.data=="object"&&!Array.isArray(d.data))return d.data;return console.error("\u65E0\u6CD5\u8BC6\u522B\u7684\u73AF\u5883\u914D\u7F6E\u54CD\u5E94\u683C\u5F0F:",d),{}}catch(d){return console.error("\u83B7\u53D6\u73AF\u5883\u914D\u7F6E\u5931\u8D25:",d),{}}}async function Qe(B,d,r){try{const C=await we.post(`/api/config/${B}/env/${d}`,r);if(console.log("\u8BBE\u7F6E\u73AF\u5883\u914D\u7F6E\u54CD\u5E94:",C),C.data&&C.data.error===!1&&C.data.data)return C.data.data;if(C.data&&C.data.responseCode===2e4){if(C.data.data)return C.data.data}else if(C.data&&typeof C.data=="object"&&!Array.isArray(C.data))return C.data;throw console.error("\u65E0\u6CD5\u8BC6\u522B\u7684\u73AF\u5883\u914D\u7F6E\u54CD\u5E94\u683C\u5F0F:",C),new Error("\u8BBE\u7F6E\u73AF\u5883\u914D\u7F6E\u5931\u8D25: \u65E0\u6CD5\u8BC6\u522B\u7684\u54CD\u5E94\u683C\u5F0F")}catch(C){throw console.error("\u8BBE\u7F6E\u73AF\u5883\u914D\u7F6E\u5931\u8D25:",C),C}}async function _l(B,d){try{const r=d?`/api/config/${B}/export/env/${d}`:`/api/config/${B}/export`,C=await we.get(r,{headers:{Accept:"application/json"}});return console.log("\u5BFC\u51FA\u914D\u7F6E\u54CD\u5E94:",C),C.data&&C.data.error===!1&&C.data.data||C.data&&C.data.responseCode===2e4&&C.data.data?C.data.data:C.data?C.data:{}}catch(r){return console.error("\u5BFC\u51FA\u914D\u7F6E\u5931\u8D25:",r),{}}}async function gl(B){try{const d=await we.post("/api/config/export",{password:B});if(console.log("\u5BFC\u51FA\u914D\u7F6E\u54CD\u5E94:",d),d.data&&d.data.error===!1&&d.data.data)return{data:d.data.data};if(d.data&&d.data.responseCode===2e4&&d.data.data)return{data:d.data.data};if(d.data)return{data:d.data};throw new Error("\u5BFC\u51FA\u914D\u7F6E\u5931\u8D25: \u54CD\u5E94\u6570\u636E\u4E3A\u7A7A")}catch(d){throw console.error("\u5BFC\u51FA\u914D\u7F6E\u5931\u8D25:",d),d}}async function Cl(B){try{const d=await we.post("/api/config/import",B);return console.log("\u5BFC\u5165\u914D\u7F6E\u54CD\u5E94:",d),d.data&&d.data.error===!1&&d.data.data?(console.log("\u6807\u51C6\u54CD\u5E94\u683C\u5F0F, data:",d.data.data),d.data.data.skipped&&console.log("\u68C0\u6D4B\u5230skipped\u5B57\u6BB5:",d.data.data.skipped),d.data.data):d.data&&d.data.responseCode===2e4&&d.data.data?(console.log("\u62E6\u622A\u5668\u683C\u5F0F, data:",d.data.data),d.data.data.skipped&&console.log("\u68C0\u6D4B\u5230skipped\u5B57\u6BB5:",d.data.data.skipped),d.data.data):d.data?(console.log("\u76F4\u63A5\u54CD\u5E94\u683C\u5F0F:",d.data),d.data.skipped&&console.log("\u68C0\u6D4B\u5230skipped\u5B57\u6BB5:",d.data.skipped),d.data):(console.log("\u672A\u8BC6\u522B\u7684\u54CD\u5E94\u683C\u5F0F\uFF0C\u8FD4\u56DE\u7A7A\u5BF9\u8C61"),{})}catch(d){throw console.error("\u5BFC\u5165\u914D\u7F6E\u5931\u8D25:",d),d}}const hl={class:"json-editor-wrapper"},Dl={class:"json-editor-toolbar"},Bl={key:0,class:"json-validation-error"},bl=["placeholder","onKeydown"],$l={class:"json-editor-footer"},kl={class:"json-editor-status"},Al={key:0,class:"status-valid"},wl={key:1,class:"status-invalid"},Vl={name:"JsonEditor"},Sl=Te({...Vl,props:{modelValue:{type:String,required:!0},height:{type:[String,Number],default:"300px"},placeholder:{type:String,default:"\u8BF7\u8F93\u5165JSON\u5185\u5BB9"},mode:{type:String,default:"object"}},emits:["update:modelValue","apply","close"],setup(B,{expose:d,emit:r}){const C=B,j=r,{t:v}=uu.exports.useI18n(),_=E(C.modelValue),V=E(!0),O=E(""),L=E(!1),c=E(null);Ce(()=>C.modelValue,F=>{F!==_.value&&(_.value=F,y())});const K=oe(()=>({height:L.value?"100%":typeof C.height=="number"?`${C.height}px`:C.height})),Z=()=>{y(),j("update:modelValue",_.value)},te=()=>{try{const F=JSON.parse(_.value);_.value=JSON.stringify(F,null,2),y(),j("update:modelValue",_.value)}catch{}},H=()=>{try{const F=JSON.parse(_.value);_.value=JSON.stringify(F),y(),j("update:modelValue",_.value)}catch{}},J=()=>{if(c.value)try{navigator.clipboard.writeText(_.value).then(()=>{S.success(v("\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F"))}).catch(()=>{S.error(v("\u590D\u5236\u5931\u8D25"))})}catch{c.value.select(),document.execCommand("copy"),S.success(v("\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F"))}},Q=()=>{L.value=!L.value,L.value&&Eu(()=>{var F;(F=c.value)==null||F.focus()})},q=()=>{V.value&&(j("apply",_.value),L.value&&(L.value=!1))},de=()=>{L.value&&(L.value=!1),j("close")},y=()=>{try{if(!_.value.trim()){V.value=!0,O.value="";return}const F=JSON.parse(_.value);if(C.mode==="object"&&!b(F)){V.value=!1,O.value=v("\u5E94\u8BE5\u662F\u4E00\u4E2A\u5BF9\u8C61");return}if(C.mode==="array"&&!Array.isArray(F)){V.value=!1,O.value=v("\u5E94\u8BE5\u662F\u4E00\u4E2A\u6570\u7EC4");return}V.value=!0,O.value=""}catch(F){V.value=!1,O.value=F instanceof Error?F.message:v("JSON\u683C\u5F0F\u4E0D\u6B63\u786E")}},X=F=>{if(c.value){const f=c.value.selectionStart,w=c.value.selectionEnd,M=_.value.substring(0,f)+"  "+_.value.substring(w);_.value=M,Eu(()=>{c.value.selectionStart=c.value.selectionEnd=f+2}),j("update:modelValue",_.value)}},x=F=>{F.key==="Escape"&&L.value&&(L.value=!1),F.key==="s"&&(F.ctrlKey||F.metaKey)&&(F.preventDefault(),V.value&&q())};function b(F){return F!==null&&typeof F=="object"&&!Array.isArray(F)}return nu(()=>{y()}),d({close:de}),(F,f)=>{const w=Je,M=_u,T=Le;return n(),m("div",hl,[p("div",Dl,[e(T,null,{default:u(()=>[e(w,{type:"text",size:"small",disabled:!V.value,onClick:te},{icon:u(()=>[e(k(dt))]),default:u(()=>[i(" "+l(F.$t("\u683C\u5F0F\u5316")),1)]),_:1},8,["disabled"]),e(w,{type:"text",size:"small",disabled:!V.value,onClick:H},{icon:u(()=>[e(k(Ht))]),default:u(()=>[i(" "+l(F.$t("\u538B\u7F29")),1)]),_:1},8,["disabled"]),e(w,{type:"text",size:"small",onClick:J},{icon:u(()=>[e(k(Nu))]),default:u(()=>[i(" "+l(F.$t("\u590D\u5236")),1)]),_:1}),e(M,{content:F.$t("\u5168\u5C4F\u7F16\u8F91")},{default:u(()=>[e(w,{type:"text",size:"small",onClick:Q},{icon:u(()=>[L.value?(n(),z(k(Jt),{key:0})):(n(),z(k(Wt),{key:1}))]),_:1})]),_:1},8,["content"])]),_:1}),V.value?re("",!0):(n(),m("div",Bl,[e(k(nt),{style:{color:"#f53f3f"}}),i(" "+l(F.$t("JSON\u683C\u5F0F\u4E0D\u6B63\u786E")),1)]))]),p("div",{class:Ue(["json-editor-container",{fullscreen:L.value}])},[Gt(p("textarea",{ref_key:"editorRef",ref:c,"onUpdate:modelValue":f[0]||(f[0]=ue=>_.value=ue),class:"json-editor-textarea",placeholder:B.placeholder,style:ct(K.value),onInput:Z,onKeydown:[Ge(Xt(X,["prevent"]),["tab"]),x]},null,44,bl),[[Zt,_.value]])],2),p("div",$l,[p("div",kl,[V.value?(n(),m("span",Al,[e(k(Yt),{style:{color:"#00b42a"}}),i(" "+l(F.$t("JSON\u683C\u5F0F\u6B63\u786E")),1)])):(n(),m("span",wl,[e(k(nt),{style:{color:"#f53f3f"}}),i(" "+l(O.value),1)]))]),e(w,{size:"mini",type:"primary",status:"success",disabled:!V.value,onClick:q},{default:u(()=>[i(l(F.$t("\u5E94\u7528")),1)]),_:1},8,["disabled"])])])}}});const Bt=Ne(Sl,[["__scopeId","data-v-e1a91f67"]]),jl={class:"json-editor-modal-footer"},Ol={name:"JsonEditorModal"},Ul=Te({...Ol,props:{visible:{type:Boolean,default:!1},title:{type:String,default:""},value:{type:String,default:""},width:{type:[String,Number],default:700},placeholder:{type:String,default:""},fieldKey:{type:String,default:""},mode:{type:String,default:"object"}},emits:["update:visible","update:value","apply","close"],setup(B,{emit:d}){const r=B,C=d,{t:j}=uu.exports.useI18n(),v=E(r.value),_=E(),V=E(450),O=oe(()=>{if(!v.value.trim())return!0;try{const Z=JSON.parse(v.value);return!(r.mode==="object"&&!L(Z)||r.mode==="array"&&!Array.isArray(Z))}catch{return!1}});function L(Z){return Z!==null&&typeof Z=="object"&&!Array.isArray(Z)}Ce(()=>r.value,Z=>{Z!==v.value&&(v.value=Z)}),Ce(()=>r.visible,Z=>{Z&&(v.value=r.value)}),Ce(v,Z=>{C("update:value",Z)});const c=()=>{O.value&&(C("apply",{key:r.fieldKey,value:v.value}),C("update:value",v.value),C("update:visible",!1))},K=()=>{C("update:visible",!1),C("close")};return(Z,te)=>{const H=Je,J=Le,Q=ze;return n(),z(Q,{visible:B.visible,title:B.title||k(j)("JSON\u7F16\u8F91\u5668"),width:B.width,"mask-closable":!1,"esc-to-close":!1,footer:!1,"unmount-on-close":!1,onClose:K},{default:u(()=>[e(Bt,{ref_key:"editorRef",ref:_,modelValue:v.value,"onUpdate:modelValue":te[0]||(te[0]=q=>v.value=q),height:V.value,placeholder:B.placeholder,mode:B.mode,onApply:c,onClose:K},null,8,["modelValue","height","placeholder","mode"]),p("div",jl,[e(J,null,{default:u(()=>[e(H,{onClick:K},{default:u(()=>[i(l(k(j)("\u53D6\u6D88")),1)]),_:1}),e(H,{type:"primary",disabled:!O.value,onClick:c},{default:u(()=>[i(l(k(j)("\u786E\u5B9A")),1)]),_:1},8,["disabled"])]),_:1})])]),_:1},8,["visible","title","width"])}}});const Il=Ne(Ul,[["__scopeId","data-v-89215554"]]),Nl={class:"node-header"},Tl={key:1,class:"expand-placeholder"},Jl={key:2,class:"node-name"},Kl={class:"node-value"},Pl={class:"item-count"},Rl={key:1,class:"value-editor"},zl={class:"placeholder-value"},Ll={class:"node-actions"},xl={key:0,class:"node-children"},Ml={key:0},ql={class:"add-child"},Hl={key:1},Wl={class:"add-child"},Gl={name:"JsonTreeNode"},Zl=Te({...Gl,props:{name:{type:String,default:void 0},value:{type:[String,Number,Boolean,Object,Array],required:!0},path:{type:String,required:!0},expandedPaths:{type:Object,required:!0}},emits:["update:name","update:value","remove","add-child","toggle-expand"],setup(B,{emit:d}){const r=B,C=d,{t:j}=uu.exports.useI18n(),v=oe(()=>r.expandedPaths.has(r.path)),_=oe(()=>r.value!==null&&typeof r.value=="object"),V=oe(()=>Array.isArray(r.value)),O=oe(()=>_.value),L=oe(()=>r.value===null?"null":typeof r.value=="string"?`"${r.value}"`:typeof r.value>"u"?"undefined":String(r.value)),c=oe(()=>r.value===null?"null-value":typeof r.value=="string"?"string-value":typeof r.value=="number"?"number-value":typeof r.value=="boolean"?"boolean-value":""),K=oe(()=>_.value?Object.keys(r.value).length:0),Z=oe(()=>!_.value||V.value?[]:Object.keys(r.value)),te=oe(()=>r.value),H=E(!1),J=E(!1),Q=E(""),q=E("string"),de=E(""),y=E(void 0),X=E(!1),x=E(null),b=E(null);function F(){Q.value=r.name,H.value=!0,Eu(()=>{var R;(R=x.value)==null||R.focus()})}function f(){H.value&&(Q.value.trim()&&C("update:name",Q.value.trim()),H.value=!1)}function w(){H.value=!1}function M(){_.value||(r.value===null?q.value="null":Array.isArray(r.value)?q.value="array":q.value=typeof r.value,q.value==="string"?de.value=r.value:q.value==="number"?y.value=r.value:q.value==="boolean"&&(X.value=r.value),J.value=!0,Eu(()=>{var R;(R=b.value)==null||R.focus()}))}function T(){if(J.value){let R;q.value==="string"?R=de.value:q.value==="number"?R=y.value:q.value==="boolean"?R=X.value:q.value==="null"?R=null:q.value==="object"?R={}:q.value==="array"&&(R=[]),C("update:value",R),J.value=!1}}function ue(){J.value=!1}function ie(){O.value&&C("toggle-expand",r.path)}function le(R){C("toggle-expand",R)}function ve(){C("remove")}function ce(){if(!_.value){let R;const U="object";R={},C("add-child",{type:U,value:R})}}function P(){if(!_.value||V.value)return;const R=Ie(r.value),U={...r.value,[R]:""};C("update:value",U)}function pe(R,U){if(!_.value||V.value||R===U)return;const ne=r.value;if(Object.prototype.hasOwnProperty.call(ne,U))return;const ae={};for(const o in ne)o===R?ae[U]=ne[o]:ae[o]=ne[o];C("update:value",ae)}function Ve(R,U){if(!_.value||V.value)return;const ne={...r.value,[R]:U};C("update:value",ne)}function Se(R){if(!_.value||V.value)return;const U={...r.value};delete U[R],C("update:value",U)}function be(R,{type:U,value:ne}){if(!_.value||V.value)return;const ae={...r.value};ae[R]=ne,C("update:value",ae)}function _e(){if(!_.value||!V.value)return;const R=[...r.value];R.push(""),C("update:value",R)}function he(R,U){if(!_.value||!V.value)return;const ne=[...r.value];ne[R]=U,C("update:value",ne)}function G(R){if(!_.value||!V.value)return;const U=[...r.value];U.splice(R,1),C("update:value",U)}function me(R,{type:U,value:ne}){if(!_.value||!V.value)return;const ae=[...r.value];ae[R]=ne,C("update:value",ae)}function Ie(R){let U="key",ne=1,ae=`${U}${ne}`;for(;Object.prototype.hasOwnProperty.call(R,ae);)ne++,ae=`${U}${ne}`;return ae}return(R,U)=>{const ne=Ku,ae=gu,o=Cu,D=ft,$=Je,I=vt("json-tree-node",!0);return n(),m("div",{class:Ue(["json-tree-node",{"json-tree-node-expanded":v.value}])},[p("div",Nl,[O.value?(n(),m("div",{key:0,class:"expand-btn",onClick:ie},[v.value?(n(),z(k(el),{key:1})):(n(),z(k(Qt),{key:0}))])):(n(),m("div",Tl)),B.name!==void 0?(n(),m("div",Jl,[H.value?(n(),z(ne,{key:0,ref_key:"nameInputRef",ref:x,modelValue:Q.value,"onUpdate:modelValue":U[0]||(U[0]=N=>Q.value=N),size:"mini",style:{width:"120px"},onBlur:f,onKeyup:[Ge(f,["enter"]),Ge(w,["esc"])]},null,8,["modelValue"])):(n(),m("span",{key:1,class:"name-text",onDblclick:F},l(B.name),33)),U[5]||(U[5]=p("span",{class:"name-colon"},":",-1))])):re("",!0),p("div",Kl,[_.value?(n(),m("span",{key:0,class:"value-text object-value",onClick:ie},[i(l(V.value?"[...]":"{...}")+" ",1),p("span",Pl,l(K.value)+" "+l(k(j)("\u9879")),1)])):(n(),m(se,{key:1},[J.value?(n(),z(o,{key:0,modelValue:q.value,"onUpdate:modelValue":U[1]||(U[1]=N=>q.value=N),style:{width:"90px","margin-right":"8px"},size:"mini"},{default:u(()=>[e(ae,{value:"string"},{default:u(()=>[i(l(k(j)("\u5B57\u7B26\u4E32")),1)]),_:1}),e(ae,{value:"number"},{default:u(()=>[i(l(k(j)("\u6570\u5B57")),1)]),_:1}),e(ae,{value:"boolean"},{default:u(()=>[i(l(k(j)("\u5E03\u5C14\u503C")),1)]),_:1}),e(ae,{value:"null"},{default:u(()=>U[6]||(U[6]=[i("null")])),_:1}),e(ae,{value:"object"},{default:u(()=>[i(l(k(j)("\u5BF9\u8C61")),1)]),_:1}),e(ae,{value:"array"},{default:u(()=>[i(l(k(j)("\u6570\u7EC4")),1)]),_:1})]),_:1},8,["modelValue"])):re("",!0),J.value?(n(),m("div",Rl,[q.value==="string"?(n(),z(ne,{key:0,ref_key:"valueInputRef",ref:b,modelValue:de.value,"onUpdate:modelValue":U[2]||(U[2]=N=>de.value=N),size:"mini",style:{width:"200px"},onBlur:T,onKeyup:[Ge(T,["enter"]),Ge(ue,["esc"])]},null,8,["modelValue"])):q.value==="number"?(n(),z(D,{key:1,ref_key:"valueInputRef",ref:b,modelValue:y.value,"onUpdate:modelValue":U[3]||(U[3]=N=>y.value=N),size:"mini",style:{width:"140px"},onBlur:T,onKeyup:[Ge(T,["enter"]),Ge(ue,["esc"])]},null,8,["modelValue"])):q.value==="boolean"?(n(),z(o,{key:2,modelValue:X.value,"onUpdate:modelValue":U[4]||(U[4]=N=>X.value=N),size:"mini",style:{width:"80px"},onBlur:T,onChange:T},{default:u(()=>[e(ae,{value:!0},{default:u(()=>U[7]||(U[7]=[i("true")])),_:1}),e(ae,{value:!1},{default:u(()=>U[8]||(U[8]=[i("false")])),_:1})]),_:1},8,["modelValue"])):q.value==="null"?(n(),m(se,{key:3},[U[9]||(U[9]=p("span",{class:"null-value"},"null",-1)),e($,{size:"mini",type:"text",onClick:T},{default:u(()=>[i(l(k(j)("\u786E\u5B9A")),1)]),_:1})],64)):q.value==="object"||q.value==="array"?(n(),m(se,{key:4},[p("span",zl,l(q.value==="object"?"{}":"[]"),1),e($,{size:"mini",type:"text",onClick:T},{default:u(()=>[i(l(k(j)("\u786E\u5B9A")),1)]),_:1})],64)):re("",!0)])):(n(),m("span",{key:2,class:Ue(["value-text",c.value]),onDblclick:M},l(L.value),35))],64))]),p("div",Ll,[_.value?(n(),z($,{key:0,type:"text",size:"mini",onClick:ce},{icon:u(()=>[e(k(Re))]),_:1})):re("",!0),e($,{type:"text",status:"danger",size:"mini",onClick:ve},{icon:u(()=>[e(k(Ju))]),_:1})])]),_.value&&v.value?(n(),m("div",xl,[V.value?(n(),m("div",Ml,[(n(!0),m(se,null,ye(te.value,(N,W)=>(n(),m("div",{key:W,class:"child-node"},[e(I,{value:N,path:`${B.path}.${W}`,"expanded-paths":B.expandedPaths,"onUpdate:value":Ee=>he(Number(W),Ee),onRemove:Ee=>G(Number(W)),onAddChild:Ee=>me(Number(W),Ee),onToggleExpand:le},null,8,["value","path","expanded-paths","onUpdate:value","onRemove","onAddChild"])]))),128)),p("div",ql,[e($,{type:"dashed",size:"small",onClick:_e},{icon:u(()=>[e(k(Re))]),default:u(()=>[i(" "+l(k(j)("\u6DFB\u52A0\u6570\u7EC4\u9879")),1)]),_:1})])])):(n(),m("div",Hl,[(n(!0),m(se,null,ye(Z.value,N=>(n(),m("div",{key:N,class:"child-node"},[e(I,{name:N,value:te.value[N],path:`${B.path}.${N}`,"expanded-paths":B.expandedPaths,"onUpdate:name":W=>pe(N,W),"onUpdate:value":W=>Ve(N,W),onRemove:W=>Se(N),onAddChild:W=>be(N,W),onToggleExpand:le},null,8,["name","value","path","expanded-paths","onUpdate:name","onUpdate:value","onRemove","onAddChild"])]))),128)),p("div",Wl,[e($,{type:"dashed",size:"small",onClick:P},{icon:u(()=>[e(k(Re))]),default:u(()=>[i(" "+l(k(j)("\u6DFB\u52A0\u952E\u503C\u5BF9")),1)]),_:1})])]))])):re("",!0)],2)}}});const rt=Ne(Zl,[["__scopeId","data-v-3e9eb90e"]]),Xl={class:"json-tree-editor"},Yl={class:"json-tree-toolbar"},Ql={key:0,class:"tree-header"},ea={key:1,class:"tree-header"},ua={class:"tree-add"},ta={class:"tree-add"},la={name:"JsonTreeEditor"},aa=Te({...la,props:{modelValue:{type:String,required:!0},height:{type:[String,Number],default:400},mode:{type:String,default:"object"}},emits:["update:modelValue","apply"],setup(B,{emit:d}){const r=B,C=d,{t:j}=uu.exports.useI18n(),v=E(r.mode==="object"?{}:[]),_=E(new Set),V=oe(()=>Array.isArray(v.value));try{const b=JSON.parse(r.modelValue);r.mode==="object"&&typeof b=="object"&&!Array.isArray(b)||r.mode==="array"&&Array.isArray(b)?v.value=b:v.value=r.mode==="object"?{}:[]}catch(b){console.error("Invalid JSON:",b),v.value=r.mode==="object"?{}:[]}Ce(()=>r.modelValue,b=>{try{const F=JSON.parse(b);(r.mode==="object"&&typeof F=="object"&&!Array.isArray(F)||r.mode==="array"&&Array.isArray(F))&&(v.value=F)}catch(F){console.error("Invalid JSON:",F)}}),Ce(v,()=>{try{const b=JSON.stringify(v.value);C("update:modelValue",b)}catch(b){console.error("Error stringifying JSON:",b)}},{deep:!0});function O(){const b=x(v.value);v.value[b]=""}function L(b,F){if(b===F)return;if(Object.prototype.hasOwnProperty.call(v.value,F)){S.warning(j("\u952E\u540D\u5DF2\u5B58\u5728"));return}const f=v.value[b];delete v.value[b],v.value[F]=f}function c(b,F){v.value[b]=F}function K(b){delete v.value[b]}function Z(b,{type:F,value:f}){if(typeof v.value[b]=="object"&&v.value[b]!==null)if(Array.isArray(v.value[b]))v.value[b].push(f);else{const w=x(v.value[b]);v.value[b][w]=f}else v.value[b]=F==="array"?[f]:{[x({})]:f}}function te(){v.value.push("")}function H(b,F){v.value[b]=F}function J(b){v.value.splice(b,1)}function Q(b,{type:F,value:f}){if(typeof v.value[b]=="object"&&v.value[b]!==null)if(Array.isArray(v.value[b]))v.value[b].push(f);else{const w=x(v.value[b]);v.value[b][w]=f}else v.value[b]=F==="array"?[f]:{[x({})]:f}}function q(){V.value?te():O()}function de(b){_.value.has(b)?_.value.delete(b):_.value.add(b)}function y(){function b(F,f=""){F===null||typeof F!="object"||Object.keys(F).forEach(w=>{const M=f?`${f}.${w}`:w;_.value.add(M),F[w]!==null&&typeof F[w]=="object"&&b(F[w],M)})}_.value.clear(),b(v.value)}function X(){_.value.clear()}function x(b){let F="key",f=1,w=`${F}${f}`;for(;Object.prototype.hasOwnProperty.call(b,w);)f++,w=`${F}${f}`;return w}return(b,F)=>{const f=Je,w=Le;return n(),m("div",Xl,[p("div",Yl,[e(w,null,{default:u(()=>[e(f,{type:"text",size:"small",onClick:q},{icon:u(()=>[e(k(Re))]),default:u(()=>[i(" "+l(k(j)("\u6DFB\u52A0\u6839\u8282\u70B9")),1)]),_:1}),e(f,{type:"text",size:"small",onClick:F[0]||(F[0]=M=>C("apply",JSON.stringify(v.value)))},{icon:u(()=>[e(k(ul))]),default:u(()=>[i(" "+l(k(j)("\u5E94\u7528")),1)]),_:1}),e(f,{type:"text",size:"small",onClick:y},{icon:u(()=>[e(k(Kt))]),default:u(()=>[i(" "+l(k(j)("\u5168\u90E8\u5C55\u5F00")),1)]),_:1}),e(f,{type:"text",size:"small",onClick:X},{icon:u(()=>[e(k(Pt))]),default:u(()=>[i(" "+l(k(j)("\u5168\u90E8\u6298\u53E0")),1)]),_:1})]),_:1})]),p("div",{class:"tree-container",style:ct({height:`${B.height}px`})},[V.value?(n(),m("div",Ql,l(k(j)("\u6570\u7EC4"))+" ["+l(v.value.length)+" "+l(k(j)("\u9879"))+"]",1)):(n(),m("div",ea,l(k(j)("\u5BF9\u8C61"))+" ["+l(Object.keys(v.value).length)+" "+l(k(j)("\u9879"))+"]",1)),V.value?(n(),m(se,{key:2},[(n(!0),m(se,null,ye(v.value,(M,T)=>(n(),m("div",{key:T,class:"tree-item"},[e(rt,{value:M,path:String(T),"expanded-paths":_.value,"onUpdate:value":ue=>H(T,ue),onRemove:ue=>J(T),onAddChild:ue=>Q(T,ue),onToggleExpand:de},null,8,["value","path","expanded-paths","onUpdate:value","onRemove","onAddChild"])]))),128)),p("div",ua,[e(f,{type:"dashed",size:"small",long:"",onClick:te},{icon:u(()=>[e(k(Re))]),default:u(()=>[i(" "+l(k(j)("\u6DFB\u52A0\u6570\u7EC4\u9879")),1)]),_:1})])],64)):(n(),m(se,{key:3},[(n(!0),m(se,null,ye(Object.keys(v.value),M=>(n(),m("div",{key:M,class:"tree-item"},[e(rt,{name:M,value:v.value[M],path:M,"expanded-paths":_.value,"onUpdate:name":T=>L(M,T),"onUpdate:value":T=>c(M,T),onRemove:T=>K(M),onAddChild:T=>Z(M,T),onToggleExpand:de},null,8,["name","value","path","expanded-paths","onUpdate:name","onUpdate:value","onRemove","onAddChild"])]))),128)),p("div",ta,[e(f,{type:"dashed",size:"small",long:"",onClick:O},{icon:u(()=>[e(k(Re))]),default:u(()=>[i(" "+l(k(j)("\u6DFB\u52A0\u952E\u503C\u5BF9")),1)]),_:1})])],64))],4)])}}});const oa=Ne(aa,[["__scopeId","data-v-16751b46"]]),na={class:"editor-container"},sa={class:"editor-toolbar"},ia={class:"editor-content"},ra={key:0,class:"tree-editor-wrapper"},da={key:1,class:"code-editor-wrapper"},ca={class:"modal-footer"},va={name:"JsonTreeEditorModal"},fa=Te({...va,props:{visible:{type:Boolean,default:!1},title:{type:String,default:""},value:{type:String,default:""},width:{type:[String,Number],default:800},placeholder:{type:String,default:""},fieldKey:{type:String,default:""},mode:{type:String,default:"object"}},emits:["update:visible","update:value","apply","close"],setup(B,{emit:d}){const r=B,C=d,{t:j}=uu.exports.useI18n(),v=E(r.value),_=E(),V=E(),O=E(500),L=E("tree"),c=oe(()=>{if(!v.value.trim())return!0;try{const H=JSON.parse(v.value);return!(r.mode==="object"&&!K(H)||r.mode==="array"&&!Array.isArray(H))}catch{return!1}});function K(H){return H!==null&&typeof H=="object"&&!Array.isArray(H)}Ce(()=>r.value,H=>{H!==v.value&&(v.value=H)}),Ce(()=>r.visible,H=>{H&&(v.value=r.value)});const Z=()=>{c.value&&(C("apply",{key:r.fieldKey,value:v.value}),C("update:value",v.value),C("update:visible",!1))},te=()=>{C("update:visible",!1),C("close")};return(H,J)=>{const Q=Pu,q=Ru,de=Je,y=Le,X=ze;return n(),z(X,{visible:B.visible,title:B.title||k(j)("JSON\u7F16\u8F91\u5668 (\u6811\u5F62\u89C6\u56FE)"),width:B.width,"mask-closable":!1,"esc-to-close":!1,footer:!1,"unmount-on-close":!1,onClose:te,class:"json-tree-editor-modal"},{default:u(()=>[p("div",na,[p("div",sa,[e(q,{modelValue:L.value,"onUpdate:modelValue":J[0]||(J[0]=x=>L.value=x),type:"button"},{default:u(()=>[e(Q,{value:"tree"},{default:u(()=>[i(l(k(j)("\u6811\u5F62\u7F16\u8F91\u5668")),1)]),_:1}),e(Q,{value:"code"},{default:u(()=>[i(l(k(j)("\u4EE3\u7801\u7F16\u8F91\u5668")),1)]),_:1})]),_:1},8,["modelValue"])]),p("div",ia,[L.value==="tree"?(n(),m("div",ra,[e(oa,{ref_key:"treeEditorRef",ref:_,modelValue:v.value,"onUpdate:modelValue":J[1]||(J[1]=x=>v.value=x),height:O.value,mode:B.mode,onApply:Z},null,8,["modelValue","height","mode"])])):(n(),m("div",da,[e(Bt,{ref_key:"codeEditorRef",ref:V,modelValue:v.value,"onUpdate:modelValue":J[2]||(J[2]=x=>v.value=x),height:O.value,placeholder:B.placeholder,mode:B.mode,onApply:Z},null,8,["modelValue","height","placeholder","mode"])]))])]),p("div",ca,[e(y,null,{default:u(()=>[e(de,{onClick:te},{default:u(()=>[i(l(k(j)("\u53D6\u6D88")),1)]),_:1}),e(de,{type:"primary",disabled:!c.value,onClick:Z},{default:u(()=>[i(l(k(j)("\u786E\u5B9A")),1)]),_:1},8,["disabled"])]),_:1})])]),_:1},8,["visible","title","width"])}}});const pa=Ne(fa,[["__scopeId","data-v-84bb24f0"]]),Fa={class:"config-editor"},ya={key:1},ma={class:"editor-toolbar"},Ea={key:0,class:"empty-config"},_a={key:1,class:"config-fields"},ga={class:"config-key"},Ca={class:"key-text"},ha={class:"config-value-cell"},Da={key:4,class:"bool-field"},Ba={key:5,class:"ref-field"},ba={class:"current-ref-path"},$a={style:{"font-weight":"bold"}},ka={key:0,class:"error-text"},Aa={key:6,class:"object-field"},wa={class:"json-editor-container"},Va={class:"json-actions"},Sa={key:7,class:"array-field"},ja={class:"json-editor-container"},Oa={class:"json-actions"},Ua={key:4,class:"ref-path-input"},Ia={class:"ref-input-row"},Na={style:{"margin-top":"10px"}},Ta={class:"current-ref-path",style:{"margin-top":"8px"}},Ja={style:{"font-weight":"bold"}},Ka={key:0,class:"error-text"},Pa={class:"field-description",style:{"margin-top":"8px"}},Ra={key:0,class:"action-buttons"},za={key:0,class:"action-buttons"},La={class:"batch-select-container"},xa={class:"batch-select-header"},Ma={key:0,class:"batch-filter"},qa={key:0,class:"config-selector"},Ha={class:"tree-hint"},Wa={key:1,class:"path-list"},Ga={class:"path-list-header"},Za={class:"field-prefix-input"},Xa={class:"field-description"},Ya={class:"batch-select-preview"},Qa={class:"preview-header"},eo={class:"preview-count"},uo={key:0,class:"preview-content"},to={class:"preview-list-header"},lo={class:"preview-field-name"},ao={class:"preview-field-value"},oo={class:"preview-list-body"},no={class:"preview-field-name"},so={class:"preview-field-value"},io={class:"preview-field-name"},ro={class:"preview-field-value"},co={key:1,class:"empty-preview"},vo={class:"batch-select-container"},fo={class:"batch-select-header"},po={key:0,class:"batch-filter"},Fo={key:0,class:"config-selector"},yo={class:"tree-hint"},mo={key:1,class:"path-list"},Eo={class:"field-ref-preview"},_o={class:"preview-header"},go={class:"preview-content"},Co={key:0,class:"preview-item"},ho={key:1,class:"preview-item"},Do={key:2,class:"empty-preview"},Bo={class:"json-preview-container"},bo={key:2,class:"json-content"},$o={class:"json-preview-actions"},ko={name:"ConfigEditor"},Ao=Te({...ko,props:{configItem:{type:Object,default:null},env:{type:String,default:"dev"}},emits:["update"],setup(B,{emit:d}){const r=B,C=d,{t:j}=uu.exports.useI18n(),v=eu({}),_=new Map,V=oe(()=>(r.configItem&&(console.log("\u914D\u7F6E\u7F16\u8F91\u5668\u6536\u5230\u914D\u7F6E\u9879:",r.configItem),console.log("\u914D\u7F6E\u9879\u503C:",r.configItem.value),Object.keys(v).forEach(t=>{delete v[t]}),_.clear(),r.configItem.value&&Object.keys(r.configItem.value).forEach(t=>{if(r.configItem&&r.configItem.value&&r.configItem.value[t]){const a={...r.configItem.value[t]};if(a.type==="int"&&a.value?a.value=parseInt(a.value):a.type==="float"&&a.value?a.value=parseFloat(a.value):a.type==="bool"&&a.value!==void 0&&(a.value=a.value==="true"),a.type==="ref"&&typeof a.value=="string"){const h=a.value.split(".");_.set(t,{configKey:h[0]||"",propertyPath:h.slice(1).join(".")||""})}v[t]=a}}),console.log("\u521D\u59CB\u5316\u540E\u7684\u914D\u7F6E\u503C:",v)),r.configItem));Ce(()=>r.configItem,t=>{t&&(console.log("\u914D\u7F6E\u9879\u53D8\u5316\uFF0C\u91CD\u65B0\u521D\u59CB\u5316\u503C"),V.value)},{immediate:!0});const O=E(!1),L=E(),c=eu({key:"",type:"string",value:""}),K=E(void 0),Z=E(void 0),te=E([]),H=E({}),J=E(""),Q=E(""),q=oe(()=>H.value[J.value]||[]),de=()=>{J.value&&Q.value?c.value=`${J.value}.${Q.value}`:J.value?c.value=J.value:c.value=""},y=async()=>{try{const t=await ht();te.value=t.map(a=>a.key);for(const a of t)if(a.value){const h=[];X(a.value,"",h),H.value[a.key]=h}return console.log("\u52A0\u8F7D\u914D\u7F6E\u952E\u6210\u529F:",te.value),Promise.resolve()}catch(t){return console.error("\u52A0\u8F7D\u914D\u7F6E\u952E\u5931\u8D25:",t),te.value=[],Promise.reject(t)}};function X(t,a,h){if(!(!t||typeof t!="object"))for(const g in t){const Y=a?`${a}.${g}`:g;h.push(Y),t[g]&&typeof t[g]=="object"&&t[g].value&&typeof t[g].value=="object"&&X(t[g].value,Y,h)}}y().catch(t=>{console.error("\u521D\u59CB\u5316\u52A0\u8F7D\u914D\u7F6E\u952E\u5931\u8D25:",t),S.error("\u52A0\u8F7D\u914D\u7F6E\u9879\u5931\u8D25\uFF0C\u8BF7\u5237\u65B0\u9875\u9762\u91CD\u8BD5")}),Ce(()=>c.type,t=>{if(t==="bool")c.value="false";else if(t==="int"||t==="float")c.value="0",K.value=0,Z.value=0;else if(t==="object")c.value="{}";else if(t==="array")c.value="[]";else if(t==="ref"){const a=c.value.split(".");a.length>0?(J.value=a[0],Q.value=a.slice(1).join(".")):(J.value="",Q.value="")}else c.value=""}),Ce([J,Q],()=>{de()}),Ce(K,t=>{t!==void 0&&c.type==="int"&&(c.value=String(t))}),Ce(Z,t=>{t!==void 0&&c.type==="float"&&(c.value=String(t))});function x(){O.value=!0}function b(t){if(!t)return!0;try{return JSON.parse(t),!0}catch{return!1}}function F(t){try{return JSON.stringify(JSON.parse(t),null,2)}catch{return t}}function f(){b(c.value)&&(c.value=F(c.value))}async function w(){if(!L.value)return!1;try{if(await L.value.validate(),v[c.key])return S.error("\u5B57\u6BB5\u540D\u5DF2\u5B58\u5728"),!1;if((c.type==="object"||c.type==="array")&&c.value&&!b(c.value))return S.error("JSON\u683C\u5F0F\u4E0D\u6B63\u786E"),!1;(c.type==="object"||c.type==="array")&&c.value&&b(c.value)&&(c.value=F(c.value));let t=c.value;return c.type==="int"?t=K.value!==void 0?K.value:0:c.type==="float"?t=Z.value!==void 0?Z.value:0:c.type==="bool"&&(t=c.value==="true"),v[c.key]={type:c.type,value:t},M(),!0}catch(t){return console.error(t),!1}}function M(){var t;c.key="",c.type="string",c.value="",K.value=void 0,Z.value=void 0,J.value="",Q.value="",(t=L.value)==null||t.clearValidate()}function T(t){confirm(`\u786E\u5B9A\u8981\u5220\u9664\u914D\u7F6E\u9879 "${t}" \u5417\uFF1F`)&&delete v[t]}async function ue(){if(!r.configItem){S.error("\u914D\u7F6E\u9879\u4E0D\u5B58\u5728");return}try{const t={...r.configItem.metadata};r.env&&(t.environment=r.env);const a={};for(const h in v){const g={...v[h]};(g.type==="int"||g.type==="float"||g.type==="bool")&&(g.value=String(g.value)),a[h]=g}await Dt(r.configItem.key,{value:a,metadata:t}),S.success("\u914D\u7F6E\u4FDD\u5B58\u6210\u529F"),C("update")}catch(t){S.error("\u4FDD\u5B58\u914D\u7F6E\u5931\u8D25"),console.error(t)}}function ie(t){if(t.type==="object"||t.type==="array")try{t.value=F(t.value)}catch(a){S.error("\u683C\u5F0F\u5316\u5931\u8D25"),console.error(a)}}function le(t){if(t.type==="object"||t.type==="array")try{return JSON.parse(t.value),!0}catch{return!1}return!0}function ve(t){return t?/^[a-zA-Z0-9_.-]+(\.[a-zA-Z0-9_.-]+)+$/.test(t):!0}function ce(t,a){var ge;if(_.has(t))return((ge=_.get(t))==null?void 0:ge.configKey)||"";const h=String(a.value||""),g=[...te.value].sort((fe,Oe)=>Oe.length-fe.length);for(const fe of g)if(h.startsWith(fe+"."))return fe;const Y=h.split(".");return Y.length>0?Y[0]:""}function P(t,a){var ge;if(_.has(t))return((ge=_.get(t))==null?void 0:ge.propertyPath)||"";const h=String(a.value||""),g=[...te.value].sort((fe,Oe)=>Oe.length-fe.length);for(const fe of g)if(h.startsWith(fe+"."))return h.substring(fe.length+1);const Y=h.split(".");return Y.length>1?Y.slice(1).join("."):""}function pe(t,a,h){const g=P(t,a);_.set(t,{configKey:h,propertyPath:g}),g?a.value=`${h}.${g}`:a.value=h}function Ve(t,a,h){const g=ce(t,a);_.set(t,{configKey:g,propertyPath:h}),g&&h?a.value=`${g}.${h}`:g?a.value=g:a.value=""}function Se(t){const a=ce(t,v[t]);return a?H.value[a]||[]:[]}const be=E(!1),_e=E(""),he=E("all"),G=E([]),me=E([]),Ie=E(""),R=E(""),U=E(["all"]),ne=E(!1),ae=E(null),o=E(""),D=E("all"),$=E([]),I=E(""),N=E(""),W=E(!1),Ee=oe(()=>{if(!Array.isArray(te.value)||te.value.length===0)return[{key:"all",title:"\u6240\u6709\u914D\u7F6E",selectable:!0,children:[]}];const t=new Map;return te.value.forEach(h=>{var ge;let Y=h.split(".")[0];t.has(Y)||t.set(Y,[]),(ge=t.get(Y))==null||ge.push(h)}),[{key:"all",title:"\u6240\u6709\u914D\u7F6E",selectable:!0,children:Array.from(t.entries()).map(([h,g])=>({key:h,title:h,selectable:!0,children:g.map(Y=>{const ge=Array.isArray(H.value[Y])?H.value[Y]:[],fe=Y.substring(h.length+1)||Y;return{key:Y,title:fe,selectable:!0,children:ge.map(Oe=>({key:`${Y}.${Oe}`,title:Oe,isLeaf:!0,selectable:!0}))}})}))}]}),Ke=oe(()=>Ie.value?(H.value[_e.value]||[]).filter(t=>t.toLowerCase().includes(Ie.value.toLowerCase())):H.value[_e.value]||[]),Be=oe(()=>N.value?(H.value[o.value]||[]).filter(t=>t.toLowerCase().includes(N.value.toLowerCase())):H.value[o.value]||[]);function je(t){return t.includes(".")}function Ae(t){return t.isLeaf===!0}function xe(t,a){const h=a.node.key;a.selected&&a.node.isLeaf?G.value.includes(h)?G.value=G.value.filter(g=>g!==h):G.value=[...G.value,h]:a.node.isLeaf||(U.value.includes(h)?U.value=U.value.filter(g=>g!==h):U.value=[...U.value,h])}function $e(t){const a=t.split(".");if(a.length<2)return t;const h=a[a.length-1];let g="";return R.value&&(g=`${R.value}_`),g+=h,g}function Pe(t,a){const h=a.split("."),g=h[h.length-1];let Y="";return R.value&&(Y=`${R.value}_`),Y+=g,Y}function Me(){try{return he.value==="all"?Array.isArray(G.value)?G.value.filter(t=>je(t)).length:0:Array.isArray(me.value)?me.value.length:0}catch(t){return console.error("\u8BA1\u7B97\u9009\u4E2D\u9879\u6570\u91CF\u51FA\u9519:",t),0}}function Bu(){me.value=Ke.value}function Ze(){me.value=[]}function bu(){G.value=[],me.value=[],_e.value="",he.value="all",Ie.value="",R.value="",y().then(()=>{be.value=!0})}function qe(t,a){ae.value={key:t,field:a},W.value=!1;const h=ce(t,a);if(h){o.value=h,D.value=h;const g=P(t,a);g?I.value=g:I.value=""}else D.value="all",I.value="";$.value=[],N.value="",ne.value=!0}function De(){ae.value=null,W.value=!0,J.value?(o.value=J.value,D.value=J.value,Q.value?I.value=Q.value:I.value=""):(D.value="all",I.value=""),$.value=[],N.value="",ne.value=!0}function ke(t,a){a.selected&&a.node.isLeaf?$.value=[a.node.key]:!a.selected&&a.node.isLeaf&&($.value=[])}function su(t){Array.isArray(t)?G.value=t:t&&Array.isArray(t.checked)?G.value=t.checked:G.value=[],console.log("\u6811\u9009\u62E9\u7ED3\u679C:",G.value)}function tu(){let t=[];try{if(he.value==="all"?Array.isArray(G.value)&&(t=G.value.filter(h=>je(h)).map(h=>({key:$e(h),value:h}))):_e.value&&Array.isArray(me.value)&&me.value.length>0&&(t=me.value.map(h=>({key:Pe(_e.value,h),value:`${_e.value}.${h}`}))),t.length===0)return S.warning("\u8BF7\u81F3\u5C11\u9009\u62E9\u4E00\u4E2A\u5C5E\u6027\u8DEF\u5F84"),!1;console.log("\u5373\u5C06\u6DFB\u52A0\u5B57\u6BB5:",t);const a=t.filter(h=>v[h.key]);if(a.length>0){const h=a.map(g=>g.key).join(", ");return S.warning(`\u4EE5\u4E0B\u5B57\u6BB5\u540D\u5DF2\u5B58\u5728: ${h}`),!1}return t.forEach(h=>{v[h.key]={type:"ref",value:h.value};const g=ce(h.key,v[h.key]),Y=P(h.key,v[h.key]);g&&_.set(h.key,{configKey:g,propertyPath:Y})}),S.success(`\u5DF2\u6279\u91CF\u6DFB\u52A0 ${t.length} \u4E2A\u5F15\u7528\u914D\u7F6E\u9879`),be.value=!1,!0}catch(a){return console.error("\u6279\u91CF\u6DFB\u52A0\u5B57\u6BB5\u51FA\u9519:",a),S.error("\u6279\u91CF\u6DFB\u52A0\u5B57\u6BB5\u5931\u8D25"),!1}}function He(){let t="";if(D.value==="all"&&$.value.length>0?t=$.value[0]:I.value&&(t=`${o.value}.${I.value}`),!t)return S.warning("\u8BF7\u9009\u62E9\u4E00\u4E2A\u5F15\u7528\u8DEF\u5F84"),!1;if(W.value){c.value=t;const a=[...te.value].sort((g,Y)=>Y.length-g.length);let h="";for(const g of a)if(t.startsWith(g+".")){h=g;break}if(h)J.value=h,Q.value=t.substring(h.length+1);else{const g=t.split(".");J.value=g[0],Q.value=g.slice(1).join(".")}}else if(ae.value){const{key:a,field:h}=ae.value;h.value=t;const g=[...te.value].sort((fe,Oe)=>Oe.length-fe.length);let Y="",ge="";for(const fe of g)if(t.startsWith(fe+".")){Y=fe,ge=t.substring(fe.length+1);break}if(!Y){const fe=t.split(".");Y=fe[0],ge=fe.slice(1).join(".")}_.set(a,{configKey:Y,propertyPath:ge})}return ne.value=!1,!0}function lu(){be.value=!1}function iu(){ne.value=!1,ae.value=null,$.value=[],I.value=""}const We=E(""),$u=oe(()=>{const t=Object.entries(v).map(([a,h])=>({key:a,field:h,refConfigKey:ce(a,h),refPropertyPath:P(a,h)}));return We.value?t.filter(a=>a.key.toLowerCase().includes(We.value.toLowerCase())||String(a.field.value).toLowerCase().includes(We.value.toLowerCase())):t});function ku(){}function Au(t){navigator.clipboard.writeText(t).then(()=>{S.success(j("\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F"))}).catch(()=>{S.error(j("\u590D\u5236\u5931\u8D25"))})}const ru=E(!1),A=E(""),Wu=E(""),bt=E(""),Gu=E(null),$t=E("object"),wu=E(!1),Zu=E(""),Vu=E(""),Xu=E(""),Su=E(null),Yu=E("object");function Qu(t,a){if(!le(a)){S.warning(j("JSON\u683C\u5F0F\u4E0D\u6B63\u786E\uFF0C\u65E0\u6CD5\u5C55\u5F00\u7F16\u8F91"));return}Vu.value=a.value,Xu.value=t,Su.value=a,Yu.value=a.type==="object"?"object":"array",Zu.value=`${j("\u7F16\u8F91")} ${t} (${a.type==="object"?j("\u5BF9\u8C61"):j("\u6570\u7EC4")})`,wu.value=!0}function kt(t){try{Gu.value&&v[t.key]&&(Gu.value.value=t.value,S.success(j("\u66F4\u65B0\u6210\u529F")))}catch(a){console.error("\u5E94\u7528JSON\u7F16\u8F91\u5668\u66F4\u6539\u5931\u8D25:",a),S.error(j("\u5E94\u7528\u66F4\u6539\u5931\u8D25"))}}function At(t){try{Su.value&&v[t.key]&&(Su.value.value=t.value,S.success(j("\u66F4\u65B0\u6210\u529F")))}catch(a){console.error("\u5E94\u7528JSON\u7F16\u8F91\u5668\u66F4\u6539\u5931\u8D25:",a),S.error(j("\u5E94\u7528\u66F4\u6539\u5931\u8D25"))}}const et=E(600);function ju(){const t=window.innerHeight,a=250;et.value=Math.max(500,Math.floor(t*.9-a))}nu(()=>{ju(),window.addEventListener("resize",ju)}),tl(()=>{window.removeEventListener("resize",ju)});function ut(){const t=["all"];function a(h){for(const g of h)g.children&&g.children.length>0&&(t.push(g.key),a(g.children))}Ee.value.length>0&&a(Ee.value[0].children),U.value=t}function tt(t,a){U.value=t}const Ou=E(!1),du=E(!1),cu=E(""),vu=E(null),fu=oe(()=>{if(!vu.value)return"";try{return JSON.stringify(vu.value,null,2)}catch(t){return console.error("\u683C\u5F0F\u5316JSON\u9884\u89C8\u5931\u8D25:",t),""}});async function wt(){if(!r.configItem){S.error(j("\u914D\u7F6E\u9879\u4E0D\u5B58\u5728"));return}Ou.value=!0,du.value=!0,cu.value="",vu.value=null;try{const t=await _l(r.configItem.key,r.env);vu.value=t,du.value=!1}catch(t){console.error("\u83B7\u53D6JSON\u9884\u89C8\u5931\u8D25:",t),du.value=!1,cu.value=j("\u83B7\u53D6JSON\u9884\u89C8\u5931\u8D25")+": "+(t instanceof Error?t.message:String(t))}}function Vt(){if(!!fu.value)try{navigator.clipboard.writeText(fu.value).then(()=>{S.success(j("\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F"))}).catch(t=>{console.error("\u590D\u5236\u5931\u8D25:",t),S.error(j("\u590D\u5236\u5931\u8D25"))})}catch(t){console.error("\u590D\u5236JSON\u9884\u89C8\u5931\u8D25:",t),S.error(j("\u590D\u5236\u5931\u8D25"))}}return(t,a)=>{const h=zu,g=Je,Y=Le,ge=Lu,fe=pt,Oe=xu,St=hu,jt=Du,lt=_u,pu=Ft,Xe=Ku,Ot=yt,Fu=ft,at=ll,Fe=gu,Ye=Cu,yu=al,Ut=Mu,Uu=mt,It=Et,mu=ze,au=Pu,Iu=Ru,ot=_t,Nt=ol,Tt=nl;return n(),m("div",Fa,[B.configItem?(n(),m("div",ya,[p("div",ma,[e(Oe,null,{default:u(()=>[e(ge,{span:16},{default:u(()=>[e(Y,null,{default:u(()=>[e(g,{type:"primary",status:"success",onClick:ue},{icon:u(()=>[e(k(Rt))]),default:u(()=>[i(" "+l(t.$t("\u4FDD\u5B58")),1)]),_:1}),e(g,{onClick:x},{icon:u(()=>[e(k(Re))]),default:u(()=>[i(" "+l(t.$t("\u6DFB\u52A0\u914D\u7F6E\u9879")),1)]),_:1}),e(g,{type:"outline",onClick:bu},{icon:u(()=>[e(k(zt))]),default:u(()=>[i(" "+l(t.$t("\u6279\u91CF\u6DFB\u52A0\u5F15\u7528")),1)]),_:1}),e(g,{type:"outline",onClick:wt},{icon:u(()=>[e(k(dt))]),default:u(()=>[i(" "+l(t.$t("\u9884\u89C8JSON")),1)]),_:1})]),_:1})]),_:1}),e(ge,{span:8,style:{"text-align":"right"}},{default:u(()=>[Object.keys(v).length>5?(n(),z(fe,{key:0,modelValue:We.value,"onUpdate:modelValue":a[0]||(a[0]=s=>We.value=s),placeholder:t.$t("\u641C\u7D22\u914D\u7F6E\u9879"),style:{width:"200px"},"allow-clear":"",onSearch:ku},null,8,["modelValue","placeholder"])):re("",!0)]),_:1})]),_:1})]),e(St,{style:{margin:"16px 0"}}),Object.keys(v).length===0?(n(),m("div",Ea,[e(jt,{description:t.$t("\u6682\u65E0\u914D\u7F6E\u9879")},null,8,["description"]),e(g,{type:"outline",status:"success",style:{"margin-top":"16px"},onClick:x},{default:u(()=>[i(l(t.$t("\u6DFB\u52A0\u7B2C\u4E00\u4E2A\u914D\u7F6E\u9879")),1)]),_:1})])):(n(),m("div",_a,[e(Ut,{data:$u.value,pagination:!1,bordered:!0,class:"config-table",size:"medium",scroll:{y:et.value}},{columns:u(()=>[e(pu,{title:"\u914D\u7F6E\u9879","data-index":"key",width:140,fixed:"left"},{cell:u(({record:s})=>[p("div",ga,[p("span",Ca,l(s.key),1),e(lt,{content:t.$t("\u590D\u5236\u952E\u540D")},{default:u(()=>[e(g,{type:"text",size:"mini",onClick:ee=>Au(s.key)},{icon:u(()=>[e(k(Nu))]),_:2},1032,["onClick"])]),_:2},1032,["content"])])]),_:1}),e(pu,{title:t.$t("\u503C"),"data-index":"value"},{cell:u(({record:s})=>[p("div",ha,[s.field.type==="string"?(n(),z(Xe,{key:0,modelValue:s.field.value,"onUpdate:modelValue":ee=>s.field.value=ee,placeholder:t.$t("\u8BF7\u8F93\u5165\u5B57\u7B26\u4E32\u503C"),"allow-clear":""},null,8,["modelValue","onUpdate:modelValue","placeholder"])):s.field.type==="encrypted"?(n(),z(Ot,{key:1,modelValue:s.field.value,"onUpdate:modelValue":ee=>s.field.value=ee,placeholder:t.$t("\u8BF7\u8F93\u5165\u52A0\u5BC6\u539F\u6587"),"allow-clear":""},null,8,["modelValue","onUpdate:modelValue","placeholder"])):s.field.type==="int"?(n(),z(Fu,{key:2,modelValue:s.field.value,"onUpdate:modelValue":ee=>s.field.value=ee,placeholder:t.$t("\u8BF7\u8F93\u5165\u6574\u6570\u503C"),mode:"button",step:1,style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue","placeholder"])):s.field.type==="float"?(n(),z(Fu,{key:3,modelValue:s.field.value,"onUpdate:modelValue":ee=>s.field.value=ee,placeholder:t.$t("\u8BF7\u8F93\u5165\u6D6E\u70B9\u6570\u503C"),mode:"button",precision:2,step:.1,style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue","placeholder"])):s.field.type==="bool"?(n(),m("div",Da,[e(at,{modelValue:s.field.value,"onUpdate:modelValue":ee=>s.field.value=ee,type:"round",size:"medium"},null,8,["modelValue","onUpdate:modelValue"])])):s.field.type==="ref"?(n(),m("div",Ba,[e(Y,{direction:"vertical",style:{width:"100%"}},{default:u(()=>[e(Y,null,{default:u(()=>[e(Ye,{modelValue:s.refConfigKey,"onUpdate:modelValue":ee=>s.refConfigKey=ee,placeholder:t.$t("\u9009\u62E9\u914D\u7F6E\u952E"),"allow-search":"",style:{"min-width":"200px"},onChange:ee=>pe(s.key,s.field,String(ee))},{default:u(()=>[(n(!0),m(se,null,ye(te.value,ee=>(n(),z(Fe,{key:ee,value:ee},{default:u(()=>[i(l(ee),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","onChange"]),e(Ye,{modelValue:s.refPropertyPath,"onUpdate:modelValue":ee=>s.refPropertyPath=ee,placeholder:t.$t("\u9009\u62E9\u5C5E\u6027\u8DEF\u5F84"),"allow-search":"","allow-create":"",style:{"min-width":"150px"},onChange:ee=>Ve(s.key,s.field,String(ee))},{default:u(()=>[(n(!0),m(se,null,ye(Se(s.key),ee=>(n(),z(Fe,{key:ee,value:ee},{default:u(()=>[i(l(ee),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","onChange"]),e(g,{type:"outline",size:"small",onClick:ee=>qe(s.key,s.field)},{default:u(()=>[i(l(t.$t("\u9009\u62E9\u5F15\u7528")),1)]),_:2},1032,["onClick"])]),_:2},1024),p("div",ba,[p("span",$a,l(t.$t("\u5F53\u524D\u5F15\u7528\u8DEF\u5F84"))+"\uFF1A",1),p("span",{class:Ue({"error-text":!ve(String(s.field.value))})},l(String(s.field.value)||t.$t("\u672A\u8BBE\u7F6E")),3),!ve(String(s.field.value))&&String(s.field.value)?(n(),m("span",ka," ("+l(t.$t("\u683C\u5F0F\u4E0D\u6B63\u786E"))+") ",1)):re("",!0)])]),_:2},1024)])):s.field.type==="object"?(n(),m("div",Aa,[p("div",wa,[e(yu,{modelValue:s.field.value,"onUpdate:modelValue":ee=>s.field.value=ee,placeholder:t.$t("\u8BF7\u8F93\u5165JSON\u5BF9\u8C61"),"auto-size":{minRows:3,maxRows:5},status:le(s.field)?void 0:"error",class:"json-textarea"},null,8,["modelValue","onUpdate:modelValue","placeholder","status"]),p("div",Va,[e(Y,null,{default:u(()=>[e(g,{size:"mini",type:"text",disabled:!le(s.field),onClick:ee=>ie(s.field)},{default:u(()=>[i(l(t.$t("\u683C\u5F0F\u5316")),1)]),_:2},1032,["disabled","onClick"]),e(g,{size:"mini",type:"text",disabled:!le(s.field),onClick:ee=>Qu(s.key,s.field)},{default:u(()=>[i(l(t.$t("\u5C55\u5F00\u7F16\u8F91")),1)]),_:2},1032,["disabled","onClick"])]),_:2},1024)]),p("div",{class:Ue(["field-description",{"error-text":!le(s.field)}])},l(le(s.field)?t.$t("JSON\u683C\u5F0F\u7684\u5BF9\u8C61\u6570\u636E"):t.$t("JSON\u683C\u5F0F\u4E0D\u6B63\u786E")),3)])])):s.field.type==="array"?(n(),m("div",Sa,[p("div",ja,[e(yu,{modelValue:s.field.value,"onUpdate:modelValue":ee=>s.field.value=ee,placeholder:t.$t("\u8BF7\u8F93\u5165JSON\u6570\u7EC4"),"auto-size":{minRows:3,maxRows:5},status:le(s.field)?void 0:"error",class:"json-textarea"},null,8,["modelValue","onUpdate:modelValue","placeholder","status"]),p("div",Oa,[e(Y,null,{default:u(()=>[e(g,{size:"mini",type:"text",disabled:!le(s.field),onClick:ee=>ie(s.field)},{default:u(()=>[i(l(t.$t("\u683C\u5F0F\u5316")),1)]),_:2},1032,["disabled","onClick"]),e(g,{size:"mini",type:"text",disabled:!le(s.field),onClick:ee=>Qu(s.key,s.field)},{default:u(()=>[i(l(t.$t("\u5C55\u5F00\u7F16\u8F91")),1)]),_:2},1032,["disabled","onClick"])]),_:2},1024)]),p("div",{class:Ue(["field-description",{"error-text":!le(s.field)}])},l(le(s.field)?t.$t("JSON\u683C\u5F0F\u7684\u6570\u7EC4\u6570\u636E"):t.$t("JSON\u683C\u5F0F\u4E0D\u6B63\u786E")),3)])])):re("",!0)])]),_:1},8,["title"]),e(pu,{title:t.$t("\u7C7B\u578B"),width:150},{cell:u(({record:s})=>[e(Ye,{modelValue:s.field.type,"onUpdate:modelValue":ee=>s.field.type=ee,style:{width:"100%"}},{default:u(()=>[e(Fe,{value:"string"},{default:u(()=>[i(l(t.$t("\u5B57\u7B26\u4E32")),1)]),_:1}),e(Fe,{value:"encrypted"},{default:u(()=>[i(l(t.$t("\u52A0\u5BC6")),1)]),_:1}),e(Fe,{value:"int"},{default:u(()=>[i(l(t.$t("\u6574\u6570")),1)]),_:1}),e(Fe,{value:"float"},{default:u(()=>[i(l(t.$t("\u6D6E\u70B9\u6570")),1)]),_:1}),e(Fe,{value:"bool"},{default:u(()=>[i(l(t.$t("\u5E03\u5C14\u503C")),1)]),_:1}),e(Fe,{value:"ref"},{default:u(()=>[i(l(t.$t("\u5F15\u7528")),1)]),_:1}),e(Fe,{value:"object"},{default:u(()=>[i(l(t.$t("\u5BF9\u8C61")),1)]),_:1}),e(Fe,{value:"array"},{default:u(()=>[i(l(t.$t("\u6570\u7EC4")),1)]),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1},8,["title"]),e(pu,{title:t.$t("\u64CD\u4F5C"),width:70,align:"center",fixed:"right"},{cell:u(({record:s})=>[e(lt,{content:t.$t("\u5220\u9664")},{default:u(()=>[e(g,{status:"danger",size:"mini",onClick:ee=>T(s.key)},{icon:u(()=>[e(k(Ju))]),_:2},1032,["onClick"])]),_:2},1032,["content"])]),_:1},8,["title"])]),_:1},8,["data","scroll"])]))])):(n(),z(h,{key:0,type:"warning",content:t.$t("\u914D\u7F6E\u9879\u4E0D\u5B58\u5728"),style:{"margin-bottom":"16px"}},null,8,["content"])),e(mu,{visible:O.value,"onUpdate:visible":a[11]||(a[11]=s=>O.value=s),title:t.$t("\u6DFB\u52A0\u914D\u7F6E\u9879"),"mask-closable":!1,"esc-to-close":!1,"footer-before":!0,class:"config-editor-modal",onBeforeOk:w,onCancel:M},{default:u(()=>[e(It,{ref_key:"addFieldFormRef",ref:L,model:c,"label-align":"left","label-col-props":{span:4},"wrapper-col-props":{span:20}},{default:u(()=>[e(Uu,{field:"key",label:t.$t("\u5B57\u6BB5\u540D"),rules:[{required:!0,message:t.$t("\u8BF7\u8F93\u5165\u5B57\u6BB5\u540D")}]},{default:u(()=>[e(Xe,{modelValue:c.key,"onUpdate:modelValue":a[1]||(a[1]=s=>c.key=s),placeholder:t.$t("\u8BF7\u8F93\u5165\u5B57\u6BB5\u540D")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),e(Uu,{field:"type",label:t.$t("\u7C7B\u578B")},{default:u(()=>[e(Ye,{modelValue:c.type,"onUpdate:modelValue":a[2]||(a[2]=s=>c.type=s),placeholder:t.$t("\u8BF7\u9009\u62E9\u7C7B\u578B")},{default:u(()=>[e(Fe,{value:"string"},{default:u(()=>[i(l(t.$t("\u5B57\u7B26\u4E32")),1)]),_:1}),e(Fe,{value:"encrypted"},{default:u(()=>[i(l(t.$t("\u52A0\u5BC6")),1)]),_:1}),e(Fe,{value:"int"},{default:u(()=>[i(l(t.$t("\u6574\u6570")),1)]),_:1}),e(Fe,{value:"float"},{default:u(()=>[i(l(t.$t("\u6D6E\u70B9\u6570")),1)]),_:1}),e(Fe,{value:"bool"},{default:u(()=>[i(l(t.$t("\u5E03\u5C14\u503C")),1)]),_:1}),e(Fe,{value:"ref"},{default:u(()=>[i(l(t.$t("\u5F15\u7528")),1)]),_:1}),e(Fe,{value:"object"},{default:u(()=>[i(l(t.$t("\u5BF9\u8C61")),1)]),_:1}),e(Fe,{value:"array"},{default:u(()=>[i(l(t.$t("\u6570\u7EC4")),1)]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),e(Uu,{field:"value",label:t.$t("\u521D\u59CB\u503C")},{default:u(()=>[c.type==="string"?(n(),z(Xe,{key:0,modelValue:c.value,"onUpdate:modelValue":a[3]||(a[3]=s=>c.value=s),placeholder:t.$t("\u8BF7\u8F93\u5165\u5B57\u7B26\u4E32\u503C")},null,8,["modelValue","placeholder"])):c.type==="int"?(n(),z(Fu,{key:1,modelValue:K.value,"onUpdate:modelValue":a[4]||(a[4]=s=>K.value=s),placeholder:t.$t("\u8BF7\u8F93\u5165\u6574\u6570\u503C"),precision:0},null,8,["modelValue","placeholder"])):c.type==="float"?(n(),z(Fu,{key:2,modelValue:Z.value,"onUpdate:modelValue":a[5]||(a[5]=s=>Z.value=s),placeholder:t.$t("\u8BF7\u8F93\u5165\u6D6E\u70B9\u6570\u503C")},null,8,["modelValue","placeholder"])):c.type==="bool"?(n(),z(at,{key:3,"model-value":c.value==="true","onUpdate:modelValue":a[6]||(a[6]=s=>c.value=String(s))},null,8,["model-value"])):c.type==="ref"?(n(),m("div",Ua,[p("div",Ia,[e(Ye,{modelValue:J.value,"onUpdate:modelValue":a[7]||(a[7]=s=>J.value=s),placeholder:t.$t("\u9009\u62E9\u914D\u7F6E\u952E"),"allow-search":"",style:{flex:"1","margin-right":"8px"}},{default:u(()=>[(n(!0),m(se,null,ye(te.value,s=>(n(),z(Fe,{key:s,value:s},{default:u(()=>[i(l(s),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","placeholder"]),e(Ye,{modelValue:Q.value,"onUpdate:modelValue":a[8]||(a[8]=s=>Q.value=s),placeholder:t.$t("\u9009\u62E9\u5C5E\u6027\u8DEF\u5F84"),"allow-search":"","allow-create":"",style:{flex:"1"},onChange:de},{default:u(()=>[(n(!0),m(se,null,ye(q.value,s=>(n(),z(Fe,{key:s,value:s},{default:u(()=>[i(l(s),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","placeholder"])]),p("div",Na,[e(g,{type:"outline",size:"small",onClick:De},{default:u(()=>[i(l(t.$t("\u9009\u62E9\u5F15\u7528")),1)]),_:1})]),p("div",Ta,[p("span",Ja,l(t.$t("\u5F53\u524D\u5F15\u7528\u8DEF\u5F84"))+"\uFF1A",1),p("span",{class:Ue({"error-text":!ve(c.value)})},l(c.value||t.$t("\u672A\u8BBE\u7F6E")),3),!ve(c.value)&&c.value?(n(),m("span",Ka," ("+l(t.$t("\u683C\u5F0F\u4E0D\u6B63\u786E"))+") ",1)):re("",!0)]),p("div",Pa,l(t.$t('\u652F\u6301\u5E26\u70B9\u7684\u914D\u7F6E\u952E\u540D(\u5982database.dev)\uFF0C\u683C\u5F0F\u4E3A"\u914D\u7F6E\u952E.\u5C5E\u6027\u8DEF\u5F84"')),1)])):c.type==="object"?(n(),m(se,{key:5},[e(yu,{modelValue:c.value,"onUpdate:modelValue":a[9]||(a[9]=s=>c.value=s),placeholder:t.$t("\u8BF7\u8F93\u5165JSON\u5BF9\u8C61"),"auto-size":{minRows:3,maxRows:5},status:b(c.value)?void 0:"error"},null,8,["modelValue","placeholder","status"]),p("div",{class:Ue(["field-description",{"error-text":!b(c.value)}])},l(b(c.value)?t.$t("JSON\u683C\u5F0F\u7684\u5BF9\u8C61\u6570\u636E"):t.$t("JSON\u683C\u5F0F\u4E0D\u6B63\u786E")),3),c.value?(n(),m("div",Ra,[e(g,{size:"mini",type:"text",disabled:!b(c.value),onClick:f},{default:u(()=>[i(l(t.$t("\u683C\u5F0F\u5316")),1)]),_:1},8,["disabled"])])):re("",!0)],64)):c.type==="array"?(n(),m(se,{key:6},[e(yu,{modelValue:c.value,"onUpdate:modelValue":a[10]||(a[10]=s=>c.value=s),placeholder:t.$t("\u8BF7\u8F93\u5165JSON\u6570\u7EC4"),"auto-size":{minRows:3,maxRows:5},status:b(c.value)?void 0:"error"},null,8,["modelValue","placeholder","status"]),p("div",{class:Ue(["field-description",{"error-text":!b(c.value)}])},l(b(c.value)?t.$t("JSON\u683C\u5F0F\u7684\u6570\u7EC4\u6570\u636E"):t.$t("JSON\u683C\u5F0F\u4E0D\u6B63\u786E")),3),c.value?(n(),m("div",za,[e(g,{size:"mini",type:"text",disabled:!b(c.value),onClick:f},{default:u(()=>[i(l(t.$t("\u683C\u5F0F\u5316")),1)]),_:1},8,["disabled"])])):re("",!0)],64)):re("",!0)]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["visible","title"]),e(mu,{visible:be.value,"onUpdate:visible":a[17]||(a[17]=s=>be.value=s),title:t.$t("\u6279\u91CF\u9009\u62E9\u5C5E\u6027\u8DEF\u5F84"),"mask-closable":!1,"esc-to-close":!1,"footer-before":!0,class:"config-editor-modal batch-select-modal",onBeforeOk:tu,onCancel:lu},{default:u(()=>[p("div",La,[p("div",xa,[e(Iu,{modelValue:he.value,"onUpdate:modelValue":a[12]||(a[12]=s=>he.value=s),type:"button"},{default:u(()=>[e(au,{value:"all"},{default:u(()=>[i(l(t.$t("\u6240\u6709\u914D\u7F6E")),1)]),_:1}),_e.value?(n(),z(au,{key:0,value:_e.value},{default:u(()=>[i(l(_e.value),1)]),_:1},8,["value"])):re("",!0)]),_:1},8,["modelValue"]),he.value!=="all"?(n(),m("div",Ma,[e(Xe,{modelValue:Ie.value,"onUpdate:modelValue":a[13]||(a[13]=s=>Ie.value=s),placeholder:t.$t("\u7B5B\u9009\u5C5E\u6027\u8DEF\u5F84"),"allow-clear":""},{prefix:u(()=>[e(k(st))]),_:1},8,["modelValue","placeholder"])])):re("",!0)]),he.value==="all"?(n(),m("div",qa,[p("div",Ha,[i(l(t.$t("\u70B9\u51FB\u914D\u7F6E\u9879\u5C55\u5F00\uFF0C\u53EF\u9009\u62E9\u5C5E\u6027\u8DEF\u5F84"))+" ",1),e(Y,{class:"tree-actions"},{default:u(()=>[e(g,{type:"text",size:"mini",onClick:a[14]||(a[14]=s=>U.value=["all"])},{default:u(()=>[i(l(t.$t("\u5168\u90E8\u6298\u53E0")),1)]),_:1}),e(g,{type:"text",size:"mini",onClick:ut},{default:u(()=>[i(l(t.$t("\u5168\u90E8\u5C55\u5F00")),1)]),_:1})]),_:1})]),e(ot,{data:Ee.value,"expanded-keys":U.value,"checked-keys":G.value,selectable:!0,checkable:Ae,class:"ref-tree",expandable:!0,"auto-expand-parent":!0,onCheck:su,onSelect:xe,onExpand:tt},null,8,["data","expanded-keys","checked-keys"])])):(n(),m("div",Wa,[p("div",Ga,[e(g,{type:"text",size:"small",onClick:Bu},{default:u(()=>[i(l(t.$t("\u5168\u9009")),1)]),_:1}),e(g,{type:"text",size:"small",onClick:Ze},{default:u(()=>[i(l(t.$t("\u53D6\u6D88\u5168\u9009")),1)]),_:1})]),e(Tt,{modelValue:me.value,"onUpdate:modelValue":a[15]||(a[15]=s=>me.value=s)},{default:u(()=>[(n(!0),m(se,null,ye(Ke.value,s=>(n(),m("div",{key:s,class:"path-item"},[e(Nt,{value:s},{default:u(()=>[i(l(s),1)]),_:2},1032,["value"])]))),128))]),_:1},8,["modelValue"])])),p("div",Za,[e(Xe,{modelValue:R.value,"onUpdate:modelValue":a[16]||(a[16]=s=>R.value=s),placeholder:t.$t("\u914D\u7F6E\u9879\u540D\u79F0\u524D\u7F00 (\u53EF\u9009)")},{prepend:u(()=>[i(l(t.$t("\u524D\u7F00")),1)]),_:1},8,["modelValue","placeholder"]),p("div",Xa,l(t.$t('\u5982\u8BBE\u7F6E\u524D\u7F00 "api_"\uFF0C\u5C06\u751F\u6210\u5982 "api_user_profile" \u5F62\u5F0F\u7684\u914D\u7F6E\u9879\u540D\u79F0')),1)]),p("div",Ya,[p("div",Qa,[i(l(t.$t("\u9884\u89C8"))+" ",1),p("span",eo,l(t.$t("\u5DF2\u9009\u62E9"))+" "+l(Me())+" "+l(t.$t("\u9879")),1)]),Me()>0?(n(),m("div",uo,[p("div",to,[p("span",lo,l(t.$t("\u5B57\u6BB5\u540D\u79F0")),1),p("span",ao,l(t.$t("\u5F15\u7528\u8DEF\u5F84")),1)]),p("div",oo,[he.value==="all"?(n(!0),m(se,{key:0},ye(G.value,s=>(n(),m("div",{key:s,class:"preview-item"},[je(s)?(n(),m(se,{key:0},[p("span",no,l($e(s)),1),p("span",so,l(s),1)],64)):re("",!0)]))),128)):(n(!0),m(se,{key:1},ye(me.value,s=>(n(),m("div",{key:s,class:"preview-item"},[p("span",io,l(Pe(_e.value,s)),1),p("span",ro,l(`${_e.value}.${s}`),1)]))),128))])])):(n(),m("div",co,l(t.$t("\u672A\u9009\u62E9\u4EFB\u4F55\u5C5E\u6027\u8DEF\u5F84")),1))])])]),_:1},8,["visible","title"]),e(mu,{visible:ne.value,"onUpdate:visible":a[22]||(a[22]=s=>ne.value=s),title:t.$t("\u9009\u62E9\u5F15\u7528\u8DEF\u5F84"),"mask-closable":!1,"esc-to-close":!1,"footer-before":!0,class:"config-editor-modal field-ref-select-modal",onBeforeOk:He,onCancel:iu},{default:u(()=>[p("div",vo,[p("div",fo,[e(Iu,{modelValue:D.value,"onUpdate:modelValue":a[18]||(a[18]=s=>D.value=s),type:"button"},{default:u(()=>[e(au,{value:"all"},{default:u(()=>[i(l(t.$t("\u6240\u6709\u914D\u7F6E")),1)]),_:1}),o.value?(n(),z(au,{key:0,value:o.value},{default:u(()=>[i(l(o.value),1)]),_:1},8,["value"])):re("",!0)]),_:1},8,["modelValue"]),D.value!=="all"?(n(),m("div",po,[e(Xe,{modelValue:N.value,"onUpdate:modelValue":a[19]||(a[19]=s=>N.value=s),placeholder:t.$t("\u7B5B\u9009\u5C5E\u6027\u8DEF\u5F84"),"allow-clear":""},{prefix:u(()=>[e(k(st))]),_:1},8,["modelValue","placeholder"])])):re("",!0)]),D.value==="all"?(n(),m("div",Fo,[p("div",yo,[i(l(t.$t("\u70B9\u51FB\u914D\u7F6E\u9879\u5C55\u5F00\uFF0C\u53EF\u9009\u62E9\u5C5E\u6027\u8DEF\u5F84"))+" ",1),e(Y,{class:"tree-actions"},{default:u(()=>[e(g,{type:"text",size:"mini",onClick:a[20]||(a[20]=s=>U.value=["all"])},{default:u(()=>[i(l(t.$t("\u5168\u90E8\u6298\u53E0")),1)]),_:1}),e(g,{type:"text",size:"mini",onClick:ut},{default:u(()=>[i(l(t.$t("\u5168\u90E8\u5C55\u5F00")),1)]),_:1})]),_:1})]),e(ot,{data:Ee.value,"expanded-keys":U.value,"selected-keys":$.value,class:"ref-tree",expandable:!0,"auto-expand-parent":!0,onSelect:ke,onExpand:tt},null,8,["data","expanded-keys","selected-keys"])])):(n(),m("div",mo,[e(Iu,{modelValue:I.value,"onUpdate:modelValue":a[21]||(a[21]=s=>I.value=s),direction:"vertical"},{default:u(()=>[(n(!0),m(se,null,ye(Be.value,s=>(n(),m("div",{key:s,class:"path-item"},[e(au,{value:s},{default:u(()=>[i(l(s),1)]),_:2},1032,["value"])]))),128))]),_:1},8,["modelValue"])])),p("div",Eo,[p("div",_o,l(t.$t("\u9884\u89C8")),1),p("div",go,[$.value.length>0&&D.value==="all"?(n(),m("div",Co,l($.value[0]),1)):I.value?(n(),m("div",ho,l(`${o.value}.${I.value}`),1)):(n(),m("div",Do,l(t.$t("\u672A\u9009\u62E9\u5F15\u7528\u8DEF\u5F84")),1))])])])]),_:1},8,["visible","title"]),e(Il,{visible:ru.value,title:A.value,value:Wu.value,"field-key":bt.value,mode:$t.value,"onUpdate:visible":a[23]||(a[23]=s=>ru.value=s),"onUpdate:value":a[24]||(a[24]=s=>Wu.value=s),onApply:kt},null,8,["visible","title","value","field-key","mode"]),e(pa,{visible:wu.value,title:Zu.value,value:Vu.value,"field-key":Xu.value,mode:Yu.value,"onUpdate:visible":a[25]||(a[25]=s=>wu.value=s),"onUpdate:value":a[26]||(a[26]=s=>Vu.value=s),onApply:At},null,8,["visible","title","value","field-key","mode"]),e(mu,{visible:Ou.value,"onUpdate:visible":a[27]||(a[27]=s=>Ou.value=s),title:t.$t("JSON\u914D\u7F6E\u9884\u89C8"),"mask-closable":!0,"esc-to-close":!0,footer:!1,class:"config-editor-modal json-preview-modal"},{default:u(()=>[p("div",Bo,[du.value?(n(),z(h,{key:0,type:"info",content:t.$t("\u6B63\u5728\u52A0\u8F7D\u9884\u89C8\u6570\u636E...")},null,8,["content"])):cu.value?(n(),z(h,{key:1,type:"error",content:cu.value},null,8,["content"])):(n(),m("div",bo,[p("pre",null,l(fu.value),1)])),p("div",$o,[e(g,{type:"outline",disabled:!fu.value,onClick:Vt},{icon:u(()=>[e(k(Nu))]),default:u(()=>[i(" "+l(t.$t("\u590D\u5236")),1)]),_:1},8,["disabled"])])])]),_:1},8,["visible","title"])])}}});const wo=Ne(Ao,[["__scopeId","data-v-340de8fb"]]),Vo={class:"config-history"},So={class:"toolbar"},jo={key:0,class:"compare-tip"},Oo={key:1},Uo={class:"version-header"},Io={class:"version-header"},No={class:"diff-key"},To={key:0},Jo={key:1,class:"missing-value"},Ko={key:0},Po={key:1,class:"missing-value"},Ro={name:"ConfigHistory"},zo=Te({...Ro,props:{configKey:{type:String,required:!0},env:{type:String,default:"dev"}},emits:["refresh"],setup(B,{emit:d}){const r=B,C=d,j=E(!1),v=E([]),_=E(null),V=E(!1),O=E([]),L=E(!1),c=[{title:"\u7248\u672C",dataIndex:"mod_revision",slotName:"version",width:100},{title:"\u73AF\u5883",dataIndex:"metadata.environment",slotName:"environment",width:120},{title:"\u66F4\u65B0\u65F6\u95F4",dataIndex:"updated_at",slotName:"updated_at",width:180},{title:"\u64CD\u4F5C",slotName:"operation",width:150,fixed:"right"}],K={type:"checkbox",showCheckedAll:!1,onSelect:(y,X,x)=>x.length>2?(S.warning("\u6700\u591A\u53EA\u80FD\u9009\u62E9\u4E24\u4E2A\u7248\u672C\u8FDB\u884C\u5BF9\u6BD4"),!1):!0,onChange:(y,X)=>{O.value=X}},Z=oe(()=>{var y;return _.value?[{label:"\u7248\u672C\u53F7",value:`v${_.value.mod_revision}`},{label:"\u73AF\u5883",value:((y=_.value.metadata)==null?void 0:y.environment)||"default"},{label:"\u521B\u5EFA\u65F6\u95F4",value:new Date(_.value.create_time).toLocaleString()},{label:"\u66F4\u65B0\u65F6\u95F4",value:_.value.updated_at?new Date(_.value.updated_at).toLocaleString():"-"}]:[]}),te=oe(()=>{if(O.value.length!==2)return[];const y=new Set;return O.value[0].value&&Object.keys(O.value[0].value).forEach(X=>y.add(X)),O.value[1].value&&Object.keys(O.value[1].value).forEach(X=>y.add(X)),Array.from(y)});function H(y,X){return y?Object.prototype.hasOwnProperty.call(y,X):!1}nu(()=>{J()}),Ce(()=>r.configKey,()=>{J()});async function J(){if(!!r.configKey)try{j.value=!0,v.value=await ml(r.configKey)}catch(y){S.error("\u83B7\u53D6\u5386\u53F2\u7248\u672C\u5931\u8D25"),console.error(y)}finally{j.value=!1}}function Q(y){_.value=y,V.value=!0}function q(y){ze.confirm({title:"\u56DE\u6EDA\u786E\u8BA4",content:`\u786E\u5B9A\u8981\u56DE\u6EDA\u5230\u7248\u672C v${y.mod_revision} \u5417\uFF1F`,okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88",onOk:async()=>{try{await Dt(y.key,{value:y.value,metadata:y.metadata}),S.success("\u56DE\u6EDA\u6210\u529F"),C("refresh"),J()}catch(X){S.error("\u56DE\u6EDA\u5931\u8D25"),console.error(X)}}})}function de(y){switch(y){case"prod":return"red";case"stag":return"orange";case"test":return"blue";case"dev":return"green";default:return"gray"}}return(y,X)=>{const x=Je,b=Le,F=Du,f=qu,w=Mu,M=Hu,T=gt,ue=hu,ie=Ct,le=ze,ve=Lu,ce=xu;return n(),m("div",Vo,[p("div",So,[e(b,null,{default:u(()=>[e(x,{onClick:J},{icon:u(()=>[e(k(Tu))]),default:u(()=>[i(" "+l(y.$t("\u5237\u65B0")),1)]),_:1})]),_:1})]),e(M,{loading:j.value},{default:u(()=>[v.value.length===0?(n(),z(F,{key:0,description:y.$t("\u6682\u65E0\u5386\u53F2\u8BB0\u5F55")},null,8,["description"])):(n(),z(w,{key:1,"row-key":"mod_revision",columns:c,data:v.value,pagination:{pageSize:10},bordered:!1,stripe:"","row-selection":K,"indent-size":0},{version:u(({record:P})=>[e(f,null,{default:u(()=>[i("v"+l(P.mod_revision),1)]),_:2},1024)]),environment:u(({record:P})=>{var pe;return[e(f,{color:de((pe=P.metadata)==null?void 0:pe.environment)},{default:u(()=>{var Ve;return[i(l(((Ve=P.metadata)==null?void 0:Ve.environment)||"default"),1)]}),_:2},1032,["color"])]}),updated_at:u(({record:P})=>[i(l(new Date(P.updated_at).toLocaleString()),1)]),operation:u(({record:P})=>[e(b,null,{default:u(()=>[e(x,{size:"mini",onClick:pe=>Q(P)},{default:u(()=>[i(l(y.$t("\u67E5\u770B")),1)]),_:2},1032,["onClick"]),e(x,{size:"mini",status:"warning",onClick:pe=>q(P)},{default:u(()=>[i(l(y.$t("\u56DE\u6EDA")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:1},8,["data"]))]),_:1},8,["loading"]),e(le,{visible:V.value,"onUpdate:visible":X[0]||(X[0]=P=>V.value=P),title:y.$t("\u7248\u672C\u8BE6\u60C5"),footer:!1,"mask-closable":!0},{default:u(()=>[e(T,{column:1,"label-style":{"font-weight":"bold"},data:Z.value,bordered:"",size:"large"},null,8,["data"]),_.value?(n(),m(se,{key:0},[e(ue,null,{default:u(()=>[i(l(y.$t("\u914D\u7F6E\u503C")),1)]),_:1}),(n(!0),m(se,null,ye(_.value.value,(P,pe)=>(n(),z(ie,{key:pe,class:"version-value-card"},{title:u(()=>[i(l(pe),1)]),extra:u(()=>[e(f,null,{default:u(()=>[i(l(P.type),1)]),_:2},1024)]),default:u(()=>[p("div",null,l(P.value),1)]),_:2},1024))),128))],64)):re("",!0)]),_:1},8,["visible","title"]),e(le,{visible:L.value,"onUpdate:visible":X[1]||(X[1]=P=>L.value=P),title:y.$t("\u7248\u672C\u5BF9\u6BD4"),footer:!1,"mask-closable":!0,style:{width:"720px"}},{default:u(()=>[O.value.length!==2?(n(),m("div",jo,l(y.$t("\u8BF7\u9009\u62E9\u4E24\u4E2A\u7248\u672C\u8FDB\u884C\u5BF9\u6BD4")),1)):(n(),m("div",Oo,[e(ce,{style:{"margin-bottom":"16px"}},{default:u(()=>[e(ve,{span:12},{default:u(()=>[p("div",Uo,[i(l(y.$t("\u7248\u672C"))+": v"+l(O.value[0].mod_revision)+" ",1),e(f,null,{default:u(()=>{var P;return[i(l(((P=O.value[0].metadata)==null?void 0:P.environment)||"default"),1)]}),_:1})])]),_:1}),e(ve,{span:12},{default:u(()=>[p("div",Io,[i(l(y.$t("\u7248\u672C"))+": v"+l(O.value[1].mod_revision)+" ",1),e(f,null,{default:u(()=>{var P;return[i(l(((P=O.value[1].metadata)==null?void 0:P.environment)||"default"),1)]}),_:1})])]),_:1})]),_:1}),e(ue,{style:{margin:"8px 0"}}),(n(!0),m(se,null,ye(te.value,P=>(n(),m("div",{key:P,class:"diff-item"},[e(ce,null,{default:u(()=>[e(ve,{span:24},{default:u(()=>[p("div",No,l(P),1)]),_:2},1024)]),_:2},1024),e(ce,null,{default:u(()=>[e(ve,{span:12,class:"diff-value"},{default:u(()=>[H(O.value[0].value,P)?(n(),m("div",To,[e(f,null,{default:u(()=>[i(l(O.value[0].value[P].type),1)]),_:2},1024),i(" "+l(O.value[0].value[P].value),1)])):(n(),m("div",Jo,l(y.$t("\u65E0\u6B64\u914D\u7F6E")),1))]),_:2},1024),e(ve,{span:12,class:"diff-value"},{default:u(()=>[H(O.value[1].value,P)?(n(),m("div",Ko,[e(f,null,{default:u(()=>[i(l(O.value[1].value[P].type),1)]),_:2},1024),i(" "+l(O.value[1].value[P].value),1)])):(n(),m("div",Po,l(y.$t("\u65E0\u6B64\u914D\u7F6E")),1))]),_:2},1024)]),_:2},1024)]))),128))]))]),_:1},8,["visible","title"])])}}});const Lo=Ne(zo,[["__scopeId","data-v-1aaedc77"]]),xo={class:"env-compare"},Mo={class:"toolbar"},qo={key:1},Ho={class:"env-status"},Wo={class:"env-header"},Go={class:"env-header"},Zo={key:2},Xo={class:"diff-summary"},Yo={class:"table-container"},Qo={class:"value-cell"},en={class:"value-cell"},un={class:"action-buttons",style:{"margin-top":"16px"}},tn={name:"ConfigEnvCompare"},ln=Te({...tn,props:{configKey:{type:String,required:!0}},emits:["refresh"],setup(B,{emit:d}){const r=B,C=d,j=["dev","test","stag","prod","default"],v=E(!1),_=E(!1),V=E("dev"),O=E("prod"),L=E({}),c=oe(()=>{if(console.log("\u8BA1\u7B97sourceConfig\uFF0C\u5F53\u524D\u73AF\u5883:",V.value),console.log("\u53EF\u7528\u73AF\u5883\u914D\u7F6E:",Object.keys(L.value)),L.value[V.value])return L.value[V.value];if(V.value!=="default"&&L.value.default)return console.log("\u4F7F\u7528default\u73AF\u5883\u66FF\u4EE3",V.value),L.value.default}),K=oe(()=>{if(console.log("\u8BA1\u7B97targetConfig\uFF0C\u5F53\u524D\u73AF\u5883:",O.value),L.value[O.value])return L.value[O.value];if(O.value!=="default"&&L.value.default)return console.log("\u4F7F\u7528default\u73AF\u5883\u66FF\u4EE3",O.value),L.value.default}),Z=oe(()=>_.value?!c.value||!K.value:!1),te=oe(()=>{if(!c.value||!K.value)return[];const f=new Set,w=Object.keys(c.value.value||{}),M=Object.keys(K.value.value||{});return w.forEach(T=>f.add(T)),M.forEach(T=>f.add(T)),Array.from(f).filter(T=>{var le,ve,ce,P;const ue=(ve=(le=c.value)==null?void 0:le.value)==null?void 0:ve[T],ie=(P=(ce=K.value)==null?void 0:ce.value)==null?void 0:P[T];return!ue||!ie?!0:ue.type!==ie.type||ue.value!==ie.value})}),H=oe(()=>{if(!c.value||!K.value)return[];const f=new Set,w=Object.keys(c.value.value||{}),M=Object.keys(K.value.value||{});return w.forEach(T=>f.add(T)),M.forEach(T=>f.add(T)),Array.from(f).map(T=>{var le,ve,ce,P;const ue=(ve=(le=c.value)==null?void 0:le.value)==null?void 0:ve[T],ie=(P=(ce=K.value)==null?void 0:ce.value)==null?void 0:P[T];return{key:T,sourceType:(ue==null?void 0:ue.type)||"",sourceValue:(ue==null?void 0:ue.value)||F("\u4E0D\u5B58\u5728"),targetType:(ie==null?void 0:ie.type)||"",targetValue:(ie==null?void 0:ie.value)||F("\u4E0D\u5B58\u5728"),isDifferent:!ue||!ie||ue.type!==ie.type||ue.value!==ie.value}}).sort((T,ue)=>T.isDifferent&&!ue.isDifferent?-1:!T.isDifferent&&ue.isDifferent?1:T.key.localeCompare(ue.key))});nu(()=>{J()}),Ce(()=>r.configKey,(f,w)=>{f&&f!==w&&(console.log("\u914D\u7F6E\u952E\u53D8\u5316\uFF0C\u4ECE",w,"\u5230",f,"\uFF0C\u5237\u65B0\u73AF\u5883\u914D\u7F6E"),J(),_.value=!1)},{immediate:!0});async function J(){if(!!r.configKey)try{v.value=!0,console.log("\u5F00\u59CB\u83B7\u53D6\u73AF\u5883\u914D\u7F6E\uFF0C\u952E:",r.configKey);const f=await El(r.configKey);if(console.log("\u73AF\u5883\u914D\u7F6E\u54CD\u5E94:",f),!f){console.error("\u73AF\u5883\u914D\u7F6E\u8FD4\u56DE\u4E3A\u7A7A"),L.value={};return}console.log("\u73AF\u5883\u914D\u7F6E\u6570\u636E\u7C7B\u578B:",typeof f),console.log("\u73AF\u5883\u914D\u7F6E\u952E\u5217\u8868:",Object.keys(f)),L.value=f,console.log("\u8BBE\u7F6E\u540E\u7684\u73AF\u5883\u914D\u7F6E:",L.value)}catch(f){S.error("\u83B7\u53D6\u73AF\u5883\u914D\u7F6E\u5931\u8D25"),console.error("\u83B7\u53D6\u73AF\u5883\u914D\u7F6E\u5F02\u5E38:",f),L.value={}}finally{v.value=!1}}function Q(){if(V.value===O.value){S.warning("\u8BF7\u9009\u62E9\u4E0D\u540C\u7684\u73AF\u5883\u8FDB\u884C\u5BF9\u6BD4");return}_.value=!0}async function q(){if(!c.value){S.error("\u6E90\u73AF\u5883\u4E0D\u5B58\u5728\u8BE5\u914D\u7F6E");return}try{v.value=!0;const f={...c.value.metadata||{}};f.environment=O.value,await Qe(r.configKey,O.value,{value:c.value.value||{},metadata:f}),S.success("\u590D\u5236\u5230\u76EE\u6807\u73AF\u5883\u6210\u529F"),C("refresh"),await J()}catch(f){S.error("\u590D\u5236\u5931\u8D25"),console.error("\u590D\u5236\u5230\u76EE\u6807\u73AF\u5883\u5931\u8D25:",f)}finally{v.value=!1}}async function de(){if(!K.value){S.error("\u76EE\u6807\u73AF\u5883\u4E0D\u5B58\u5728\u8BE5\u914D\u7F6E");return}try{v.value=!0;const f={...K.value.metadata||{}};f.environment=V.value,await Qe(r.configKey,V.value,{value:K.value.value||{},metadata:f}),S.success("\u590D\u5236\u5230\u6E90\u73AF\u5883\u6210\u529F"),C("refresh"),await J()}catch(f){S.error("\u590D\u5236\u5931\u8D25"),console.error("\u590D\u5236\u5230\u6E90\u73AF\u5883\u5931\u8D25:",f)}finally{v.value=!1}}async function y(f){if(!c.value||!c.value.value||!c.value.value[f]){S.error("\u6E90\u73AF\u5883\u4E0D\u5B58\u5728\u8BE5\u914D\u7F6E\u9879");return}if(!K.value){S.error("\u76EE\u6807\u73AF\u5883\u4E0D\u5B58\u5728\u8BE5\u914D\u7F6E\uFF0C\u8BF7\u5148\u521B\u5EFA");return}try{v.value=!0;const w={...K.value.value||{}};w[f]={...c.value.value[f]};const M={...K.value.metadata||{}};await Qe(r.configKey,O.value,{value:w,metadata:M}),S.success("\u590D\u5236\u914D\u7F6E\u9879\u5230\u76EE\u6807\u73AF\u5883\u6210\u529F"),C("refresh"),await J()}catch(w){S.error("\u590D\u5236\u5931\u8D25"),console.error("\u590D\u5236\u914D\u7F6E\u9879\u5230\u76EE\u6807\u73AF\u5883\u5931\u8D25:",w)}finally{v.value=!1}}async function X(f){if(!K.value||!K.value.value||!K.value.value[f]){S.error("\u76EE\u6807\u73AF\u5883\u4E0D\u5B58\u5728\u8BE5\u914D\u7F6E\u9879");return}if(!c.value){S.error("\u6E90\u73AF\u5883\u4E0D\u5B58\u5728\u8BE5\u914D\u7F6E\uFF0C\u8BF7\u5148\u521B\u5EFA");return}try{v.value=!0;const w={...c.value.value||{}};w[f]={...K.value.value[f]};const M={...c.value.metadata||{}};await Qe(r.configKey,V.value,{value:w,metadata:M}),S.success("\u590D\u5236\u914D\u7F6E\u9879\u5230\u6E90\u73AF\u5883\u6210\u529F"),C("refresh"),await J()}catch(w){S.error("\u590D\u5236\u5931\u8D25"),console.error("\u590D\u5236\u914D\u7F6E\u9879\u5230\u6E90\u73AF\u5883\u5931\u8D25:",w)}finally{v.value=!1}}async function x(){if(!c.value){S.error("\u6E90\u73AF\u5883\u4E0D\u5B58\u5728\u8BE5\u914D\u7F6E");return}ze.confirm({title:"\u786E\u8BA4\u540C\u6B65",content:`\u786E\u5B9A\u8981\u5C06\u6240\u6709\u914D\u7F6E\u4ECE ${V.value} \u540C\u6B65\u5230 ${O.value} \u5417\uFF1F\u8FD9\u5C06\u8986\u76D6\u76EE\u6807\u73AF\u5883\u7684\u6240\u6709\u914D\u7F6E\u3002`,okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88",onOk:async()=>{try{if(v.value=!0,!c.value)throw new Error("\u6E90\u73AF\u5883\u914D\u7F6E\u4E0D\u5B58\u5728");const f={...c.value.metadata||{}};f.environment=O.value,await Qe(r.configKey,O.value,{value:c.value.value||{},metadata:f}),S.success("\u540C\u6B65\u5230\u76EE\u6807\u73AF\u5883\u6210\u529F"),C("refresh"),await J()}catch(f){S.error("\u540C\u6B65\u5931\u8D25"),console.error("\u540C\u6B65\u5230\u76EE\u6807\u73AF\u5883\u5931\u8D25:",f)}finally{v.value=!1}}})}async function b(){if(!K.value){S.error("\u76EE\u6807\u73AF\u5883\u4E0D\u5B58\u5728\u8BE5\u914D\u7F6E");return}ze.confirm({title:"\u786E\u8BA4\u540C\u6B65",content:`\u786E\u5B9A\u8981\u5C06\u6240\u6709\u914D\u7F6E\u4ECE ${O.value} \u540C\u6B65\u5230 ${V.value} \u5417\uFF1F\u8FD9\u5C06\u8986\u76D6\u6E90\u73AF\u5883\u7684\u6240\u6709\u914D\u7F6E\u3002`,okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88",onOk:async()=>{try{if(v.value=!0,!K.value)throw new Error("\u76EE\u6807\u73AF\u5883\u914D\u7F6E\u4E0D\u5B58\u5728");const f={...K.value.metadata||{}};f.environment=V.value,await Qe(r.configKey,V.value,{value:K.value.value||{},metadata:f}),S.success("\u540C\u6B65\u5230\u6E90\u73AF\u5883\u6210\u529F"),C("refresh"),await J()}catch(f){S.error("\u540C\u6B65\u5931\u8D25"),console.error("\u540C\u6B65\u5230\u6E90\u73AF\u5883\u5931\u8D25:",f)}finally{v.value=!1}}})}function F(f,w){return w?f.replace(/\{(\d+)\}/g,(M,T)=>String(w[Number(T)])):f}return(f,w)=>{const M=Je,T=Le,ue=gu,ie=Cu,le=hu,ve=Du,ce=zu,P=qu,pe=Lu,Ve=xu,Se=Ft,be=_u,_e=Mu,he=Hu;return n(),m("div",xo,[p("div",Mo,[e(T,null,{default:u(()=>[e(M,{type:"primary",onClick:Q},{icon:u(()=>[e(k(Lt))]),default:u(()=>[i(" "+l(F("\u5F00\u59CB\u5BF9\u6BD4")),1)]),_:1}),e(M,{onClick:J},{icon:u(()=>[e(k(Tu))]),default:u(()=>[i(" "+l(F("\u5237\u65B0\u73AF\u5883\u914D\u7F6E")),1)]),_:1})]),_:1}),e(T,null,{default:u(()=>[e(ie,{modelValue:V.value,"onUpdate:modelValue":w[0]||(w[0]=G=>V.value=G),placeholder:F("\u6E90\u73AF\u5883"),style:{width:"120px"}},{default:u(()=>[(n(),m(se,null,ye(j,G=>e(ue,{key:G,value:G},{default:u(()=>[i(l(G),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue","placeholder"]),e(k(xt)),e(ie,{modelValue:O.value,"onUpdate:modelValue":w[1]||(w[1]=G=>O.value=G),placeholder:F("\u76EE\u6807\u73AF\u5883"),style:{width:"120px"}},{default:u(()=>[(n(),m(se,null,ye(j,G=>e(ue,{key:G,value:G},{default:u(()=>[i(l(G),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue","placeholder"])]),_:1})]),e(le),e(he,{loading:v.value},{default:u(()=>[_.value?Z.value?(n(),m("div",qo,[e(ce,{type:"warning",content:F("\u81F3\u5C11\u6709\u4E00\u4E2A\u73AF\u5883\u6CA1\u6709\u8BE5\u914D\u7F6E\u9879")},null,8,["content"]),p("div",Ho,[e(Ve,null,{default:u(()=>[e(pe,{span:12},{default:u(()=>[p("div",Wo,[i(l(V.value)+" ",1),e(P,{color:c.value?"green":"red"},{default:u(()=>[i(l(c.value?F("\u5B58\u5728"):F("\u4E0D\u5B58\u5728")),1)]),_:1},8,["color"])])]),_:1}),e(pe,{span:12},{default:u(()=>[p("div",Go,[i(l(O.value)+" ",1),e(P,{color:K.value?"green":"red"},{default:u(()=>[i(l(K.value?F("\u5B58\u5728"):F("\u4E0D\u5B58\u5728")),1)]),_:1},8,["color"])])]),_:1})]),_:1})]),e(T,{style:{"margin-top":"16px"}},{default:u(()=>[c.value&&!K.value?(n(),z(M,{key:0,type:"primary",status:"success",onClick:q},{default:u(()=>[i(l(F("\u590D\u5236\u5230\u76EE\u6807\u73AF\u5883")),1)]),_:1})):re("",!0),!c.value&&K.value?(n(),z(M,{key:1,type:"primary",status:"success",onClick:de},{default:u(()=>[i(l(F("\u590D\u5236\u5230\u6E90\u73AF\u5883")),1)]),_:1})):re("",!0)]),_:1})])):(n(),m("div",Zo,[p("div",Xo,[te.value.length===0?(n(),z(ce,{key:0,type:"success",content:F("\u4E24\u4E2A\u73AF\u5883\u914D\u7F6E\u5B8C\u5168\u76F8\u540C"),style:{"margin-bottom":"16px"}},null,8,["content"])):(n(),z(ce,{key:1,type:"info",content:F("\u53D1\u73B0 {0} \u4E2A\u5DEE\u5F02",[te.value.length]),style:{"margin-bottom":"16px"}},null,8,["content"]))]),p("div",Yo,[e(_e,{data:H.value,bordered:!0,pagination:!1,"row-key":"key"},{columns:u(()=>[e(Se,{title:"\u914D\u7F6E\u9879","data-index":"key"}),e(Se,{title:V.value,"data-index":"sourceValue"},{cell:u(({record:G})=>[p("div",Qo,[G.sourceType?(n(),z(P,{key:0},{default:u(()=>[i(l(G.sourceType),1)]),_:2},1024)):re("",!0),p("span",null,l(G.sourceValue),1)])]),_:1},8,["title"]),e(Se,{title:O.value,"data-index":"targetValue"},{cell:u(({record:G})=>[p("div",en,[G.targetType?(n(),z(P,{key:0},{default:u(()=>[i(l(G.targetType),1)]),_:2},1024)):re("",!0),p("span",null,l(G.targetValue),1)])]),_:1},8,["title"]),e(Se,{title:"\u64CD\u4F5C",fixed:"right",width:150},{cell:u(({record:G})=>[e(T,null,{default:u(()=>[e(be,{content:F("\u590D\u5236\u5230\u76EE\u6807\u73AF\u5883")},{default:u(()=>[e(M,{size:"mini",onClick:me=>y(G.key)},{default:u(()=>w[2]||(w[2]=[i(" \u2192 ")])),_:2},1032,["onClick"])]),_:2},1032,["content"]),e(be,{content:F("\u590D\u5236\u5230\u6E90\u73AF\u5883")},{default:u(()=>[e(M,{size:"mini",onClick:me=>X(G.key)},{default:u(()=>w[3]||(w[3]=[i(" \u2190 ")])),_:2},1032,["onClick"])]),_:2},1032,["content"])]),_:2},1024)]),_:1})]),_:1},8,["data"])]),p("div",un,[e(T,null,{default:u(()=>[e(M,{type:"primary",status:"success",onClick:x},{default:u(()=>[i(l(F("\u5168\u90E8\u540C\u6B65\u5230\u76EE\u6807\u73AF\u5883")),1)]),_:1}),e(M,{type:"primary",status:"warning",onClick:b},{default:u(()=>[i(l(F("\u5168\u90E8\u540C\u6B65\u5230\u6E90\u73AF\u5883")),1)]),_:1})]),_:1})])])):(n(),z(ve,{key:0,description:F("\u8BF7\u9009\u62E9\u73AF\u5883\u8FDB\u884C\u5BF9\u6BD4")},null,8,["description"]))]),_:1},8,["loading"])])}}});const an=Ne(ln,[["__scopeId","data-v-de7902c2"]]),on={class:"config-center-container"},nn={class:"config-layout"},sn={class:"config-sidebar"},rn={class:"sidebar-header"},dn={class:"sidebar-title"},cn={class:"env-filter-bar"},vn={class:"config-content"},fn={class:"content-header"},pn={class:"content-title"},Fn={key:1,class:"config-detail-container"},yn={class:"info-card"},mn={class:"export-hint"},En={class:"import-hint"},_n={class:"import-result-container"},gn={key:0},Cn={key:1},hn={key:0,class:"skipped-list-container"},Dn=Te({__name:"index",setup(B){const d=["dev","test","stag","prod"],r=E(!1),C=E(!1),j=E(""),v=E([]),_=E(""),V=E("dev"),O=E(null),L=E(!1),c=E(!1),K=E(!1),Z=E(!1),te=E(),H=E(),J=E(),Q=E("all"),q=E(["root"]),de=E([]),y=eu({key:"",environment:"",description:"",initialConfigKey:"",initialConfigValue:"",initialConfigType:"string"}),X=eu({password:"",confirmPassword:""}),x=eu({password:"",file:null,skipExisting:!0,originalSalt:""}),b=oe(()=>{if(!v.value||!v.value.length)return[];const o=[{key:"root",title:"\u6839\u76EE\u5F55",selectable:!1,children:[]}];let D=v.value.filter($=>$&&$.key);return j.value&&(D=D.filter($=>{var I;return $.key.includes(j.value)||((I=$.metadata)==null?void 0:I.description)&&$.metadata.description.includes(j.value)})),Q.value!=="all"&&(D=D.filter($=>{var N;return(((N=$.metadata)==null?void 0:N.environment)||"default")===Q.value||$.key.endsWith("."+Q.value)||$.key.includes("."+Q.value+".")})),D.forEach($=>{var je;if(!$||!$.key)return;let I=$.key,N=((je=$.metadata)==null?void 0:je.environment)||"default";const W=$.key.split(".");if(W.length>1){const Ae=W[W.length-1];d.includes(Ae)?(N=Ae,I=W.slice(0,W.length-1).join(".")):W.length>2&&d.includes(W[W.length-2])&&(N=W[W.length-2])}const Ee=I.split(".");let Ke=o[0].children,Be="";for(let Ae=0;Ae<Ee.length;Ae++){const xe=Ee[Ae];Be=Be?`${Be}.${xe}`:xe;let $e=Ke.find(Pe=>Pe.key===Be);$e||($e={key:Be,title:xe,children:[],selectable:!0},Ke.push($e)),Ae===Ee.length-1&&($e.children.some(Me=>Me.configEnv===N)||$e.children.push({key:`${I}:${N}`,title:N==="default"?"\u9ED8\u8BA4":N,isLeaf:!0,configEnv:N,configKey:$.key})),Ke=$e.children}}),o}),F=oe(()=>{var D,$;if(!O.value)return[];const o=O.value;return[{label:"\u914D\u7F6E\u952E",value:o.key||""},{label:"\u73AF\u5883",value:((D=o.metadata)==null?void 0:D.environment)||"default"},{label:"\u7248\u672C\u53F7",value:o.version?String(o.version):"-"},{label:"\u66F4\u65B0\u65F6\u95F4",value:o.updated_at?new Date(o.updated_at).toLocaleString():"-"},{label:"\u63CF\u8FF0",value:(($=o.metadata)==null?void 0:$.description)||"-"}]}),f=E(!1),w=eu({skipped:[]}),M=E(""),T=oe(()=>!w.skipped||!Array.isArray(w.skipped)?[]:M.value?w.skipped.filter(o=>o.toLowerCase().includes(M.value.toLowerCase())):w.skipped);nu(()=>{le()});function ue(o){switch(o){case"dev":return"blue";case"test":return"green";case"stag":return"orange";case"prod":return"red";default:return"gray"}}function ie(){}async function le(){try{r.value=!0,console.log("\u5F00\u59CB\u83B7\u53D6\u914D\u7F6E\u5217\u8868...");const o=await ht();console.log("\u83B7\u53D6\u914D\u7F6E\u5217\u8868\u7ED3\u679C:",o),Array.isArray(o)?(console.log("\u914D\u7F6E\u5217\u8868\u4E3A\u6570\u7EC4\uFF0C\u957F\u5EA6:",o.length),v.value=o):(console.error("\u914D\u7F6E\u5217\u8868\u4E0D\u662F\u6570\u7EC4:",typeof o),v.value=[])}catch(o){S.error("\u83B7\u53D6\u914D\u7F6E\u5217\u8868\u5931\u8D25"),console.error("\u83B7\u53D6\u914D\u7F6E\u5217\u8868\u5F02\u5E38:",o),v.value=[]}finally{r.value=!1}}function ve(){}async function ce(o,D){const $=D.node;if(($==null?void 0:$.configKey)&&($==null?void 0:$.configEnv)){_.value=$.configKey,V.value=$.configEnv,await pe();return}$&&$.children&&$.children.length>0&&(q.value.includes($.key)?q.value=q.value.filter(N=>N!==$.key):q.value=[...q.value,$.key])}function P(o,D){if(!D.node||D.expanded===void 0)return;const $=D.node.key;D.expanded?q.value=[...new Set([...q.value,$])]:q.value=q.value.filter(I=>I!==$)}async function pe(){if(!!_.value)try{C.value=!0,console.log("\u5F00\u59CB\u83B7\u53D6\u914D\u7F6E\u8BE6\u60C5\uFF0C\u952E:",_.value);let o=_.value;const D=_.value.split("."),$=D[D.length-1];$!==V.value&&d.includes(V.value)&&(d.includes($)?o=D.slice(0,D.length-1).join(".")+"."+V.value:V.value!=="default"&&(o=_.value+"."+V.value)),console.log("\u83B7\u53D6\u914D\u7F6E\u8BE6\u60C5\u7684\u952E:",o);const I=await Fl(o);if(console.log("\u83B7\u53D6\u914D\u7F6E\u8BE6\u60C5\u54CD\u5E94:",I),!I){console.error("\u914D\u7F6E\u8BE6\u60C5\u4E3A\u7A7A"),S.warning(`\u672A\u627E\u5230\u914D\u7F6E\u9879: ${o}`),O.value=null;return}I.value||(console.warn("\u914D\u7F6E\u8BE6\u60C5\u4E2D\u6CA1\u6709value\u5B57\u6BB5:",I),I.value={}),console.log("\u914D\u7F6E\u503C\u7ED3\u6784:",I.value),O.value=I}catch(o){S.error(`\u83B7\u53D6\u914D\u7F6E\u8BE6\u60C5\u5931\u8D25: ${o instanceof Error?o.message:"\u672A\u77E5\u9519\u8BEF"}`),console.error("\u83B7\u53D6\u914D\u7F6E\u8BE6\u60C5\u5F02\u5E38:",o),O.value=null}finally{C.value=!1}}async function Ve(o){V.value=o,await pe()}function Se(){L.value=!0}async function be(){if(!te.value)return!1;try{await te.value.validate();let o=y.initialConfigValue;if(y.initialConfigType==="int")o=parseInt(y.initialConfigValue);else if(y.initialConfigType==="float")o=parseFloat(y.initialConfigValue);else if(y.initialConfigType==="bool")o=y.initialConfigValue.toLowerCase()==="true";else if(y.initialConfigType==="object")try{o=JSON.parse(y.initialConfigValue)}catch{return S.error("\u5BF9\u8C61\u683C\u5F0F\u4E0D\u6B63\u786E\uFF0C\u8BF7\u8F93\u5165\u6709\u6548\u7684JSON\u683C\u5F0F"),!1}else if(y.initialConfigType==="array")try{if(o=JSON.parse(y.initialConfigValue),!Array.isArray(o))throw new Error("Not an array")}catch{return S.error("\u6570\u7EC4\u683C\u5F0F\u4E0D\u6B63\u786E\uFF0C\u8BF7\u8F93\u5165\u6709\u6548\u7684JSON\u6570\u7EC4\u683C\u5F0F"),!1}const D={[y.initialConfigKey]:{value:o,type:y.initialConfigType}},$={};if(y.description&&($.description=y.description),y.environment){let I=y.key;const N=I.split(".");N[N.length-1]!==y.environment&&!I.endsWith("."+y.environment)&&(I=`${I}.${y.environment}`),console.log("\u521B\u5EFA\u914D\u7F6E\uFF0C\u952E:",I,"\u73AF\u5883:",y.environment),await it({key:I,value:D,metadata:{...$,environment:y.environment}})}else await it({key:y.key,value:D,metadata:$});return S.success("\u914D\u7F6E\u521B\u5EFA\u6210\u529F"),le(),me(),!0}catch(o){return S.error("\u521B\u5EFA\u914D\u7F6E\u5931\u8D25"),console.error(o),!1}}async function _e(){await pe(),S.success("\u914D\u7F6E\u66F4\u65B0\u6210\u529F")}function he(){!_.value||(c.value=!0)}async function G(){if(!_.value)return!1;try{return await yl(_.value),S.success("\u914D\u7F6E\u5220\u9664\u6210\u529F"),_.value="",O.value=null,le(),!0}catch(o){return S.error("\u5220\u9664\u914D\u7F6E\u5931\u8D25"),console.error(o),!1}}function me(){var o;y.key="",y.environment="",y.description="",y.initialConfigKey="",y.initialConfigValue="",y.initialConfigType="string",(o=te.value)==null||o.clearValidate()}function Ie(){K.value=!0}function R(){Z.value=!0,de.value=[],x.password="",x.file=null,x.originalSalt=""}function U(o){de.value=o,o&&o.length>0?x.file=o[0].file:x.file=null}async function ne(){if(!H.value)return!1;try{await H.value.validate(),C.value=!0;const o=X.password,D=await gl(o);if(!D||!D.data)throw new Error("\u5BFC\u51FA\u6570\u636E\u4E3A\u7A7A");const $=new Blob([D.data],{type:"application/octet-stream"}),I=URL.createObjectURL($),N=document.createElement("a");N.href=I;const W=new Date,Ee=`config_export_${W.getFullYear()}${(W.getMonth()+1).toString().padStart(2,"0")}${W.getDate().toString().padStart(2,"0")}_${W.getHours().toString().padStart(2,"0")}${W.getMinutes().toString().padStart(2,"0")}.aio`;return N.download=Ee,document.body.appendChild(N),N.click(),document.body.removeChild(N),URL.revokeObjectURL(I),X.password="",X.confirmPassword="",S.success("\u914D\u7F6E\u5BFC\u51FA\u6210\u529F"),!0}catch(o){return console.error("\u5BFC\u51FA\u914D\u7F6E\u5931\u8D25:",o),S.error(`\u5BFC\u51FA\u914D\u7F6E\u5931\u8D25: ${o instanceof Error?o.message:"\u672A\u77E5\u9519\u8BEF"}`),!1}finally{C.value=!1}}async function ae(){if(!J.value)return!1;try{if(await J.value.validate(),!x.file)return S.error("\u8BF7\u9009\u62E9\u8981\u5BFC\u5165\u7684\u914D\u7F6E\u6587\u4EF6"),!1;C.value=!0;const o=new FileReader,D=await new Promise((I,N)=>{o.onload=W=>{W.target&&typeof W.target.result=="string"?I(W.target.result):N(new Error("\u8BFB\u53D6\u6587\u4EF6\u5931\u8D25"))},o.onerror=W=>N(W),o.readAsText(x.file)}),$=await Cl({data:D,password:x.password,skipExisting:x.skipExisting,originalSalt:x.originalSalt});return console.log("\u5BFC\u5165\u914D\u7F6E\u8FD4\u56DE\u7ED3\u679C:",$),x.password="",x.file=null,x.originalSalt="",de.value=[],await le(),$.skipped&&Array.isArray($.skipped)?(console.log("\u68C0\u6D4B\u5230\u8DF3\u8FC7\u7684\u914D\u7F6E:",$.skipped),w.skipped=$.skipped,f.value=!0,$.skipped.length===0&&S.success("\u914D\u7F6E\u5BFC\u5165\u6210\u529F")):(console.log("\u6CA1\u6709\u8DF3\u8FC7\u7684\u914D\u7F6E\u6216\u8DF3\u8FC7\u914D\u7F6E\u5217\u8868\u4E3A\u7A7A"),w.skipped=[],S.success("\u914D\u7F6E\u5BFC\u5165\u6210\u529F")),!0}catch(o){return console.error("\u5BFC\u5165\u914D\u7F6E\u5931\u8D25:",o),S.error(`\u5BFC\u5165\u914D\u7F6E\u5931\u8D25: ${o instanceof Error?o.message:"\u672A\u77E5\u9519\u8BEF"}`),!1}finally{C.value=!1}}return(o,D)=>{const $=vt("Breadcrumb"),I=Je,N=_u,W=Le,Ee=pt,Ke=hu,Be=Pu,je=Ru,Ae=qu,xe=_t,$e=Du,Pe=Hu,Me=Ct,Bu=gt,Ze=il,bu=rl,qe=Ku,De=mt,ke=gu,su=Cu,tu=Et,He=ze,lu=yt,iu=zu,We=dl,$u=cl,ku=vl,Au=fl,ru=pl;return n(),m("div",on,[e($,{items:["\u914D\u7F6E\u4E2D\u5FC3","\u914D\u7F6E\u7BA1\u7406"]}),p("div",nn,[p("div",sn,[e(Me,{class:"sidebar-card",bordered:!1},{title:u(()=>[p("div",rn,[p("span",dn,l(o.$t("\u914D\u7F6E\u9879\u5217\u8868")),1),e(W,null,{default:u(()=>[e(N,{content:o.$t("\u5BFC\u51FA\u914D\u7F6E")},{default:u(()=>[e(I,{type:"primary",size:"small",onClick:Ie},{icon:u(()=>[e(k(Mt))]),_:1})]),_:1},8,["content"]),e(N,{content:o.$t("\u5BFC\u5165\u914D\u7F6E")},{default:u(()=>[e(I,{type:"primary",status:"warning",size:"small",onClick:R},{icon:u(()=>[e(k(sl))]),_:1})]),_:1},8,["content"]),e(N,{content:o.$t("\u65B0\u5EFA\u914D\u7F6E")},{default:u(()=>[e(I,{type:"primary",size:"small",status:"success",onClick:Se},{icon:u(()=>[e(k(Re))]),_:1})]),_:1},8,["content"]),e(N,{content:o.$t("\u5237\u65B0\u5217\u8868")},{default:u(()=>[e(I,{size:"small",onClick:le},{icon:u(()=>[e(k(Tu))]),_:1})]),_:1},8,["content"])]),_:1})])]),default:u(()=>[e(Ee,{modelValue:j.value,"onUpdate:modelValue":D[0]||(D[0]=A=>j.value=A),placeholder:o.$t("\u641C\u7D22\u914D\u7F6E\u9879"),class:"search-input","allow-clear":"",onSearch:ve},null,8,["modelValue","placeholder"]),e(Ke,{style:{margin:"12px 0"}}),e(Pe,{loading:r.value,class:"full-height"},{default:u(()=>[p("div",cn,[e(je,{modelValue:Q.value,"onUpdate:modelValue":D[1]||(D[1]=A=>Q.value=A),type:"button",size:"small",onChange:ie},{default:u(()=>[e(Be,{value:"all"},{default:u(()=>[i(l(o.$t("\u5168\u90E8")),1)]),_:1}),(n(),m(se,null,ye(d,A=>e(Be,{key:A,value:A},{default:u(()=>[i(l(A),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"])]),b.value.length>0?(n(),z(xe,{key:0,data:b.value,"default-expanded-keys":["root"],"expanded-keys":q.value,class:"config-tree","show-line":!0,draggable:!1,size:"medium",onSelect:ce,onExpand:P},{icon:u(A=>[A.isLeaf?A.configEnv==="dev"?(n(),z(k(ou),{key:1,style:{color:"#1890ff"}})):A.configEnv==="test"?(n(),z(k(ou),{key:2,style:{color:"#52c41a"}})):A.configEnv==="stag"?(n(),z(k(ou),{key:3,style:{color:"#faad14"}})):A.configEnv==="prod"?(n(),z(k(ou),{key:4,style:{color:"#f5222d"}})):(n(),z(k(ou),{key:5})):(n(),z(k(qt),{key:0}))]),title:u(A=>[p("span",{class:Ue({"selected-node":A.key===_.value})},l(A.title),3),A.configEnv&&A.isLeaf?(n(),z(Ae,{key:0,color:ue(A.configEnv),size:"small",style:{"margin-left":"8px"}},{default:u(()=>[i(l(A.configEnv),1)]),_:2},1032,["color"])):re("",!0)]),_:1},8,["data","expanded-keys"])):(n(),z($e,{key:1,description:o.$t("\u6682\u65E0\u914D\u7F6E\u9879")},null,8,["description"]))]),_:1},8,["loading"])]),_:1})]),p("div",vn,[e(Me,{class:"content-card",bordered:!1},{title:u(()=>[p("div",fn,[p("span",pn,l(_.value?`${o.$t("\u914D\u7F6E\u8BE6\u60C5")}: ${_.value}`:o.$t("\u914D\u7F6E\u8BE6\u60C5")),1),_.value?(n(),z(W,{key:0},{default:u(()=>[e(je,{modelValue:V.value,"onUpdate:modelValue":D[2]||(D[2]=A=>V.value=A),type:"button",size:"small",onChange:Ve},{default:u(()=>[(n(),m(se,null,ye(d,A=>e(Be,{key:A,value:A},{default:u(()=>[i(l(A),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"]),e(I,{type:"primary",status:"danger",size:"small",onClick:he},{icon:u(()=>[e(k(Ju))]),_:1})]),_:1})):re("",!0)])]),default:u(()=>[e(Pe,{loading:C.value,class:"full-height"},{default:u(()=>[_.value?(n(),m("div",Fn,[e(bu,{"default-active-key":"detail",type:"card-gutter"},{default:u(()=>[e(Ze,{key:"detail",title:o.$t("\u57FA\u672C\u4FE1\u606F")},{default:u(()=>[p("div",yn,[e(Bu,{data:F.value,column:{xs:1,sm:2,md:3},"label-style":{"font-weight":"bold"},size:"medium",bordered:"",layout:"inline-horizontal"},null,8,["data"])])]),_:1},8,["title"]),e(Ze,{key:"edit",title:o.$t("\u914D\u7F6E\u503C\u7F16\u8F91")},{default:u(()=>[e(wo,{"config-item":O.value,env:V.value,onUpdate:_e},null,8,["config-item","env"])]),_:1},8,["title"]),e(Ze,{key:"history",title:o.$t("\u7248\u672C\u5386\u53F2")},{default:u(()=>[e(Lo,{"config-key":_.value,env:V.value,onRefresh:pe},null,8,["config-key","env"])]),_:1},8,["title"]),e(Ze,{key:"env-compare",title:o.$t("\u73AF\u5883\u5BF9\u6BD4")},{default:u(()=>[e(an,{"config-key":_.value,onRefresh:pe},null,8,["config-key"])]),_:1},8,["title"])]),_:1})])):(n(),z($e,{key:0,description:o.$t("\u8BF7\u9009\u62E9\u914D\u7F6E\u9879")},null,8,["description"]))]),_:1},8,["loading"])]),_:1})])]),e(He,{visible:L.value,"onUpdate:visible":D[9]||(D[9]=A=>L.value=A),title:o.$t("\u65B0\u5EFA\u914D\u7F6E"),onBeforeOk:be,onCancel:me},{default:u(()=>[e(tu,{ref_key:"createFormRef",ref:te,model:y,"label-align":"left","label-col-props":{span:6},"wrapper-col-props":{span:18}},{default:u(()=>[e(De,{field:"key",label:o.$t("\u914D\u7F6E\u952E"),rules:[{required:!0,message:o.$t("\u8BF7\u8F93\u5165\u914D\u7F6E\u952E")}]},{default:u(()=>[e(qe,{modelValue:y.key,"onUpdate:modelValue":D[3]||(D[3]=A=>y.key=A),placeholder:o.$t("\u8BF7\u8F93\u5165\u914D\u7F6E\u952E\uFF0C\u5982 app.database"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),e(De,{field:"environment",label:o.$t("\u73AF\u5883")},{default:u(()=>[e(su,{modelValue:y.environment,"onUpdate:modelValue":D[4]||(D[4]=A=>y.environment=A),placeholder:o.$t("\u8BF7\u9009\u62E9\u73AF\u5883")},{default:u(()=>[e(ke,{value:""},{default:u(()=>[i(l(o.$t("\u65E0\u73AF\u5883")),1)]),_:1}),(n(),m(se,null,ye(d,A=>e(ke,{key:A,value:A},{default:u(()=>[i(l(A),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),e(De,{field:"description",label:o.$t("\u63CF\u8FF0")},{default:u(()=>[e(qe,{modelValue:y.description,"onUpdate:modelValue":D[5]||(D[5]=A=>y.description=A),placeholder:o.$t("\u8BF7\u8F93\u5165\u914D\u7F6E\u63CF\u8FF0"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(De,{field:"initialConfigKey",label:o.$t("\u521D\u59CB\u914D\u7F6E\u9879\u952E"),rules:[{required:!0,message:o.$t("\u8BF7\u8F93\u5165\u521D\u59CB\u914D\u7F6E\u9879\u952E")}]},{default:u(()=>[e(qe,{modelValue:y.initialConfigKey,"onUpdate:modelValue":D[6]||(D[6]=A=>y.initialConfigKey=A),placeholder:o.$t("\u8BF7\u8F93\u5165\u521D\u59CB\u914D\u7F6E\u9879\u952E\uFF0C\u5982 host"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),e(De,{field:"initialConfigValue",label:o.$t("\u521D\u59CB\u914D\u7F6E\u9879\u503C"),rules:[{required:!0,message:o.$t("\u8BF7\u8F93\u5165\u521D\u59CB\u914D\u7F6E\u9879\u503C")}]},{default:u(()=>[e(qe,{modelValue:y.initialConfigValue,"onUpdate:modelValue":D[7]||(D[7]=A=>y.initialConfigValue=A),placeholder:o.$t("\u8BF7\u8F93\u5165\u521D\u59CB\u914D\u7F6E\u9879\u503C\uFF0C\u5982 localhost"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),e(De,{field:"initialConfigType",label:o.$t("\u521D\u59CB\u914D\u7F6E\u9879\u7C7B\u578B")},{default:u(()=>[e(su,{modelValue:y.initialConfigType,"onUpdate:modelValue":D[8]||(D[8]=A=>y.initialConfigType=A),placeholder:o.$t("\u8BF7\u9009\u62E9\u914D\u7F6E\u9879\u7C7B\u578B")},{default:u(()=>[e(ke,{value:"string"},{default:u(()=>[i(l(o.$t("\u5B57\u7B26\u4E32")),1)]),_:1}),e(ke,{value:"encrypted"},{default:u(()=>[i(l(o.$t("\u52A0\u5BC6")),1)]),_:1}),e(ke,{value:"int"},{default:u(()=>[i(l(o.$t("\u6574\u6570")),1)]),_:1}),e(ke,{value:"float"},{default:u(()=>[i(l(o.$t("\u6D6E\u70B9\u6570")),1)]),_:1}),e(ke,{value:"bool"},{default:u(()=>[i(l(o.$t("\u5E03\u5C14\u503C")),1)]),_:1}),e(ke,{value:"ref"},{default:u(()=>[i(l(o.$t("\u5F15\u7528")),1)]),_:1}),e(ke,{value:"object"},{default:u(()=>[i(l(o.$t("\u5BF9\u8C61")),1)]),_:1}),e(ke,{value:"array"},{default:u(()=>[i(l(o.$t("\u6570\u7EC4")),1)]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["visible","title"]),e(He,{visible:c.value,"onUpdate:visible":D[10]||(D[10]=A=>c.value=A),title:o.$t("\u5220\u9664\u914D\u7F6E"),onBeforeOk:G},{default:u(()=>[p("p",null,[i(l(o.$t("\u786E\u5B9A\u8981\u5220\u9664\u914D\u7F6E"))+" ",1),p("strong",null,l(_.value),1),i(" "+l(o.$t("\u5417\uFF1F\u6B64\u64CD\u4F5C\u4E0D\u53EF\u64A4\u9500\u3002")),1)])]),_:1},8,["visible","title"]),e(He,{visible:K.value,"onUpdate:visible":D[13]||(D[13]=A=>K.value=A),title:o.$t("\u5BFC\u51FA\u914D\u7F6E"),onBeforeOk:ne},{default:u(()=>[e(tu,{ref_key:"exportFormRef",ref:H,model:X,"label-align":"left","label-col-props":{span:6},"wrapper-col-props":{span:18}},{default:u(()=>[e(De,{field:"password",label:o.$t("\u52A0\u5BC6\u5BC6\u7801"),rules:[{required:!0,message:o.$t("\u8BF7\u8F93\u5165\u52A0\u5BC6\u5BC6\u7801")}]},{default:u(()=>[e(lu,{modelValue:X.password,"onUpdate:modelValue":D[11]||(D[11]=A=>X.password=A),placeholder:o.$t("\u8BF7\u8F93\u5165\u7528\u4E8E\u52A0\u5BC6\u5BFC\u51FA\u6587\u4EF6\u7684\u5BC6\u7801"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),e(De,{field:"confirmPassword",label:o.$t("\u786E\u8BA4\u5BC6\u7801"),rules:[{required:!0,message:o.$t("\u8BF7\u786E\u8BA4\u5BC6\u7801")},{validator:A=>A===X.password,message:o.$t("\u4E24\u6B21\u8F93\u5165\u7684\u5BC6\u7801\u4E0D\u4E00\u81F4")}]},{default:u(()=>[e(lu,{modelValue:X.confirmPassword,"onUpdate:modelValue":D[12]||(D[12]=A=>X.confirmPassword=A),placeholder:o.$t("\u8BF7\u518D\u6B21\u8F93\u5165\u5BC6\u7801"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),p("div",mn,[e(iu,{type:"warning"},{default:u(()=>[i(l(o.$t("\u8BF7\u59A5\u5584\u4FDD\u7BA1\u60A8\u7684\u52A0\u5BC6\u5BC6\u7801\uFF0C\u5B83\u5C06\u7528\u4E8E\u89E3\u5BC6\u5BFC\u5165\u7684\u914D\u7F6E\u6587\u4EF6\u3002\u82E5\u5BC6\u7801\u4E22\u5931\uFF0C\u5C06\u65E0\u6CD5\u5BFC\u5165\u6B64\u914D\u7F6E\u3002")),1)]),_:1})])]),_:1},8,["model"])]),_:1},8,["visible","title"]),e(He,{visible:Z.value,"onUpdate:visible":D[17]||(D[17]=A=>Z.value=A),title:o.$t("\u5BFC\u5165\u914D\u7F6E"),onBeforeOk:ae},{default:u(()=>[e(tu,{ref_key:"importFormRef",ref:J,model:x,"label-align":"left","label-col-props":{span:6},"wrapper-col-props":{span:18}},{default:u(()=>[e(De,{field:"file",label:o.$t("\u914D\u7F6E\u6587\u4EF6"),rules:[{required:!0,message:o.$t("\u8BF7\u9009\u62E9\u914D\u7F6E\u6587\u4EF6")}]},{default:u(()=>[e(We,{"file-list":de.value,limit:1,action:"/","auto-upload":!1,"show-file-list":!0,onChange:U},{"upload-button":u(()=>[e(I,null,{default:u(()=>[i(l(o.$t("\u9009\u62E9\u6587\u4EF6")),1)]),_:1})]),_:1},8,["file-list"])]),_:1},8,["label","rules"]),e(De,{field:"password",label:o.$t("\u89E3\u5BC6\u5BC6\u7801"),rules:[{required:!0,message:o.$t("\u8BF7\u8F93\u5165\u89E3\u5BC6\u5BC6\u7801")}]},{default:u(()=>[e(lu,{modelValue:x.password,"onUpdate:modelValue":D[14]||(D[14]=A=>x.password=A),placeholder:o.$t("\u8BF7\u8F93\u5165\u7528\u4E8E\u89E3\u5BC6\u914D\u7F6E\u6587\u4EF6\u7684\u5BC6\u7801"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),e(De,{field:"originalSalt",label:o.$t("\u65E7AIO\u5BC6\u94A5"),rules:[{required:!0,message:o.$t("\u8BF7\u8F93\u5165\u65E7AIO\u5BC6\u94A5")}]},{default:u(()=>[e(qe,{modelValue:x.originalSalt,"onUpdate:modelValue":D[15]||(D[15]=A=>x.originalSalt=A),placeholder:o.$t("\u8BF7\u8F93\u5165\u65E7AIO\u5BC6\u94A5"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),e(De,{field:"skipExisting",label:o.$t("\u5904\u7406\u5DF2\u6709\u914D\u7F6E")},{default:u(()=>[e(je,{modelValue:x.skipExisting,"onUpdate:modelValue":D[16]||(D[16]=A=>x.skipExisting=A)},{default:u(()=>[e(Be,{value:!0},{default:u(()=>[i(l(o.$t("\u8DF3\u8FC7\u5DF2\u5B58\u5728\u914D\u7F6E")),1)]),_:1}),e(Be,{value:!1},{default:u(()=>[i(l(o.$t("\u8986\u76D6\u5DF2\u5B58\u5728\u914D\u7F6E")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),p("div",En,[e(iu,{type:"warning"},{default:u(()=>[i(l(o.$t("\u5BFC\u5165\u64CD\u4F5C\u4F1A\u8986\u76D6\u540C\u540D\u914D\u7F6E\u9879\uFF0C\u8BF7\u786E\u4FDD\u60A8\u5DF2\u5907\u4EFD\u91CD\u8981\u6570\u636E\u3002")),1)]),_:1})])]),_:1},8,["model"])]),_:1},8,["visible","title"]),e(He,{visible:f.value,"onUpdate:visible":D[20]||(D[20]=A=>f.value=A),title:o.$t("\u5BFC\u5165\u7ED3\u679C"),footer:!1,"mask-closable":!0,width:"600px"},{default:u(()=>[p("div",_n,[e(ru,{status:"success",title:o.$t("\u914D\u7F6E\u5BFC\u5165\u6210\u529F")},{subtitle:u(()=>[w.skipped&&w.skipped.length>0?(n(),m("div",gn,[i(l(o.$t("\u4EE5\u4E0B"))+" ",1),p("strong",null,l(w.skipped.length),1),i(" "+l(o.$t("\u4E2A\u914D\u7F6E\u5DF2\u5B58\u5728\u88AB\u8DF3\u8FC7:")),1)])):(n(),m("div",Cn,l(o.$t("\u6240\u6709\u914D\u7F6E\u5747\u5DF2\u6210\u529F\u5BFC\u5165")),1))]),extra:u(()=>[e(W,null,{default:u(()=>[e(I,{onClick:D[19]||(D[19]=A=>f.value=!1)},{default:u(()=>[i(l(o.$t("\u5173\u95ED")),1)]),_:1})]),_:1})]),default:u(()=>[w.skipped&&w.skipped.length>0?(n(),m("div",hn,[e(W,{direction:"vertical",fill:""},{default:u(()=>[e(Ee,{modelValue:M.value,"onUpdate:modelValue":D[18]||(D[18]=A=>M.value=A),placeholder:o.$t("\u641C\u7D22\u8DF3\u8FC7\u7684\u914D\u7F6E"),"allow-clear":""},null,8,["modelValue","placeholder"]),e(Au,{style:{height:"300px"},"outer-class":"scrollbar-wrapper"},{default:u(()=>[e(ku,{bordered:!0,data:T.value},{item:u(({item:A})=>[e($u,null,{default:u(()=>[i(l(A),1)]),_:2},1024)]),_:1},8,["data"])]),_:1})]),_:1})])):re("",!0)]),_:1},8,["title"])])]),_:1},8,["visible","title"])])}}});const zn=Ne(Dn,[["__scopeId","data-v-765b308d"]]);export{zn as default};
