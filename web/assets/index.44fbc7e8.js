import{t as q,_ as Q}from"./index.a81c3a0f.js";/* empty css              *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css                *//* empty css                */import{d as W,j as D,c as y,o as tt,bF as st,C as i,D as m,aI as s,aH as u,E as e,aM as d,u as I,aK as F,aJ as b,aE as A,F as et,G as at,aN as _,aa as ot,aF as lt,bT as ut,bU as nt,aY as rt,ba as it,c9 as ct,bS as dt,bX as _t,bt as mt,bY as vt,bm as pt,bA as ft,aZ as gt,bl as ht,bO as yt,bP as Bt,aX as Et}from"./arco.2804d378.js";import{f as Ct}from"./vue.bbad6851.js";import{l as Dt,c as Ft}from"./distributed.c36fd468.js";import"./chart.9f128c58.js";const bt={class:"container"},At={class:"stats-row"},St={key:0,class:"loading-container"},wt={key:1,class:"empty-container"},kt={key:2,class:"service-cards"},It={class:"service-title"},Nt={class:"service-name"},xt={key:0,class:"error-content"},zt={key:1,class:"service-content"},Tt={class:"stats-grid"},Vt={class:"stat-item"},Rt={class:"stat-value"},Mt={class:"stat-item"},Lt={class:"stat-value healthy"},Ut={class:"stat-item"},Pt={class:"stat-value error"},Ot={class:"stat-item"},Xt={class:"stat-value timestamp"},Yt={class:"protocols-section"},jt={class:"protocol-tags"},Gt={class:"status-section"},Ht={class:"status-tags"},Jt={class:"action-section"},Kt=W({__name:"index",setup(Zt){const N=Ct(),g=D(!1),n=D([]),B=D(3e4);let f=null;const x=y(()=>n.value.length),z=y(()=>n.value.reduce((a,t)=>{var o;return a+(((o=t.stats)==null?void 0:o.total_instances)||0)},0)),T=y(()=>n.value.reduce((a,t)=>{var o;return a+(((o=t.stats)==null?void 0:o.healthy_instances)||0)},0)),V=y(()=>n.value.reduce((a,t)=>{var o;return a+(((o=t.stats)==null?void 0:o.unhealthy_instances)||0)},0)),R=async()=>{try{const a=await Dt();if(a.data){const t=a.data;n.value=t.map(o=>({serviceName:o,stats:null,loading:!0,hasError:!1,error:""})),await Promise.allSettled(t.map(async(o,r)=>{try{const v=await Ft(o);v.data?(n.value[r].stats=v.data,n.value[r].hasError=!1,n.value[r].error=""):(n.value[r].hasError=!0,n.value[r].error="\u83B7\u53D6\u670D\u52A1\u7EDF\u8BA1\u6570\u636E\u5931\u8D25")}catch(v){n.value[r].hasError=!0,n.value[r].error=v.message||"\u83B7\u53D6\u670D\u52A1\u7EDF\u8BA1\u6570\u636E\u5931\u8D25"}finally{n.value[r].loading=!1}}))}}catch(a){Et.error("\u83B7\u53D6\u670D\u52A1\u5217\u8868\u5931\u8D25: "+(a.message||"\u672A\u77E5\u9519\u8BEF"))}},E=async()=>{g.value=!0;try{await R()}finally{g.value=!1}},M=()=>{S()},S=()=>{f&&clearInterval(f),f=window.setInterval(()=>{E()},B.value)},L=a=>a?new Date(a).toLocaleTimeString("zh-CN",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}):"-",U=a=>{const t=["#1890ff","#52c41a","#faad14","#f5222d","#722ed1","#13c2c2","#eb2f96","#fa541c"];let o=0;for(let r=0;r<a.length;r++)o=a.charCodeAt(r)+((o<<5)-o);return t[Math.abs(o)%t.length]},P=a=>({http:"blue",https:"green",grpc:"purple",tcp:"orange",udp:"red"})[a.toLowerCase()]||"default",O=a=>({active:"green",inactive:"red",pending:"orange",stopped:"gray"})[a.toLowerCase()]||"default",X=a=>{N.push({name:"ServiceMonitorDetail",params:{serviceName:a}})};return tt(()=>{E(),S()}),st(()=>{f&&clearInterval(f)}),(a,t)=>{const o=ut,r=nt,v=rt,Y=it,h=ct,w=dt,C=_t,j=mt,G=vt,H=pt,J=ft,K=gt,k=ht,Z=yt,$=Bt;return i(),m("div",bt,[s(w,{class:"header-card",title:"\u670D\u52A1\u76D1\u63A7"},{extra:u(()=>[s(Y,null,{default:u(()=>[t[7]||(t[7]=e("span",{class:"refresh-label"},"\u5237\u65B0\u95F4\u9694\uFF1A",-1)),s(r,{modelValue:B.value,"onUpdate:modelValue":t[0]||(t[0]=l=>B.value=l),style:{width:"120px"},size:"small",onChange:M},{default:u(()=>[s(o,{value:5e3},{default:u(()=>t[1]||(t[1]=[d("5\u79D2")])),_:1}),s(o,{value:1e4},{default:u(()=>t[2]||(t[2]=[d("10\u79D2")])),_:1}),s(o,{value:3e4},{default:u(()=>t[3]||(t[3]=[d("30\u79D2")])),_:1}),s(o,{value:6e4},{default:u(()=>t[4]||(t[4]=[d("1\u5206\u949F")])),_:1}),s(o,{value:3e5},{default:u(()=>t[5]||(t[5]=[d("5\u5206\u949F")])),_:1})]),_:1},8,["modelValue"]),s(v,{type:"primary",size:"small",onClick:E,loading:g.value},{icon:u(()=>[s(I(q))]),default:u(()=>[t[6]||(t[6]=d(" \u7ACB\u5373\u5237\u65B0 "))]),_:1},8,["loading"])]),_:1})]),default:u(()=>[e("div",At,[s(h,{title:"\u670D\u52A1\u603B\u6570",value:x.value},null,8,["value"]),s(h,{title:"\u5B9E\u4F8B\u603B\u6570",value:z.value},null,8,["value"]),s(h,{title:"\u5065\u5EB7\u5B9E\u4F8B",value:T.value},null,8,["value"]),s(h,{title:"\u5F02\u5E38\u5B9E\u4F8B",value:V.value},null,8,["value"])])]),_:1}),s(C),g.value&&n.value.length===0?(i(),m("div",St,[s(j,{size:"large",tip:"\u6B63\u5728\u52A0\u8F7D\u670D\u52A1\u6570\u636E..."})])):n.value.length===0?(i(),m("div",wt,[s(G,{description:"\u6682\u65E0\u670D\u52A1\u6570\u636E"})])):(i(),m("div",kt,[s($,{gutter:[16,16]},{default:u(()=>[(i(!0),m(F,null,b(n.value,l=>(i(),A(Z,{key:l.serviceName,xs:24,sm:12,md:8,lg:6},{default:u(()=>[s(w,{class:et(["service-card",{"error-card":l.hasError}]),loading:l.loading},{title:u(()=>[e("div",It,[s(H,{style:at({backgroundColor:U(l.serviceName)}),size:"small"},{default:u(()=>[d(_(l.serviceName.charAt(0).toUpperCase()),1)]),_:2},1032,["style"]),e("span",Nt,_(l.serviceName),1)])]),extra:u(()=>{var p,c;return[s(J,{status:l.hasError?"error":(((p=l.stats)==null?void 0:p.healthy_instances)||0)>0?"processing":"default",text:l.hasError?"\u9519\u8BEF":(((c=l.stats)==null?void 0:c.healthy_instances)||0)>0?"\u6B63\u5E38":"\u505C\u6B62"},null,8,["status","text"])]}),default:u(()=>[l.hasError?(i(),m("div",xt,[s(K,{type:"error",message:l.error,"show-icon":""},null,8,["message"])])):l.stats?(i(),m("div",zt,[e("div",Tt,[e("div",Vt,[t[8]||(t[8]=e("div",{class:"stat-label"},"\u5B9E\u4F8B\u603B\u6570",-1)),e("div",Rt,_(l.stats.total_instances),1)]),e("div",Mt,[t[9]||(t[9]=e("div",{class:"stat-label"},"\u5065\u5EB7\u5B9E\u4F8B",-1)),e("div",Lt,_(l.stats.healthy_instances),1)]),e("div",Ut,[t[10]||(t[10]=e("div",{class:"stat-label"},"\u5F02\u5E38\u5B9E\u4F8B",-1)),e("div",Pt,_(l.stats.unhealthy_instances),1)]),e("div",Ot,[t[11]||(t[11]=e("div",{class:"stat-label"},"\u66F4\u65B0\u65F6\u95F4",-1)),e("div",Xt,_(L(l.stats.timestamp)),1)])]),s(C,{margin:"12px"}),e("div",Yt,[t[12]||(t[12]=e("div",{class:"section-title"},"\u534F\u8BAE\u5206\u5E03",-1)),e("div",jt,[(i(!0),m(F,null,b(l.stats.protocols,(p,c)=>(i(),A(k,{key:c,color:P(c),size:"small"},{default:u(()=>[d(_(c)+": "+_(p),1)]),_:2},1032,["color"]))),128))])]),e("div",Gt,[t[13]||(t[13]=e("div",{class:"section-title"},"\u72B6\u6001\u5206\u5E03",-1)),e("div",Ht,[(i(!0),m(F,null,b(l.stats.statuses,(p,c)=>(i(),A(k,{key:c,color:O(c),size:"small"},{default:u(()=>[d(_(c)+": "+_(p),1)]),_:2},1032,["color"]))),128))])]),s(C,{margin:"12px"}),e("div",Jt,[s(v,{type:"text",size:"small",onClick:p=>X(l.serviceName)},{icon:u(()=>[s(I(ot))]),default:u(()=>[t[14]||(t[14]=d(" \u67E5\u770B\u8BE6\u60C5 "))]),_:2},1032,["onClick"])])])):lt("",!0)]),_:2},1032,["class","loading"])]),_:2},1024))),128))]),_:1})]))])}}});const rs=Q(Kt,[["__scopeId","data-v-ffac8436"]]);export{rs as default};
