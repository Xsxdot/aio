import{g as S,B as _e,t as me,C as pe,_ as fe}from"./index.a81c3a0f.js";/* empty css                *//* empty css                *//* empty css              *//* empty css                *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css                *//* empty css               *//* empty css              */import{d as Fe,r as w,j as f,o as ve,C as L,D as j,aI as e,aH as t,aM as n,aN as _,aK as Be,aJ as Ae,aE as De,E as z,aX as D,n as O,b7 as Ee,bc as be,bO as Ce,bT as ye,bU as ge,bP as Ve,bb as xe,bX as we,ac as Se,aY as ke,ba as Ie,a6 as $e,bQ as Ue,bl as Me,c1 as Re,bR as Te,bS as Le,b2 as Oe,b_ as Pe,aZ as qe,bW as Ne}from"./arco.2804d378.js";import"./chart.9f128c58.js";import"./vue.bbad6851.js";function je(m){return S.get("/api/auth/clients",{params:{type:m}})}function ze(m){return S.post("/api/auth/clients",m)}function He(m){return S.post("/api/auth/clients/service",m)}function Xe(m){return S.delete(`/api/auth/clients/${m}`)}const Ye={class:"container"},Je={style:{"margin-top":"16px","text-align":"right"}},Ke={name:"ClientManagement"},Qe=Fe({...Ke,setup(m){const r=w({client_id:"",client_name:"",client_type:""}),H=f(),b=f(!1),o=w({client_id:"",client_name:"",client_type:"service",client_secret:"",roles:["service_role"]}),X=f(),C=f(!1),i=w({service_name:"",service_desc:"",roles:["service_role"]}),Y={service_name:[{required:!0,message:"\u8BF7\u8F93\u5165\u670D\u52A1\u540D\u79F0"}]},A=f(!1),k=f([]),I=f(!1),F=f([]),y=w({...{total:0,current:1,pageSize:10}}),E=async()=>{try{I.value=!0;const a=r.client_type||void 0,u=await je(a);F.value=u.data||[],r.client_id&&(F.value=F.value.filter(c=>c.id.toLowerCase().includes(r.client_id.toLowerCase()))),r.client_name&&(F.value=F.value.filter(c=>c.name.toLowerCase().includes(r.client_name.toLowerCase()))),y.total=F.value.length}catch(a){D.error("\u52A0\u8F7D\u5BA2\u6237\u7AEF\u5217\u8868\u5931\u8D25"),console.error(a)}finally{I.value=!1}};ve(()=>{E()});const J=a=>{y.current=a},P=async()=>{y.current=1,await E()},K=()=>{for(const a in r)r[a]=""},Q=()=>{o.client_id="",o.client_name="",o.client_type="service",o.client_secret="",o.roles=["service_role"],b.value=!0},W=()=>{i.service_name="",i.service_desc="",i.roles=["service_role"],C.value=!0},Z=async()=>{try{const a=await ze({client_id:o.client_id,client_name:o.client_name,client_type:o.client_type,client_secret:o.client_secret,roles:o.roles});return k.value=[{label:"\u5BA2\u6237\u7AEFID",value:a.data.client_id},{label:"\u5BC6\u94A5",value:a.data.client_secret},{label:"\u7C7B\u578B",value:$(a.data.client_type)},{label:"\u540D\u79F0",value:a.data.client_name},{label:"\u89D2\u8272",value:a.data.roles.join(", ")}],A.value=!0,b.value=!1,O(()=>{E()}),!0}catch(a){return D.error("\u521B\u5EFA\u5BA2\u6237\u7AEF\u5931\u8D25"),console.error(a),!1}},G=async()=>{try{const a=await He({service_name:i.service_name,service_desc:i.service_desc,roles:i.roles});return k.value=[{label:"\u5BA2\u6237\u7AEFID",value:a.data.client_id},{label:"\u5BC6\u94A5",value:a.data.client_secret},{label:"\u7C7B\u578B",value:$(a.data.client_type)},{label:"\u540D\u79F0",value:a.data.client_name},{label:"\u89D2\u8272",value:a.data.roles.join(", ")}],A.value=!0,C.value=!1,O(()=>{E()}),!0}catch(a){return D.error("\u521B\u5EFA\u670D\u52A1\u5BA2\u6237\u7AEF\u5931\u8D25"),console.error(a),!1}},h=a=>{D.warning("\u53EA\u6709\u5728\u521B\u5EFA\u65F6\u624D\u80FD\u67E5\u770B\u5BC6\u94A5\uFF0C\u8BF7\u91CD\u65B0\u521B\u5EFA\u5BA2\u6237\u7AEF\u83B7\u53D6\u65B0\u7684\u5BC6\u94A5")},ee=async a=>{try{await Xe(a.id),D.success("\u5BA2\u6237\u7AEF\u5220\u9664\u6210\u529F"),O(()=>{E()})}catch(u){D.error("\u5220\u9664\u5BA2\u6237\u7AEF\u5931\u8D25"),console.error(u)}},ue=a=>{if(!a)return"";const u=new Date(a);return`${u.getFullYear()}-${String(u.getMonth()+1).padStart(2,"0")}-${String(u.getDate()).padStart(2,"0")} ${String(u.getHours()).padStart(2,"0")}:${String(u.getMinutes()).padStart(2,"0")}`},$=a=>({service:"\u670D\u52A1",node:"\u8282\u70B9",component:"\u7EC4\u4EF6",user:"\u7528\u6237"})[a]||a,te=a=>({service:"blue",node:"green",component:"orange",user:"purple"})[a]||"gray";return(a,u)=>{const c=Ee,d=be,v=Ce,s=ye,g=ge,U=Ve,M=xe,q=we,le=Se,p=ke,ae=me,V=Ie,N=$e,ne=pe,B=Ue,R=Me,oe=Re,re=Te,ie=Le,T=Oe,se=Pe,de=qe,ce=Ne;return L(),j("div",Ye,[e(_e,{items:["\u51ED\u8BC1\u7BA1\u7406","\u5BA2\u6237\u7AEF\u51ED\u8BC1"]}),e(ie,{class:"general-card",title:a.$t("\u5BA2\u6237\u7AEF\u51ED\u8BC1\u5217\u8868")},{default:t(()=>[e(U,null,{default:t(()=>[e(v,{flex:1},{default:t(()=>[e(M,{model:r,"label-align":"left",class:"search-form",onSubmit:P},{default:t(()=>[e(U,{gutter:16},{default:t(()=>[e(v,{span:8},{default:t(()=>[e(d,{field:"client_id",label:"\u5BA2\u6237\u7AEFID"},{default:t(()=>[e(c,{modelValue:r.client_id,"onUpdate:modelValue":u[0]||(u[0]=l=>r.client_id=l),placeholder:"\u8BF7\u8F93\u5165\u5BA2\u6237\u7AEFID"},null,8,["modelValue"])]),_:1})]),_:1}),e(v,{span:8},{default:t(()=>[e(d,{field:"client_name",label:"\u540D\u79F0"},{default:t(()=>[e(c,{modelValue:r.client_name,"onUpdate:modelValue":u[1]||(u[1]=l=>r.client_name=l),placeholder:"\u8BF7\u8F93\u5165\u5BA2\u6237\u7AEF\u540D\u79F0"},null,8,["modelValue"])]),_:1})]),_:1}),e(v,{span:8},{default:t(()=>[e(d,{field:"client_type",label:"\u7C7B\u578B"},{default:t(()=>[e(g,{modelValue:r.client_type,"onUpdate:modelValue":u[2]||(u[2]=l=>r.client_type=l),placeholder:"\u8BF7\u9009\u62E9\u5BA2\u6237\u7AEF\u7C7B\u578B","allow-clear":""},{default:t(()=>[e(s,{value:"service"},{default:t(()=>u[16]||(u[16]=[n("\u670D\u52A1")])),_:1}),e(s,{value:"node"},{default:t(()=>u[17]||(u[17]=[n("\u8282\u70B9")])),_:1}),e(s,{value:"component"},{default:t(()=>u[18]||(u[18]=[n("\u7EC4\u4EF6")])),_:1}),e(s,{value:"user"},{default:t(()=>u[19]||(u[19]=[n("\u7528\u6237")])),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(q,{style:{height:"32px"},direction:"vertical"}),e(v,{flex:"86px",style:{"text-align":"right"}},{default:t(()=>[e(V,{size:18},{default:t(()=>[e(p,{type:"primary",onClick:P},{icon:t(()=>[e(le)]),default:t(()=>[n(" "+_(a.$t("\u641C\u7D22")),1)]),_:1}),e(p,{onClick:K},{icon:t(()=>[e(ae)]),default:t(()=>[n(" "+_(a.$t("\u91CD\u7F6E")),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(U,{style:{"margin-bottom":"16px"}},{default:t(()=>[e(v,{span:12},{default:t(()=>[e(V,null,{default:t(()=>[e(p,{type:"primary",onClick:Q},{icon:t(()=>[e(N)]),default:t(()=>[n(" "+_(a.$t("\u65B0\u589E")),1)]),_:1}),e(p,{type:"primary",status:"success",onClick:W},{icon:t(()=>[e(N)]),default:t(()=>[n(" "+_(a.$t("\u5FEB\u901F\u521B\u5EFA\u670D\u52A1\u5BA2\u6237\u7AEF")),1)]),_:1})]),_:1})]),_:1}),e(v,{span:12,style:{display:"flex","justify-content":"end"}},{default:t(()=>[e(p,null,{icon:t(()=>[e(ne)]),default:t(()=>[n(" "+_(a.$t("\u5BFC\u51FA")),1)]),_:1})]),_:1})]),_:1}),e(re,{"row-key":"id",loading:I.value,pagination:y,data:F.value,bordered:!1,onPageChange:J},{columns:t(()=>[e(B,{title:"ID","data-index":"id",width:180}),e(B,{title:"\u7C7B\u578B","data-index":"type"},{cell:t(({record:l})=>[e(R,{color:te(l.type)},{default:t(()=>[n(_($(l.type)),1)]),_:2},1032,["color"])]),_:1}),e(B,{title:"\u540D\u79F0","data-index":"name"}),e(B,{title:"\u89D2\u8272","data-index":"roles"},{cell:t(({record:l})=>[e(V,{wrap:""},{default:t(()=>[(L(!0),j(Be,null,Ae(l.roles,x=>(L(),De(R,{key:x,color:"blue"},{default:t(()=>[n(_(x),1)]),_:2},1024))),128))]),_:2},1024)]),_:1}),e(B,{title:"\u72B6\u6001","data-index":"disabled"},{cell:t(({record:l})=>[e(R,{color:l.disabled?"red":"green"},{default:t(()=>[n(_(l.disabled?"\u7981\u7528":"\u542F\u7528"),1)]),_:2},1032,["color"])]),_:1}),e(B,{title:"\u521B\u5EFA\u65F6\u95F4","data-index":"created_at"},{cell:t(({record:l})=>[n(_(ue(l.created_at)),1)]),_:1}),e(B,{title:"\u64CD\u4F5C",width:140},{cell:t(({record:l})=>[e(V,null,{default:t(()=>[e(p,{type:"text",size:"small",onClick:x=>h(l)},{default:t(()=>u[20]||(u[20]=[n(" \u67E5\u770B\u5BC6\u94A5 ")])),_:2},1032,["onClick"]),e(q,{style:{height:"16px"},direction:"vertical"}),e(oe,{content:"\u786E\u5B9A\u8981\u5220\u9664\u8BE5\u5BA2\u6237\u7AEF\u51ED\u8BC1\u5417\uFF1F",onOk:x=>ee(l)},{default:t(()=>[e(p,{type:"text",status:"danger",size:"small"},{default:t(()=>u[21]||(u[21]=[n(" \u5220\u9664 ")])),_:1})]),_:2},1032,["onOk"])]),_:2},1024)]),_:1})]),_:1},8,["loading","pagination","data"])]),_:1},8,["title"]),e(T,{visible:b.value,"onUpdate:visible":u[8]||(u[8]=l=>b.value=l),title:"\u65B0\u589E\u5BA2\u6237\u7AEF\u51ED\u8BC1",onBeforeOk:Z},{default:t(()=>[e(M,{ref_key:"clientFormRef",ref:H,model:o},{default:t(()=>[e(d,{field:"client_id",label:"\u5BA2\u6237\u7AEFID"},{default:t(()=>[e(c,{modelValue:o.client_id,"onUpdate:modelValue":u[3]||(u[3]=l=>o.client_id=l),placeholder:"\u8BF7\u8F93\u5165\u5BA2\u6237\u7AEFID"},null,8,["modelValue"])]),_:1}),e(d,{field:"client_name",label:"\u5BA2\u6237\u7AEF\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BA2\u6237\u7AEF\u540D\u79F0"}]},{default:t(()=>[e(c,{modelValue:o.client_name,"onUpdate:modelValue":u[4]||(u[4]=l=>o.client_name=l),placeholder:"\u8BF7\u8F93\u5165\u5BA2\u6237\u7AEF\u540D\u79F0"},null,8,["modelValue"])]),_:1}),e(d,{field:"client_type",label:"\u5BA2\u6237\u7AEF\u7C7B\u578B",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u5BA2\u6237\u7AEF\u7C7B\u578B"}]},{default:t(()=>[e(g,{modelValue:o.client_type,"onUpdate:modelValue":u[5]||(u[5]=l=>o.client_type=l),placeholder:"\u8BF7\u9009\u62E9\u5BA2\u6237\u7AEF\u7C7B\u578B"},{default:t(()=>[e(s,{value:"service"},{default:t(()=>u[22]||(u[22]=[n("\u670D\u52A1")])),_:1}),e(s,{value:"node"},{default:t(()=>u[23]||(u[23]=[n("\u8282\u70B9")])),_:1}),e(s,{value:"component"},{default:t(()=>u[24]||(u[24]=[n("\u7EC4\u4EF6")])),_:1}),e(s,{value:"user"},{default:t(()=>u[25]||(u[25]=[n("\u7528\u6237")])),_:1})]),_:1},8,["modelValue"])]),_:1}),e(d,{field:"client_secret",label:"\u5BA2\u6237\u7AEF\u5BC6\u94A5"},{default:t(()=>[e(c,{modelValue:o.client_secret,"onUpdate:modelValue":u[6]||(u[6]=l=>o.client_secret=l),placeholder:"\u7559\u7A7A\u81EA\u52A8\u751F\u6210"},null,8,["modelValue"]),u[26]||(u[26]=z("div",{class:"form-item-help"},"\u7559\u7A7A\u5C06\u81EA\u52A8\u751F\u6210\u968F\u673A\u5BC6\u94A5",-1))]),_:1}),e(d,{field:"roles",label:"\u89D2\u8272",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u81F3\u5C11\u4E00\u4E2A\u89D2\u8272"}]},{default:t(()=>[e(g,{modelValue:o.roles,"onUpdate:modelValue":u[7]||(u[7]=l=>o.roles=l),placeholder:"\u8BF7\u9009\u62E9\u89D2\u8272","allow-create":"",multiple:""},{default:t(()=>[e(s,{value:"service_role"},{default:t(()=>u[27]||(u[27]=[n("\u670D\u52A1\u89D2\u8272")])),_:1}),e(s,{value:"monitoring_role"},{default:t(()=>u[28]||(u[28]=[n("\u76D1\u63A7\u89D2\u8272")])),_:1}),e(s,{value:"node_role"},{default:t(()=>u[29]||(u[29]=[n("\u8282\u70B9\u89D2\u8272")])),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"]),e(T,{visible:C.value,"onUpdate:visible":u[12]||(u[12]=l=>C.value=l),title:"\u5FEB\u901F\u521B\u5EFA\u670D\u52A1\u5BA2\u6237\u7AEF",onBeforeOk:G},{default:t(()=>[e(M,{ref_key:"serviceFormRef",ref:X,model:i,rules:Y},{default:t(()=>[e(d,{field:"service_name",label:"\u670D\u52A1\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u670D\u52A1\u540D\u79F0"}]},{default:t(()=>[e(c,{modelValue:i.service_name,"onUpdate:modelValue":u[9]||(u[9]=l=>i.service_name=l),placeholder:"\u8BF7\u8F93\u5165\u670D\u52A1\u540D\u79F0"},null,8,["modelValue"])]),_:1}),e(d,{field:"service_desc",label:"\u670D\u52A1\u63CF\u8FF0"},{default:t(()=>[e(se,{modelValue:i.service_desc,"onUpdate:modelValue":u[10]||(u[10]=l=>i.service_desc=l),placeholder:"\u8BF7\u8F93\u5165\u670D\u52A1\u63CF\u8FF0"},null,8,["modelValue"])]),_:1}),e(d,{field:"roles",label:"\u89D2\u8272"},{default:t(()=>[e(g,{modelValue:i.roles,"onUpdate:modelValue":u[11]||(u[11]=l=>i.roles=l),mode:"multiple",placeholder:"\u8BF7\u9009\u62E9\u89D2\u8272"},{default:t(()=>[e(s,{value:"service_role"},{default:t(()=>u[30]||(u[30]=[n(" \u670D\u52A1\u89D2\u8272 ")])),_:1}),e(s,{value:"monitoring_role"},{default:t(()=>u[31]||(u[31]=[n(" \u76D1\u63A7\u89D2\u8272 ")])),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"]),e(T,{visible:A.value,"onUpdate:visible":u[14]||(u[14]=l=>A.value=l),title:"\u5BA2\u6237\u7AEF\u5BC6\u94A5\u4FE1\u606F",footer:!1,onCancel:u[15]||(u[15]=l=>A.value=!1)},{default:t(()=>[e(de,{type:"warning",style:{"margin-bottom":"16px"}},{message:t(()=>u[32]||(u[32]=[n("\u5BA2\u6237\u7AEF\u5BC6\u94A5\u53EA\u4F1A\u5C55\u793A\u4E00\u6B21\uFF0C\u8BF7\u59A5\u5584\u4FDD\u5B58")])),_:1}),e(ce,{data:k.value,layout:"vertical",bordered:""},null,8,["data"]),z("div",Je,[e(p,{onClick:u[13]||(u[13]=l=>A.value=!1)},{default:t(()=>u[33]||(u[33]=[n("\u5173\u95ED")])),_:1})])]),_:1},8,["visible"])])}}});const _u=fe(Qe,[["__scopeId","data-v-83120a0e"]]);export{_u as default};
